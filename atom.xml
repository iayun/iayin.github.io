<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>花不见归</title>
  
  <subtitle>喜欢捣鼓的大龄青年</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://iayun.vip/"/>
  <updated>2019-04-21T06:49:28.006Z</updated>
  <id>http://iayun.vip/</id>
  
  <author>
    <name>花不见</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>linux安装MySQL</title>
    <link href="http://iayun.vip/linux%E5%AE%89%E8%A3%85MySQL.html"/>
    <id>http://iayun.vip/linux安装MySQL.html</id>
    <published>2019-04-18T15:00:00.000Z</published>
    <updated>2019-04-21T06:49:28.006Z</updated>
    
    <content type="html"><![CDATA[<p>在Linux服务器下安装MySQL，注意要先检查自身是否已经安装过mariadb或MySQL，否则会安装失败。</p><a id="more"></a><h4 id="卸载系统自带的Mariadb"><a href="#卸载系统自带的Mariadb" class="headerlink" title="卸载系统自带的Mariadb"></a>卸载系统自带的Mariadb</h4><p>rpm -qa|grep mariadb             //查询出已安装的mariadb<br>rpm -e –nodeps 文件名              //卸载 ， 文件名为使用rpm -qa|grep mariadb 命令查出的所有文件</p><h4 id="卸载系统自带的mysql"><a href="#卸载系统自带的mysql" class="headerlink" title="卸载系统自带的mysql"></a>卸载系统自带的mysql</h4><blockquote><p>rpm -qa|grep mysql             //查询出已安装的mariadb</p></blockquote><blockquote><p>rpm -e –nodeps 文件名          //卸载 ， 文件名为使用rpm -qa|grep mysql 命令查出的所有文件</p></blockquote><blockquote><p>yum remove mysql</p></blockquote><p>查找到之前MySQL目录，删除老版本MySQL的文件和库</p><blockquote><p>find / -name mysql</p></blockquote><p>删除查找到的文件夹</p><blockquote><p>m -rf （查找到的文件夹路径）</p></blockquote><p>删除my.cnf</p><blockquote><p>rm -rf /etc/my.cnfs</p></blockquote><h4 id="安装mySQL"><a href="#安装mySQL" class="headerlink" title="安装mySQL"></a>安装mySQL</h4><blockquote><p>yum install mysql<br>yum install mysql.server</p></blockquote><h4 id="登录数据库"><a href="#登录数据库" class="headerlink" title="登录数据库"></a>登录数据库</h4><p>以root账户登陆mysql，默认是没有密码</p><blockquote><p>mysql -u root -p</p></blockquote><p> 回车后提示输入密码</p><h4 id="设置root账户密码"><a href="#设置root账户密码" class="headerlink" title="设置root账户密码"></a>设置root账户密码</h4><p>注意下面的you password改成你的要修改的密码</p><blockquote><p>mysql&gt; use mysql;<br>mysql&gt; update user set host = ‘password’ where user = ‘root’;<br>mysql&gt; FLUSH PRIVILEGES;</p></blockquote><h4 id="启动与关闭MySQL"><a href="#启动与关闭MySQL" class="headerlink" title="启动与关闭MySQL"></a>启动与关闭MySQL</h4><p>mysql 的守护进程是mysqld</p><h5 id="关闭mysql服务："><a href="#关闭mysql服务：" class="headerlink" title="关闭mysql服务："></a>关闭mysql服务：</h5><blockquote><p>service mysqld stop</p></blockquote><h5 id="开启mysql服务："><a href="#开启mysql服务：" class="headerlink" title="开启mysql服务："></a>开启mysql服务：</h5><blockquote><p>service mysqld start</p></blockquote><h4 id="连接本机上的mysql"><a href="#连接本机上的mysql" class="headerlink" title="连接本机上的mysql"></a>连接本机上的mysql</h4><p>键入命令mysql -u root -p， 回车后提示输入密码</p><h4 id="在MySQL里创建数据库"><a href="#在MySQL里创建数据库" class="headerlink" title="在MySQL里创建数据库"></a>在MySQL里创建数据库</h4><p>bus为数据库名</p><blockquote><p>sql&gt; create database bus</p></blockquote><h4 id="查看有哪些数据库"><a href="#查看有哪些数据库" class="headerlink" title="查看有哪些数据库"></a>查看有哪些数据库</h4><blockquote><p>show databases；</p></blockquote><h4 id="在数据库里执行SQL脚本创建表"><a href="#在数据库里执行SQL脚本创建表" class="headerlink" title="在数据库里执行SQL脚本创建表"></a>在数据库里执行SQL脚本创建表</h4><blockquote><p>use bus</p><p>source /usr/local/bus.sql</p></blockquote><h4 id="查看所有表"><a href="#查看所有表" class="headerlink" title="查看所有表"></a>查看所有表</h4><blockquote><p>show tables</p></blockquote><h4 id="退出mysql命令"><a href="#退出mysql命令" class="headerlink" title="退出mysql命令"></a>退出mysql命令</h4><blockquote><p>exit（回车)</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在Linux服务器下安装MySQL，注意要先检查自身是否已经安装过mariadb或MySQL，否则会安装失败。&lt;/p&gt;
    
    </summary>
    
      <category term="linux总结" scheme="http://iayun.vip/categories/linux%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="安装MySQL" scheme="http://iayun.vip/tags/%E5%AE%89%E8%A3%85MySQL/"/>
    
  </entry>
  
  <entry>
    <title>SpringBoot项目部署到Tomcat服务器</title>
    <link href="http://iayun.vip/SpringBoot%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2%E5%88%B0Tomcat%E6%9C%8D%E5%8A%A1%E5%99%A8.html"/>
    <id>http://iayun.vip/SpringBoot项目部署到Tomcat服务器.html</id>
    <published>2019-04-18T14:00:00.000Z</published>
    <updated>2019-04-21T05:55:46.513Z</updated>
    
    <content type="html"><![CDATA[<p>将springBoot项目打成war包，部署在Tomcat服务器上。</p><a id="more"></a><h4 id="修改打包形式"><a href="#修改打包形式" class="headerlink" title="修改打包形式"></a>修改打包形式</h4><p>在pom.xml里设置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">packaging&gt;war&lt;/packaging&gt;</span><br></pre></td></tr></table></figure><h4 id="除嵌入式tomcat插件（可不去）"><a href="#除嵌入式tomcat插件（可不去）" class="headerlink" title="除嵌入式tomcat插件（可不去）"></a>除嵌入式tomcat插件（可不去）</h4><p>在pom.xml里找到spring-boot-starter-web依赖节点，在其中添加如下代码，</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">    &lt;!-- 移除嵌入式tomcat插件 --&gt;</span><br><span class="line">    &lt;exclusions&gt;</span><br><span class="line">        &lt;exclusion&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class="line">        &lt;/exclusion&gt;</span><br><span class="line">    &lt;/exclusions&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h4 id="加servlet-api的依赖-可不加"><a href="#加servlet-api的依赖-可不加" class="headerlink" title="加servlet-api的依赖(可不加)"></a>加servlet-api的依赖(可不加)</h4><h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;javax.servlet&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;3.1.0&lt;/version&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dependency&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.tomcat&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;tomcat-servlet-api&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;8.5.20&lt;/version&gt;</span><br><span class="line">    &lt;scope&gt;provided&lt;/scope&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><p>version信息改成对应的tomcat版本信息</p><h4 id="定义项目打包的名字"><a href="#定义项目打包的名字" class="headerlink" title="定义项目打包的名字"></a>定义项目打包的名字</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;build&gt;</span><br><span class="line">    &lt;finalName&gt;project name&lt;/finalName&gt;</span><br><span class="line">    &lt;plugins&gt;</span><br><span class="line">      &lt;plugin&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">      &lt;/plugin&gt;</span><br><span class="line">    &lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br></pre></td></tr></table></figure><h4 id="修改启动类，并重写初始化方法"><a href="#修改启动类，并重写初始化方法" class="headerlink" title="修改启动类，并重写初始化方法"></a>修改启动类，并重写初始化方法</h4><p>我们法需要类似于web.xml的配置方式来启动spring上下文了，在Application类的同级添加一个SpringBootStartApplication类，其代码如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 修改启动类，继承 SpringBootServletInitializer 并重写 configure 方法</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public class SpringBootStartApplication extends SpringBootServletInitializer &#123;</span><br><span class="line"> </span><br><span class="line">      public static void main( String[] args )&#123;</span><br><span class="line">    SpringApplication.run(SpringBootStartApplication .class, args);</span><br><span class="line">&#125;</span><br><span class="line">     /**</span><br><span class="line">      *新增此方法</span><br><span class="line">      */</span><br><span class="line">      @Override</span><br><span class="line">    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) &#123;</span><br><span class="line">        // 注意这里要指向原先用main方法执行的Application启动类</span><br><span class="line">        return builder.sources(SpringBootStartApplication .class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="打war包"><a href="#打war包" class="headerlink" title="打war包"></a>打war包</h4><p>点击项目右键—&gt; run as—&gt;maven build</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/Tomcat%E9%83%A8%E7%BD%B2%E9%A1%B9%E7%9B%AE/maven%20package.jpg" alt="package"></p><p>箭头所示的两个地方要填写；然后点击apply-即可完成项目打包。</p><h4 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h4><p>把target目录下的war包放到tomcat的webapps目录下，启动tomcat，即可自动解压部署：（tomcat/bi目录下，双击startup.bat即可启动tomcat，成功启动，自动解压部署运行）</p><h4 id="访问地址"><a href="#访问地址" class="headerlink" title="访问地址"></a>访问地址</h4><p>最后在浏览器中输入<br><a href="http://localhost/" target="_blank" rel="noopener">http://localhost</a>:[端口号]/[打项目名]/</p><p>注意：端口号以tomcat配置时指定的为准，不是springboot中配置的了，项目名称一定要加，即war包的名字，然后才能访问你之前的请求路径</p><h4 id="出现问题"><a href="#出现问题" class="headerlink" title="出现问题"></a>出现问题</h4><h5 id="问题一：-ERROR-No-compiler-is-provided-in-this-environment-Perhaps-you-are-running-on-a-JRE-rather-than-a-JDK"><a href="#问题一：-ERROR-No-compiler-is-provided-in-this-environment-Perhaps-you-are-running-on-a-JRE-rather-than-a-JDK" class="headerlink" title="问题一：[ERROR] No compiler is provided in this environment. Perhaps you are running on a JRE rather than a JDK?"></a>问题一：[ERROR] No compiler is provided in this environment. Perhaps you are running on a JRE rather than a JDK?</h5><p>指定一个符合配置的JDK环境, 这是我们之前在Eclipse–&gt;Window–&gt;preferences–&gt;Java–&gt;Installed JREs下的配置jre就不行了, 而需要指定一个JDK目录 不过对于Java开发者来说, Installed JREs中使用jdk目录而非用jre目录也是最好的选择。</p><h5 id="问题二：在运行窗口出现乱码"><a href="#问题二：在运行窗口出现乱码" class="headerlink" title="问题二：在运行窗口出现乱码"></a>问题二：在运行窗口出现乱码</h5><p><strong>tomcat编码</strong></p><p>tomcat启动时默认使用系统编码，可更改tomcat bin目录下catalina.bat文件，在setlocal代码下面面加入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setlocal</span><br><span class="line"></span><br><span class="line">set -Dfile.encoding=UTF-8</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setlocal</span><br><span class="line"></span><br><span class="line">set JAVA_OPTS=-Xms512m -Xmx1024m -XX:MaxPermSize=1024m -Dfile.encoding=UTF8</span><br></pre></td></tr></table></figure><p>xms,xmx设置tomcat占用的最小内存和最大内存，-Dfile.encoding=UTF8设置tomcat编码格式</p><p><strong>修改 logging.properties 文件</strong></p><p>进入到 Tomcat目录下的conf 目录,打开 logging.properties 文件</p><p>将其 java.util.logging.ConsoleHandler.encoding = UTF-8 这一行注释掉,重新打开控制台即可</p><h5 id="问题三：the-cache-because-there-was-insufficient-free-space-available-after-evict"><a href="#问题三：the-cache-because-there-was-insufficient-free-space-available-after-evict" class="headerlink" title="问题三：the cache because there was insufficient free space available after evict"></a>问题三：the cache because there was insufficient free space available after evict</h5><p>tomcat的缓存因为没有足够的可用空间后加载文件</p><p>在tomcat的/conf/context.xml中的<context>中添加</context></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Resources</span><br><span class="line">    cachingAllowed=&quot;true&quot;</span><br><span class="line">    cacheMaxSize=&quot;100000&quot;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure><p> cacheMaxSize—-&gt;这里单位是 KB</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;将springBoot项目打成war包，部署在Tomcat服务器上。&lt;/p&gt;
    
    </summary>
    
      <category term="java总结" scheme="http://iayun.vip/categories/java%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="打war包" scheme="http://iayun.vip/tags/%E6%89%93war%E5%8C%85/"/>
    
      <category term="项目部署" scheme="http://iayun.vip/tags/%E9%A1%B9%E7%9B%AE%E9%83%A8%E7%BD%B2/"/>
    
  </entry>
  
  <entry>
    <title>导出Excel与根据模板导出word</title>
    <link href="http://iayun.vip/%E5%AF%BC%E5%87%BAExcel%E4%B8%8E%E6%A0%B9%E6%8D%AE%E6%A8%A1%E6%9D%BF%E5%AF%BC%E5%87%BAword.html"/>
    <id>http://iayun.vip/导出Excel与根据模板导出word.html</id>
    <published>2019-02-17T14:00:00.000Z</published>
    <updated>2019-04-21T10:13:34.466Z</updated>
    
    <content type="html"><![CDATA[<p>在页面统计数据，导出Excel,根据模板导出word</p><a id="more"></a><p>创建word文件</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E5%90%8E%E7%AB%AF%E7%9F%A5%E8%AF%86/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/word%E7%BB%9F%E8%AE%A1%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA%E6%A8%A1%E6%9D%BF.jpg" alt=""></p><h4 id="sdCagErrormonitorsStatTime-js"><a href="#sdCagErrormonitorsStatTime-js" class="headerlink" title="sdCagErrormonitorsStatTime.js"></a>sdCagErrormonitorsStatTime.js</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by admin on 2017/12/8.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">$(<span class="string">'#time'</span>).comboBox(&#123;</span><br><span class="line">    width: <span class="number">180</span>,</span><br><span class="line">    height: <span class="number">30</span>,</span><br><span class="line">    initValue: <span class="number">1</span>,</span><br><span class="line">    name: <span class="string">'time'</span>,</span><br><span class="line">    data: [</span><br><span class="line">        [<span class="string">'年度'</span>, <span class="string">'year'</span>],</span><br><span class="line">        [<span class="string">'季度'</span>, <span class="string">'season'</span>],</span><br><span class="line">        [<span class="string">'月度'</span>, <span class="string">'month'</span>]</span><br><span class="line">    ],</span><br><span class="line">    handler: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> comboVal = <span class="keyword">this</span>.comboBox(<span class="string">'getValue'</span>);</span><br><span class="line">        <span class="keyword">if</span> (comboVal == <span class="string">'year'</span>) &#123;</span><br><span class="line">            $(<span class="string">'#seasonDiv'</span>).hide();</span><br><span class="line">            $(<span class="string">'#monthDiv'</span>).hide();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (comboVal == <span class="string">'season'</span>) &#123;</span><br><span class="line">        $(<span class="string">'#seasonDiv'</span>).show();</span><br><span class="line">        $(<span class="string">'#monthDiv'</span>).hide();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (comboVal == <span class="string">'month'</span>) &#123;</span><br><span class="line">        $(<span class="string">'#seasonDiv'</span>).hide();</span><br><span class="line">        $(<span class="string">'#monthDiv'</span>).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">$(<span class="string">'#statType'</span>).comboBox(&#123;</span><br><span class="line">    width: <span class="number">180</span>,</span><br><span class="line">    height: <span class="number">30</span>,</span><br><span class="line">    initValue: <span class="number">1</span>,</span><br><span class="line">    name: <span class="string">'statType'</span>,</span><br><span class="line">    data: [</span><br><span class="line">        [<span class="string">'所属地区'</span>, <span class="string">'dyj_name'</span>],</span><br><span class="line">        [<span class="string">'装置类型'</span>, <span class="string">'mtype_name'</span>],</span><br><span class="line">        [<span class="string">'生产厂家'</span>, <span class="string">'factory'</span>]</span><br><span class="line">    ]</span><br><span class="line">&#125;);</span><br><span class="line">$(<span class="string">"#year"</span>).jeDate(&#123;</span><br><span class="line">    format: <span class="string">'YYYY'</span>,</span><br><span class="line">    isinitVal: <span class="literal">true</span>,</span><br><span class="line">    initAddVal: &#123;<span class="attr">YYYY</span>: <span class="string">"0"</span>&#125;,</span><br><span class="line">    isTime: <span class="literal">true</span>,</span><br><span class="line">&#125;);</span><br><span class="line">$(<span class="string">'#season'</span>).comboBox(&#123;</span><br><span class="line">    width: <span class="number">180</span>,</span><br><span class="line">    height: <span class="number">30</span>,</span><br><span class="line">    initValue: <span class="number">1</span>,</span><br><span class="line">    name: <span class="string">'season'</span>,</span><br><span class="line">    data: [</span><br><span class="line">        [<span class="string">'一'</span>, <span class="string">'1'</span>],</span><br><span class="line">        [<span class="string">'二'</span>, <span class="string">'2'</span>],</span><br><span class="line">        [<span class="string">'三'</span>, <span class="string">'3'</span>],</span><br><span class="line">        [<span class="string">'四'</span>, <span class="string">'4'</span>]</span><br><span class="line">    ]</span><br><span class="line">&#125;);</span><br><span class="line">$(<span class="string">'#month'</span>).comboBox(&#123;</span><br><span class="line">width: <span class="number">180</span>,</span><br><span class="line">height: <span class="number">30</span>,</span><br><span class="line">initValue: <span class="number">1</span>,</span><br><span class="line">name: <span class="string">'month'</span>,</span><br><span class="line">data: [</span><br><span class="line">[<span class="string">'1'</span>, <span class="string">'-01'</span>],</span><br><span class="line">[<span class="string">'2'</span>, <span class="string">'-02'</span>],</span><br><span class="line">[<span class="string">'3'</span>, <span class="string">'-03'</span>],</span><br><span class="line">[<span class="string">'4'</span>, <span class="string">'-04'</span>],</span><br><span class="line">[<span class="string">'5'</span>, <span class="string">'-05'</span>],</span><br><span class="line">[<span class="string">'6'</span>, <span class="string">'-06'</span>],</span><br><span class="line">[<span class="string">'7'</span>, <span class="string">'-07'</span>],</span><br><span class="line">[<span class="string">'8'</span>, <span class="string">'-08'</span>],</span><br><span class="line">[<span class="string">'9'</span>, <span class="string">'-09'</span>],</span><br><span class="line">[<span class="string">'10'</span>, <span class="string">'-10'</span>],</span><br><span class="line">[<span class="string">'11'</span>, <span class="string">'-11'</span>],</span><br><span class="line">[<span class="string">'12'</span>, <span class="string">'-12'</span>]</span><br><span class="line">]</span><br><span class="line">&#125;);</span><br><span class="line">getStatChart();</span><br><span class="line">$(<span class="string">'#baseForm'</span>).formSubmit(&#123;</span><br><span class="line">    beforeSubmit: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        getStatChart();</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">&#125;).formSubmit(<span class="string">'getParams'</span>);</span><br><span class="line"></span><br><span class="line">$(<span class="string">'#statBtn'</span>).idxButton(&#123;</span><br><span class="line">    type: <span class="string">'unTab'</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cm = [</span><br><span class="line">    &#123;<span class="attr">header</span>: <span class="string">"分类"</span>, <span class="attr">dataIndex</span>: <span class="string">"type"</span>, <span class="attr">width</span>: <span class="string">"10%"</span>, <span class="attr">align</span>: <span class="string">"center"</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">header</span>: <span class="string">"百分比"</span>, <span class="attr">dataIndex</span>: <span class="string">"percent"</span>, <span class="attr">width</span>: <span class="string">"10%"</span>, <span class="attr">align</span>: <span class="string">"center"</span>&#125;</span><br><span class="line">];</span><br><span class="line"><span class="keyword">var</span> toolBar = $.toolBar(&#123;</span><br><span class="line">    url: $.baseUrl() + <span class="string">'getStatTimeList.do'</span>,</span><br><span class="line">    baseForm: $(<span class="string">'#baseForm'</span>),</span><br><span class="line">    position: <span class="string">'left'</span>,</span><br><span class="line">    limit: <span class="number">10</span></span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">$(<span class="string">'.grid:first-child'</span>).grid(&#123;</span><br><span class="line">    cm: cm,</span><br><span class="line">    tbar: toolBar,</span><br><span class="line">    height: <span class="string">'100%'</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> imagesBase64 = <span class="string">''</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getStatChart</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: $.baseUrl() + <span class="string">'statTimeErrormonitors.do'</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">        time: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>),</span><br><span class="line">            statType: $(<span class="string">'#statType'</span>).comboBox(<span class="string">'getValue'</span>),</span><br><span class="line">            year: $(<span class="string">'#year'</span>).val(),</span><br><span class="line">            season: $(<span class="string">'#season'</span>).comboBox(<span class="string">'getValue'</span>),</span><br><span class="line">            month: $(<span class="string">'#month'</span>).comboBox(<span class="string">'getValue'</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        type: <span class="string">'post'</span>,</span><br><span class="line">        cache: <span class="literal">false</span>,</span><br><span class="line">        dataType: <span class="string">'json'</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> xA = [];</span><br><span class="line">            <span class="keyword">var</span> yA = [];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; data.length; i++) &#123;</span><br><span class="line">                xA.push(data[i].type);</span><br><span class="line">                yA.push((data[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">var</span> myChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'myChart'</span>));</span><br><span class="line">            myChart.setOption(&#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 完好率统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 完好率统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 完好率统计'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                animation: <span class="literal">false</span>,</span><br><span class="line">                tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data: [<span class="string">'百分比'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: xA,</span><br><span class="line">                    axisLabel: &#123;</span><br><span class="line">                        interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;</span><br><span class="line">                    min: <span class="number">0</span>,</span><br><span class="line">                    max: <span class="number">100</span>,</span><br><span class="line">                    formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'百分比'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    itemStyle: &#123;</span><br><span class="line">                        normal: &#123;</span><br><span class="line">                            color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">                                <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">                                    <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">                                    <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">                                    <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">                                <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            label: &#123;</span><br><span class="line">                                show: <span class="literal">true</span>,</span><br><span class="line">                                position: <span class="string">'top'</span>,</span><br><span class="line">                                formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    data: yA</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line">            imagesBase64 = myChart.getDataURL();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//统计故障率</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFaultRateChart</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: $.baseUrl() + <span class="string">'statFaultRate.do'</span>,</span><br><span class="line">        <span class="keyword">async</span> : <span class="literal">false</span>,</span><br><span class="line">        data: &#123;</span><br><span class="line">        time: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>),</span><br><span class="line">            year: $(<span class="string">'#year'</span>).val(),</span><br><span class="line">            season: $(<span class="string">'#season'</span>).comboBox(<span class="string">'getValue'</span>),</span><br><span class="line">            month: $(<span class="string">'#month'</span>).comboBox(<span class="string">'getValue'</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        type: <span class="string">'post'</span>,</span><br><span class="line">        cache: <span class="literal">false</span>,</span><br><span class="line">        dataType: <span class="string">'json'</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">        <span class="comment">//极值异常</span></span><br><span class="line">        <span class="comment">//极值异常故障率按所属地区统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xA = [];</span><br><span class="line">            <span class="keyword">var</span> yA = [];</span><br><span class="line">            <span class="keyword">var</span> dyjExtremeFaultRate = data.dyjExtremeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> dyjExtremeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'dyjExtremeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; dyjExtremeFaultRate.length; i++) &#123;</span><br><span class="line">            xA.push(dyjExtremeFaultRate[i].type);</span><br><span class="line">            yA.push((dyjExtremeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        dyjExtremeFaultRateChart.setOption(&#123;</span><br><span class="line">        title: &#123;</span><br><span class="line">        text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 极值异常故障率按所属地区统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 极值异常故障率按所属地区统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 极值异常故障率按所属地区统计'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        animation: <span class="literal">false</span>,</span><br><span class="line">        tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">        legend: &#123;</span><br><span class="line">        data: [<span class="string">'百分比'</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        xAxis: &#123;</span><br><span class="line">        data: xA,</span><br><span class="line">        axisLabel: &#123;</span><br><span class="line">        interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">        &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        yAxis: &#123;</span><br><span class="line">        min: <span class="number">0</span>,</span><br><span class="line">        max: <span class="number">100</span>,</span><br><span class="line">        formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        series: [&#123;</span><br><span class="line">        name: <span class="string">'百分比'</span>,</span><br><span class="line">        type: <span class="string">'bar'</span>,</span><br><span class="line">        itemStyle: &#123;</span><br><span class="line">        normal: &#123;</span><br><span class="line">        color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">        <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">        <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">        <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">        <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">        &#125;,</span><br><span class="line">        label: &#123;</span><br><span class="line">        show: <span class="literal">true</span>,</span><br><span class="line">        position: <span class="string">'top'</span>,</span><br><span class="line">        formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        data: yA</span><br><span class="line">        &#125;]</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//极值异常故障率按装置类型统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xB = [];</span><br><span class="line">            <span class="keyword">var</span> yB = [];</span><br><span class="line">            <span class="keyword">var</span> mtypeExtremeFaultRate = data.mtypeExtremeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> mtypeExtremeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'mtypeExtremeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; mtypeExtremeFaultRate.length; i++) &#123;</span><br><span class="line">            xB.push(mtypeExtremeFaultRate[i].type);</span><br><span class="line">            yB.push((mtypeExtremeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            mtypeExtremeFaultRateChart.setOption(&#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 极值异常故障率按装置类型统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 极值异常故障率按装置类型统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 极值异常故障率按装置类型统计'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                animation: <span class="literal">false</span>,</span><br><span class="line">                tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data: [<span class="string">'百分比'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: xB,</span><br><span class="line">                    axisLabel: &#123;</span><br><span class="line">                    interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;</span><br><span class="line">                    min: <span class="number">0</span>,</span><br><span class="line">                    max: <span class="number">100</span>,</span><br><span class="line">                    formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'百分比'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    itemStyle: &#123;</span><br><span class="line">                        normal: &#123;</span><br><span class="line">                            color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">                                <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">                                    <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">                                    <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">                                    <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">                                <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            label: &#123;</span><br><span class="line">                                show: <span class="literal">true</span>,</span><br><span class="line">                                position: <span class="string">'top'</span>,</span><br><span class="line">                                formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    data: yB</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//极值异常故障率按生产厂家统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xC = [];</span><br><span class="line">            <span class="keyword">var</span> yC = [];</span><br><span class="line">            <span class="keyword">var</span> factoryExtremeFaultRate = data.factoryExtremeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> factoryExtremeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'factoryExtremeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; factoryExtremeFaultRate.length; i++) &#123;</span><br><span class="line">            xC.push(factoryExtremeFaultRate[i].type);</span><br><span class="line">            yC.push((factoryExtremeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            factoryExtremeFaultRateChart.setOption(&#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 极值异常故障率按生产厂家统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 极值异常故障率按生产厂家统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 极值异常故障率按生产厂家统计'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                animation: <span class="literal">false</span>,</span><br><span class="line">                tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data: [<span class="string">'百分比'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: xC,</span><br><span class="line">                    axisLabel: &#123;</span><br><span class="line">                    interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span>  </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;</span><br><span class="line">                    min: <span class="number">0</span>,</span><br><span class="line">                    max: <span class="number">100</span>,</span><br><span class="line">                    formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'百分比'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    itemStyle: &#123;</span><br><span class="line">                        normal: &#123;</span><br><span class="line">                            color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">                                <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">                                    <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">                                    <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">                                    <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">                                <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            label: &#123;</span><br><span class="line">                                show: <span class="literal">true</span>,</span><br><span class="line">                                position: <span class="string">'top'</span>,</span><br><span class="line">                                formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    data: yC</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            <span class="comment">//数据量异常</span></span><br><span class="line">            <span class="comment">//数据量异常故障率按所属地区统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xD = [];</span><br><span class="line">            <span class="keyword">var</span> yD = [];</span><br><span class="line">            <span class="keyword">var</span> dyjVolumeFaultRate = data.dyjVolumeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> dyjVolumeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'dyjVolumeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; dyjVolumeFaultRate.length; i++) &#123;</span><br><span class="line">            xD.push(dyjVolumeFaultRate[i].type);</span><br><span class="line">            yD.push((dyjVolumeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        dyjVolumeFaultRateChart.setOption(&#123;</span><br><span class="line">        title: &#123;</span><br><span class="line">        text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 数据量异常故障率按所属地区统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 数据量异常故障率按所属地区统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 数据量异常故障率按所属地区统计'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        animation: <span class="literal">false</span>,</span><br><span class="line">        tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">        legend: &#123;</span><br><span class="line">        data: [<span class="string">'百分比'</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        xAxis: &#123;</span><br><span class="line">        data: xD,</span><br><span class="line">        axisLabel: &#123;</span><br><span class="line">        interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">        &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        yAxis: &#123;</span><br><span class="line">        min: <span class="number">0</span>,</span><br><span class="line">        max: <span class="number">100</span>,</span><br><span class="line">        formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        series: [&#123;</span><br><span class="line">        name: <span class="string">'百分比'</span>,</span><br><span class="line">        type: <span class="string">'bar'</span>,</span><br><span class="line">        itemStyle: &#123;</span><br><span class="line">        normal: &#123;</span><br><span class="line">        color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">        <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">        <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">        <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">        <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">        &#125;,</span><br><span class="line">        label: &#123;</span><br><span class="line">        show: <span class="literal">true</span>,</span><br><span class="line">        position: <span class="string">'top'</span>,</span><br><span class="line">        formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        data: yD</span><br><span class="line">        &#125;]</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//数据量异常故障率按装置类型统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xE = [];</span><br><span class="line">            <span class="keyword">var</span> yE = [];</span><br><span class="line">            <span class="keyword">var</span> mtypeVolumeFaultRate = data.mtypeVolumeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> mtypeVolumeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'mtypeVolumeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; mtypeVolumeFaultRate.length; i++) &#123;</span><br><span class="line">            xE.push(mtypeVolumeFaultRate[i].type);</span><br><span class="line">            yE.push((mtypeVolumeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            mtypeVolumeFaultRateChart.setOption(&#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 数据量异常故障率按装置类型统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 数据量异常故障率按装置类型统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 数据量异常故障率按装置类型统计'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                animation: <span class="literal">false</span>,</span><br><span class="line">                tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data: [<span class="string">'百分比'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: xE,</span><br><span class="line">                    axisLabel: &#123;</span><br><span class="line">                    interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;</span><br><span class="line">                    min: <span class="number">0</span>,</span><br><span class="line">                    max: <span class="number">100</span>,</span><br><span class="line">                    formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'百分比'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    itemStyle: &#123;</span><br><span class="line">                        normal: &#123;</span><br><span class="line">                            color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">                                <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">                                    <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">                                    <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">                                    <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">                                <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            label: &#123;</span><br><span class="line">                                show: <span class="literal">true</span>,</span><br><span class="line">                                position: <span class="string">'top'</span>,</span><br><span class="line">                                formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    data: yE</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//数据量异常故障率按生产厂家统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xF = [];</span><br><span class="line">            <span class="keyword">var</span> yF = [];</span><br><span class="line">            <span class="keyword">var</span> factoryVolumeFaultRate = data.factoryVolumeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> factoryVolumeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'factoryVolumeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; factoryVolumeFaultRate.length; i++) &#123;</span><br><span class="line">            xF.push(factoryVolumeFaultRate[i].type);</span><br><span class="line">            yF.push((factoryVolumeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            factoryVolumeFaultRateChart.setOption(&#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 数据量异常故障率按生产厂家统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 数据量异常故障率按生产厂家统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 数据量异常故障率按生产厂家统计'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                animation: <span class="literal">false</span>,</span><br><span class="line">                tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data: [<span class="string">'百分比'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: xF,</span><br><span class="line">                    axisLabel: &#123;</span><br><span class="line">                    interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;</span><br><span class="line">                    min: <span class="number">0</span>,</span><br><span class="line">                    max: <span class="number">100</span>,</span><br><span class="line">                    formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'百分比'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    itemStyle: &#123;</span><br><span class="line">                        normal: &#123;</span><br><span class="line">                            color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">                                <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">                                    <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">                                    <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">                                    <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">                                <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            label: &#123;</span><br><span class="line">                                show: <span class="literal">true</span>,</span><br><span class="line">                                position: <span class="string">'top'</span>,</span><br><span class="line">                                formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    data: yF</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//时间异常</span></span><br><span class="line">            <span class="comment">//时间异常故障率按所属地区统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xG = [];</span><br><span class="line">            <span class="keyword">var</span> yG = [];</span><br><span class="line">            <span class="keyword">var</span> dyjTimeFaultRate = data.dyjTimeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> dyjTimeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'dyjTimeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; dyjTimeFaultRate.length; i++) &#123;</span><br><span class="line">            xG.push(dyjTimeFaultRate[i].type);</span><br><span class="line">            yG.push((dyjTimeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        dyjTimeFaultRateChart.setOption(&#123;</span><br><span class="line">        title: &#123;</span><br><span class="line">        text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 时间异常故障率按所属地区统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 时间异常故障率按所属地区统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 时间异常故障率按所属地区统计'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        animation: <span class="literal">false</span>,</span><br><span class="line">        tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">        legend: &#123;</span><br><span class="line">        data: [<span class="string">'百分比'</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        xAxis: &#123;</span><br><span class="line">        data: xG,</span><br><span class="line">        axisLabel: &#123;</span><br><span class="line">        interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">        &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        yAxis: &#123;</span><br><span class="line">        min: <span class="number">0</span>,</span><br><span class="line">        max: <span class="number">100</span>,</span><br><span class="line">        formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        series: [&#123;</span><br><span class="line">        name: <span class="string">'百分比'</span>,</span><br><span class="line">        type: <span class="string">'bar'</span>,</span><br><span class="line">        itemStyle: &#123;</span><br><span class="line">        normal: &#123;</span><br><span class="line">        color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">        <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">        <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">        <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">        <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">        &#125;,</span><br><span class="line">        label: &#123;</span><br><span class="line">        show: <span class="literal">true</span>,</span><br><span class="line">        position: <span class="string">'top'</span>,</span><br><span class="line">        formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        data: yG</span><br><span class="line">        &#125;]</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//时间异常故障率按装置类型统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xH = [];</span><br><span class="line">            <span class="keyword">var</span> yH = [];</span><br><span class="line">            <span class="keyword">var</span> mtypeTimeFaultRate = data.mtypeTimeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> mtypeTimeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'mtypeTimeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; mtypeTimeFaultRate.length; i++) &#123;</span><br><span class="line">            xH.push(mtypeTimeFaultRate[i].type);</span><br><span class="line">            yH.push((mtypeTimeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            mtypeTimeFaultRateChart.setOption(&#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 时间异常故障率按装置类型统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 时间异常故障率按装置类型统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 时间异常故障率按装置类型统计'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                animation: <span class="literal">false</span>,</span><br><span class="line">                tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data: [<span class="string">'百分比'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: xH,</span><br><span class="line">                    axisLabel: &#123;</span><br><span class="line">                    interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;</span><br><span class="line">                    min: <span class="number">0</span>,</span><br><span class="line">                    max: <span class="number">100</span>,</span><br><span class="line">                    formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'百分比'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    itemStyle: &#123;</span><br><span class="line">                        normal: &#123;</span><br><span class="line">                            color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">                                <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">                                    <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">                                    <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">                                    <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">                                <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            label: &#123;</span><br><span class="line">                                show: <span class="literal">true</span>,</span><br><span class="line">                                position: <span class="string">'top'</span>,</span><br><span class="line">                                formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    data: yH</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//时间异常故障率按生产厂家统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xI = [];</span><br><span class="line">            <span class="keyword">var</span> yI = [];</span><br><span class="line">            <span class="keyword">var</span> factoryTimeFaultRate = data.factoryTimeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> factoryTimeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'factoryTimeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; factoryTimeFaultRate.length; i++) &#123;</span><br><span class="line">            xI.push(factoryTimeFaultRate[i].type);</span><br><span class="line">            yI.push((factoryTimeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            factoryTimeFaultRateChart.setOption(&#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 时间异常故障率按生产厂家统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 时间异常故障率按生产厂家统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 时间异常故障率按生产厂家统计'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                animation: <span class="literal">false</span>,</span><br><span class="line">                tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data: [<span class="string">'百分比'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: xI,</span><br><span class="line">                    axisLabel: &#123;</span><br><span class="line">                    interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;</span><br><span class="line">                    min: <span class="number">0</span>,</span><br><span class="line">                    max: <span class="number">100</span>,</span><br><span class="line">                    formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'百分比'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    itemStyle: &#123;</span><br><span class="line">                        normal: &#123;</span><br><span class="line">                            color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">                                <span class="keyword">var</span> colorList = [<span class="string">'#I33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">                                    <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">                                    <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">                                    <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">                                <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            label: &#123;</span><br><span class="line">                                show: <span class="literal">true</span>,</span><br><span class="line">                                position: <span class="string">'top'</span>,</span><br><span class="line">                                formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    data: yI</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//数值恒定</span></span><br><span class="line">            <span class="comment">//数值恒定异常故障率按所属地区统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xJ = [];</span><br><span class="line">            <span class="keyword">var</span> yJ = [];</span><br><span class="line">            <span class="keyword">var</span> dyjUnchangeFaultRate = data.dyjUnchangeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> dyjUnchangeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'dyjUnchangeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; dyjUnchangeFaultRate.length; i++) &#123;</span><br><span class="line">            xJ.push(dyjUnchangeFaultRate[i].type);</span><br><span class="line">            yJ.push((dyjUnchangeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">        dyjUnchangeFaultRateChart.setOption(&#123;</span><br><span class="line">        title: &#123;</span><br><span class="line">        text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 数值恒定异常故障率按所属地区统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 数值恒定异常故障率按所属地区统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 数值恒定异常故障率按所属地区统计'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        animation: <span class="literal">false</span>,</span><br><span class="line">        tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">        legend: &#123;</span><br><span class="line">        data: [<span class="string">'百分比'</span>]</span><br><span class="line">        &#125;,</span><br><span class="line">        xAxis: &#123;</span><br><span class="line">        data: xJ,</span><br><span class="line">        axisLabel: &#123;</span><br><span class="line">        interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">        &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        yAxis: &#123;</span><br><span class="line">        min: <span class="number">0</span>,</span><br><span class="line">        max: <span class="number">100</span>,</span><br><span class="line">        formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        series: [&#123;</span><br><span class="line">        name: <span class="string">'百分比'</span>,</span><br><span class="line">        type: <span class="string">'bar'</span>,</span><br><span class="line">        itemStyle: &#123;</span><br><span class="line">        normal: &#123;</span><br><span class="line">        color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42J'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">        <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">        <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">        <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">        <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">        &#125;,</span><br><span class="line">        label: &#123;</span><br><span class="line">        show: <span class="literal">true</span>,</span><br><span class="line">        position: <span class="string">'top'</span>,</span><br><span class="line">        formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        data: yJ</span><br><span class="line">        &#125;]</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//数值恒定异常故障率按装置类型统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xK = [];</span><br><span class="line">            <span class="keyword">var</span> yK = [];</span><br><span class="line">            <span class="keyword">var</span> mtypeUnchangeFaultRate = data.mtypeUnchangeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> mtypeUnchangeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'mtypeUnchangeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; mtypeUnchangeFaultRate.length; i++) &#123;</span><br><span class="line">            xK.push(mtypeUnchangeFaultRate[i].type);</span><br><span class="line">            yK.push((mtypeUnchangeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            mtypeUnchangeFaultRateChart.setOption(&#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 数值恒定异常故障率按装置类型统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 数值恒定异常故障率按装置类型统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 数值恒定异常故障率按装置类型统计'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                animation: <span class="literal">false</span>,</span><br><span class="line">                tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data: [<span class="string">'百分比'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: xK,</span><br><span class="line">                    axisLabel: &#123;</span><br><span class="line">                    interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;</span><br><span class="line">                    min: <span class="number">0</span>,</span><br><span class="line">                    max: <span class="number">100</span>,</span><br><span class="line">                    formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'百分比'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    itemStyle: &#123;</span><br><span class="line">                        normal: &#123;</span><br><span class="line">                            color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">                                <span class="keyword">var</span> colorList = [<span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">                                    <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">                                    <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">                                    <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">                                <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            label: &#123;</span><br><span class="line">                                show: <span class="literal">true</span>,</span><br><span class="line">                                position: <span class="string">'top'</span>,</span><br><span class="line">                                formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    data: yK</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//数值恒定异常故障率按生产厂家统计柱形图</span></span><br><span class="line">            <span class="keyword">var</span> xL = [];</span><br><span class="line">            <span class="keyword">var</span> yL = [];</span><br><span class="line">            <span class="keyword">var</span> factoryUnchangeFaultRate = data.factoryUnchangeFaultRate;</span><br><span class="line">            <span class="keyword">var</span> factoryUnchangeFaultRateChart = echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">'factoryUnchangeFaultRateChart'</span>));</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; factoryUnchangeFaultRate.length; i++) &#123;</span><br><span class="line">            xL.push(factoryUnchangeFaultRate[i].type);</span><br><span class="line">            yL.push((factoryUnchangeFaultRate[i].percent).toFixed(<span class="number">2</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            factoryUnchangeFaultRateChart.setOption(&#123;</span><br><span class="line">                title: &#123;</span><br><span class="line">                    text: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'year'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年 数值恒定异常故障率按生产厂家统计'</span>: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>)==<span class="string">'season'</span>? $(<span class="string">'#year'</span>).val() + <span class="string">'年第'</span> + $(<span class="string">'#season'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'季度 数值恒定异常故障率按生产厂家统计'</span>: $(<span class="string">'#year'</span>).val() + <span class="string">'年'</span> + $(<span class="string">'#month'</span>).comboBox(<span class="string">'getName'</span>) + <span class="string">'月份 数值恒定异常故障率按生产厂家统计'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                animation: <span class="literal">false</span>,</span><br><span class="line">                tooltip: &#123;<span class="attr">formatter</span>:<span class="string">'&#123;b&#125;\n&#123;c&#125;%'</span>&#125;,</span><br><span class="line">                legend: &#123;</span><br><span class="line">                    data: [<span class="string">'百分比'</span>]</span><br><span class="line">                &#125;,</span><br><span class="line">                xAxis: &#123;</span><br><span class="line">                    data: xL,</span><br><span class="line">                    axisLabel: &#123;</span><br><span class="line">                    interval: <span class="number">0</span>,</span><br><span class="line">                        rotate: <span class="number">15</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;,</span><br><span class="line">                yAxis: &#123;</span><br><span class="line">                    min: <span class="number">0</span>,</span><br><span class="line">                    max: <span class="number">100</span>,</span><br><span class="line">                    formatter: <span class="string">'&#123;value&#125;%'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                series: [&#123;</span><br><span class="line">                    name: <span class="string">'百分比'</span>,</span><br><span class="line">                    type: <span class="string">'bar'</span>,</span><br><span class="line">                    itemStyle: &#123;</span><br><span class="line">                        normal: &#123;</span><br><span class="line">                            color: <span class="function"><span class="keyword">function</span> (<span class="params">params</span>) </span>&#123;</span><br><span class="line">                                <span class="keyword">var</span> colorList = [<span class="string">'#L33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>, <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>,</span><br><span class="line">                                    <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#C39BD3 '</span>, <span class="string">'#F9E79F'</span>, <span class="string">'#BA4A00'</span>, <span class="string">'#ECF0F1'</span>,</span><br><span class="line">                                    <span class="string">'#616A6B'</span>, <span class="string">'#EAF2F8'</span>, <span class="string">'#4A235A'</span>, <span class="string">'#3498DB'</span>, <span class="string">'#C33531'</span>, <span class="string">'#EFE42A'</span>, <span class="string">'#64BD3D'</span>, <span class="string">'#EE9201'</span>,</span><br><span class="line">                                    <span class="string">'#29AAE3'</span>, <span class="string">'#B74AE5'</span>, <span class="string">'#0AAF9F'</span>, <span class="string">'#E89589'</span>, <span class="string">'#16A085'</span>, <span class="string">'#4A235A'</span>];</span><br><span class="line">                                <span class="keyword">return</span> colorList[params.dataIndex]</span><br><span class="line">                            &#125;,</span><br><span class="line">                            label: &#123;</span><br><span class="line">                                show: <span class="literal">true</span>,</span><br><span class="line">                                position: <span class="string">'top'</span>,</span><br><span class="line">                                formatter: <span class="string">'&#123;c&#125;%'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    data: yL</span><br><span class="line">                &#125;]</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            imagesBase64DyjExtreme = dyjExtremeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64MtypeExtreme = mtypeExtremeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64FactoryExtreme = factoryExtremeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64DyjVolume = dyjVolumeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64MtypeVolume = mtypeVolumeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64FactoryVolume = factoryVolumeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64DyjTime = dyjTimeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64MtypeTime = mtypeTimeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64FactoryTime = factoryTimeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64DyjUnchange = dyjUnchangeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64MtypeUnchange = mtypeUnchangeFaultRateChart.getDataURL();</span><br><span class="line">            imagesBase64FactoryUnchange = factoryUnchangeFaultRateChart.getDataURL();</span><br><span class="line">            </span><br><span class="line">            $(<span class="string">"#dyjExtremeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#mtypeExtremeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#factoryExtremeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#dyjVolumeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#mtypeVolumeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#factoryVolumeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#dyjTimeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#mtypeTimeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#factoryTimeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#dyjUnchangeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#mtypeUnchangeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            $(<span class="string">"#factoryUnchangeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'none'</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">var</span> url = $.baseUrl() + <span class="string">'exportTimeWord.do'</span>;</span><br><span class="line">            <span class="keyword">var</span> colNames = [];</span><br><span class="line">            <span class="keyword">var</span> keys = [];</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">for</span> (i <span class="keyword">in</span> cm) &#123;</span><br><span class="line">        colNames.push(cm[i].header);</span><br><span class="line">        keys.push(cm[i].dataIndex);</span><br><span class="line">        &#125;</span><br><span class="line">            url = url + <span class="string">'?columnNames='</span> + colNames + <span class="string">'&amp;keys='</span> + keys;</span><br><span class="line">            $.ajax(&#123;</span><br><span class="line">                url: url,</span><br><span class="line">                <span class="keyword">async</span> : <span class="literal">false</span>,</span><br><span class="line">                data: &#123;</span><br><span class="line">                imagesBase64DyjExtreme: imagesBase64DyjExtreme,</span><br><span class="line">                imagesBase64MtypeExtreme: imagesBase64MtypeExtreme,</span><br><span class="line">                imagesBase64FactoryExtreme: imagesBase64FactoryExtreme,</span><br><span class="line">                imagesBase64DyjVolume: imagesBase64DyjVolume,</span><br><span class="line">                imagesBase64MtypeVolume: imagesBase64MtypeVolume,</span><br><span class="line">                imagesBase64FactoryVolume: imagesBase64FactoryVolume,</span><br><span class="line">                imagesBase64DyjTime: imagesBase64DyjTime,</span><br><span class="line">                imagesBase64MtypeTime: imagesBase64MtypeTime,</span><br><span class="line">                imagesBase64FactoryTime: imagesBase64FactoryTime,</span><br><span class="line">                imagesBase64DyjUnchange: imagesBase64DyjUnchange,</span><br><span class="line">                imagesBase64MtypeUnchange: imagesBase64MtypeUnchange,</span><br><span class="line">                imagesBase64FactoryUnchange: imagesBase64FactoryUnchange,</span><br><span class="line">                time: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>),</span><br><span class="line">                    year: $(<span class="string">'#year'</span>).val(),</span><br><span class="line">                    season: $(<span class="string">'#season'</span>).comboBox(<span class="string">'getValue'</span>),</span><br><span class="line">                    month: $(<span class="string">'#month'</span>).comboBox(<span class="string">'getValue'</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                type: <span class="string">'post'</span>,</span><br><span class="line">                cache: <span class="literal">false</span>,</span><br><span class="line">                dataType: <span class="string">'json'</span>,</span><br><span class="line">                success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">                    <span class="built_in">window</span>.location.href = data.filePath;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">exportXls</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> url = $.baseUrl() + <span class="string">'exportTimeXls.do'</span>;</span><br><span class="line">    <span class="keyword">var</span> colNames = [];</span><br><span class="line">    <span class="keyword">var</span> keys = [];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (i <span class="keyword">in</span> cm) &#123;</span><br><span class="line">colNames.push(cm[i].header);</span><br><span class="line">keys.push(cm[i].dataIndex);</span><br><span class="line">&#125;</span><br><span class="line">    url = url + <span class="string">'?columnNames='</span> + colNames + <span class="string">'&amp;keys='</span> + keys;</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: url,</span><br><span class="line">        data: &#123;</span><br><span class="line">        imagesBase64: imagesBase64,</span><br><span class="line">        time: $(<span class="string">'#time'</span>).comboBox(<span class="string">'getValue'</span>),</span><br><span class="line">        statType: $(<span class="string">'#statType'</span>).comboBox(<span class="string">'getValue'</span>),</span><br><span class="line">            year: $(<span class="string">'#year'</span>).val(),</span><br><span class="line">            season: $(<span class="string">'#season'</span>).comboBox(<span class="string">'getValue'</span>),</span><br><span class="line">            month: $(<span class="string">'#month'</span>).comboBox(<span class="string">'getValue'</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        type: <span class="string">'post'</span>,</span><br><span class="line">        cache: <span class="literal">false</span>,</span><br><span class="line">        dataType: <span class="string">'json'</span>,</span><br><span class="line">        success: <span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">            <span class="built_in">window</span>.location.href = data.filePath;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">exportWord</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">$(<span class="string">"#dyjExtremeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">$(<span class="string">"#mtypeExtremeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">$(<span class="string">"#factoryExtremeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line"></span><br><span class="line">$(<span class="string">"#dyjVolumeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">$(<span class="string">"#mtypeVolumeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">$(<span class="string">"#factoryVolumeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line"></span><br><span class="line">$(<span class="string">"#dyjTimeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">$(<span class="string">"#mtypeTimeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">$(<span class="string">"#factoryTimeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line"></span><br><span class="line">$(<span class="string">"#dyjUnchangeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">$(<span class="string">"#mtypeUnchangeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">$(<span class="string">"#factoryUnchangeFaultRateChart"</span>).css(<span class="string">'display'</span>,<span class="string">'block'</span>);</span><br><span class="line">getFaultRateChart();</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h4 id="sdCagErrormonitorsStatTime-html"><a href="#sdCagErrormonitorsStatTime-html" class="headerlink" title="sdCagErrormonitorsStatTime.html"></a>sdCagErrormonitorsStatTime.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;link rel="shortcut icon" href="resources/img/favicon.ico" type="image/x-icon"&gt; --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"$&#123;ctxPath&#125;/static/resourcesV3/bootstrap/bootstrap.min.css"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"$&#123;ctxPath&#125;/static/resourcesV3/css/font-awesome.min.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"$&#123;ctxPath&#125;/static/resourcesV3/css/common.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"$&#123;ctxPath&#125;/static/resourcesV3/css/style.css"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"$&#123;ctxPath&#125;/static/resourcesV3/jedate/skin/jedate.css"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"$&#123;ctxPath&#125;/static/zxjc/styles/css/common_add.css"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--css/js--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">"text/css"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .pub_section &#123;</span></span><br><span class="line"><span class="undefined">            overflow: auto;</span></span><br><span class="line"><span class="undefined">            overflow-x: hidden;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        #baseForm &#123;</span></span><br><span class="line"><span class="undefined">            width: 95%;</span></span><br><span class="line"><span class="undefined">            height: 0.75rem;</span></span><br><span class="line"><span class="undefined">            margin: auto;</span></span><br><span class="line"><span class="undefined">            border-bottom: 0.015rem dashed #3f8ab9;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        #baseForm .col-2 &#123;</span></span><br><span class="line"><span class="undefined">            height: 0.4rem;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        #baseForm .col-2 &gt; div &#123;</span></span><br><span class="line"><span class="undefined">            height: 100%;</span></span><br><span class="line"><span class="undefined">            display: flex;</span></span><br><span class="line"><span class="undefined">            align-content: center;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .col-2 .col-4 &#123;</span></span><br><span class="line"><span class="undefined">            justify-content: flex-end;</span></span><br><span class="line"><span class="undefined">            padding-right: 0.1rem;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .subContainer &#123;</span></span><br><span class="line"><span class="undefined">            width: 100%;</span></span><br><span class="line"><span class="undefined">            /* position: absolute; */</span></span><br><span class="line"><span class="undefined">            top: 1.5rem;</span></span><br><span class="line"><span class="undefined">            bottom: 0.75rem;</span></span><br><span class="line"><span class="undefined">            /* border: 1px solid;*/</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        .grids &#123;</span></span><br><span class="line"><span class="undefined">            position: relative;</span></span><br><span class="line"><span class="undefined">            width: 95%;</span></span><br><span class="line"><span class="undefined">            height: 95%;</span></span><br><span class="line"><span class="undefined">            margin: 0 auto;</span></span><br><span class="line"><span class="undefined">            /*border-top: 0.015rem solid #3F8AB9;*/</span></span><br><span class="line"><span class="undefined">            display: flex;</span></span><br><span class="line"><span class="undefined">            justify-content: space-around;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>装置完好率按时间维度统计<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">"main-body-home-1"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">"pub_section clearfix"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"baseForm"</span> <span class="attr">autocomplete</span>=<span class="string">"off"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-2"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-4"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span>时间维度:<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-8"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"time"</span> <span class="attr">name</span>=<span class="string">"time"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-2"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-4"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span>统计类型:<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-8"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"statType"</span> <span class="attr">name</span>=<span class="string">"statType"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-2"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-4"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span>年份:<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-8"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"year"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"Wdate"</span> <span class="attr">name</span>=<span class="string">"year"</span> <span class="attr">readonly</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-2"</span> <span class="attr">id</span>=<span class="string">"seasonDiv"</span> <span class="attr">style</span>=<span class="string">"display:none"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-4"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span>季度:<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-8"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"season"</span> <span class="attr">name</span>=<span class="string">"season"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-2"</span> <span class="attr">id</span>=<span class="string">"monthDiv"</span> <span class="attr">style</span>=<span class="string">"display:none"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-4"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span>&gt;</span>月度:<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-8"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"month"</span> <span class="attr">name</span>=<span class="string">"month"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-12 nav-tab-3"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"nav-tab-span-5"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"float:left;display: flex;height: 0.35rem;align-items: center;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">"width:1.5rem;height: 80%;"</span> <span class="attr">id</span>=<span class="string">"statBtn"</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>统计</span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"fa fa-search"</span> <span class="attr">style</span>=<span class="string">"width: 0.8rem;text-align: right;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"reset"</span> <span class="attr">style</span>=<span class="string">"width: 1rem;height: 100%;float:left;margin-left: 0.1rem;"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">"btn_new_noBorder"</span>&gt;</span>重置</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">"width: 1rem;height: 100%;float:left;margin-left: 0.1rem;"</span> <span class="attr">type</span>=<span class="string">"button"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">"btn_new_left"</span> <span class="attr">id</span>=<span class="string">"export-btn"</span> <span class="attr">onclick</span>=<span class="string">"exportXls();"</span>&gt;</span>导出报表</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">style</span>=<span class="string">"width: 1rem;height: 100%;float:left;margin-left: 0.1rem;"</span> <span class="attr">type</span>=<span class="string">"button"</span></span></span><br><span class="line"><span class="tag">                        <span class="attr">class</span>=<span class="string">"btn_new_left"</span> <span class="attr">id</span>=<span class="string">"export-btn"</span> <span class="attr">onclick</span>=<span class="string">"exportWord();"</span>&gt;</span>生成报告</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"subContainer"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"myChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dyjExtremeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"mtypeExtremeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"factoryExtremeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dyjVolumeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"mtypeVolumeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"factoryVolumeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dyjTimeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"mtypeTimeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"factoryTimeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"dyjUnchangeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"mtypeUnchangeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"factoryUnchangeFaultRateChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;display: none"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"grids"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"grid"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"$&#123;ctxPath&#125;/static/resourcesV3/js/jquery-1.10.1.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"$&#123;ctxPath&#125;/static/resourcesV3/js/bootstrap.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"$&#123;ctxPath&#125;/static/resourcesV3/js/common.js"</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"$&#123;ctxPath&#125;/static/resourcesV3/jedate/jquery.jedate.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"$&#123;ctxPath&#125;/static/resourcesV3/js/echarts-all.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"$&#123;ctxPath&#125;/static/biz/sdCagErrormonitorsStatTime.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="SdCagErrormonitorsController-java"><a href="#SdCagErrormonitorsController-java" class="headerlink" title="SdCagErrormonitorsController.java"></a>SdCagErrormonitorsController.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.matai.sdoms.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.bean.CustomPager;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.bean.SdCagCodeContent;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.bean.TsDevice;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.constant.Constant;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.service.ISdCagCodeContentService;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.service.ISdCagErrormonitorsService;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.service.ITsDeviceService;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.util.ArrayUtil;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.util.DateUtil;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.util.ExcelUtil;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.util.JsonUtil;</span><br><span class="line"><span class="keyword">import</span> com.matai.sdoms.util.WordUtils;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/sdCagErrormonitors"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SdCagErrormonitorsController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ISdCagErrormonitorsService sdCagErrormonitorsService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ISdCagCodeContentService sdCagCodeContentService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ITsDeviceService tsDeviceService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/index.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">index</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        List&lt;SdCagCodeContent&gt; codeContentList = sdCagCodeContentService.getCodeContentList(Constant.ERROR_TYPE);</span><br><span class="line">        List&lt;SdCagCodeContent&gt; codeContents = sdCagCodeContentService.getCodeContentList(Constant.ERROR_IP);</span><br><span class="line">        codeContentList.addAll(codeContents);</span><br><span class="line">        request.setAttribute(<span class="string">"contentArr"</span>, ArrayUtil.getArrayFirstStr(codeContentList, <span class="string">"value"</span>, <span class="string">"code"</span>));</span><br><span class="line">        JSONObject jsonObj = JsonUtil.getJSONObject(codeContentList, <span class="string">"code"</span>, <span class="string">"value"</span>);</span><br><span class="line">        request.setAttribute(<span class="string">"contentObj"</span>, jsonObj);</span><br><span class="line">        </span><br><span class="line">        codeContentList = sdCagCodeContentService.getCodeContentList(Constant.VOLTAGE_GRADE);</span><br><span class="line">        request.setAttribute(<span class="string">"voltageArr"</span>, ArrayUtil.getArrayFirstStr(codeContentList, <span class="string">"value"</span>, <span class="string">"code"</span>));</span><br><span class="line">        jsonObj = JsonUtil.getJSONObject(codeContentList, <span class="string">"code"</span>, <span class="string">"value"</span>);</span><br><span class="line">        request.setAttribute(<span class="string">"voltageObj"</span>, jsonObj);</span><br><span class="line">        </span><br><span class="line">        List&lt;TsDevice&gt; deviceList = tsDeviceService.getMTypeDataList();</span><br><span class="line">        request.setAttribute(<span class="string">"mtypeArr"</span>, ArrayUtil.getArrayFirstStr(deviceList, <span class="string">"mtype_name"</span>, <span class="string">"mtype_id"</span>));</span><br><span class="line">        jsonObj = JsonUtil.getJSONObject(deviceList, <span class="string">"mtype_id"</span>, <span class="string">"mtype_name"</span>);</span><br><span class="line">        request.setAttribute(<span class="string">"mtypeObj"</span>, jsonObj);</span><br><span class="line">        </span><br><span class="line">        deviceList = tsDeviceService.getFactoryList();</span><br><span class="line">        request.setAttribute(<span class="string">"factoryArr"</span>, ArrayUtil.getArrayFirstStr(deviceList, <span class="string">"factory"</span>, <span class="string">"factory"</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/sdCagErrormonitors"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/getErrormonitorsList.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> CustomPager&lt;Map&lt;String, Object&gt;&gt; getErrormonitorsList(HttpServletRequest request) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        String dyjName = request.getParameter(<span class="string">"dyjname"</span>);</span><br><span class="line">        String dydj = request.getParameter(<span class="string">"dydj"</span>);</span><br><span class="line">        String lineName = request.getParameter(<span class="string">"line"</span>);</span><br><span class="line">        String mtype = request.getParameter(<span class="string">"mtypename"</span>);</span><br><span class="line">        String deviceId = request.getParameter(<span class="string">"deviceId"</span>);</span><br><span class="line">        String factory = request.getParameter(<span class="string">"factory"</span>);</span><br><span class="line">        String errorType = request.getParameter(<span class="string">"errorType"</span>);</span><br><span class="line"></span><br><span class="line">        SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">        Long begin = sdf.parse(request.getParameter(<span class="string">"begin"</span>)).getTime();</span><br><span class="line">        Long end = sdf.parse(request.getParameter(<span class="string">"end"</span>)).getTime() + <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>-<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        Integer start = Integer.parseInt(request.getParameter(<span class="string">"start"</span>));</span><br><span class="line">        String rows = request.getParameter(<span class="string">"limit"</span>);</span><br><span class="line">        String page = String.valueOf(start / Integer.valueOf(rows) + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sdCagErrormonitorsService.getErrormonitorsPager(dyjName, dydj, lineName, mtype, deviceId, factory, errorType, begin, end, page, rows, start);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/stat.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">stat</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/sdCagErrormonitorsStat"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/statErrormonitors.do"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">statErrormonitors</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String statType = request.getParameter(<span class="string">"statType"</span>);</span><br><span class="line">    SimpleDateFormat sdf = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd"</span>);</span><br><span class="line">        Long begin = sdf.parse(request.getParameter(<span class="string">"begin"</span>)).getTime();</span><br><span class="line">        Long end = sdf.parse(request.getParameter(<span class="string">"end"</span>)).getTime() + <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>-<span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> JSON.toJSONString(sdCagErrormonitorsService.getStat(statType, begin, end));</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/statYearly.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">statYearly</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    List&lt;TsDevice&gt; deviceList = tsDeviceService.getMTypeDataList();</span><br><span class="line">        request.setAttribute(<span class="string">"mtypeArr"</span>, ArrayUtil.getArrayStr(deviceList, <span class="string">"mtype_name"</span>, <span class="string">"mtype_name"</span>));</span><br><span class="line">        </span><br><span class="line">        deviceList = tsDeviceService.getFactoryList();</span><br><span class="line">        request.setAttribute(<span class="string">"factoryArr"</span>, ArrayUtil.getArrayStr(deviceList, <span class="string">"factory"</span>, <span class="string">"factory"</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/sdCagErrormonitorsStatYearly"</span>);</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/statYearlyErrormonitors.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">statYearlyErrormonitors</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String statType = request.getParameter(<span class="string">"statType"</span>);</span><br><span class="line">    String typeValue = request.getParameter(<span class="string">"typeValue"</span>);</span><br><span class="line">    Long begin = DateUtil.getYearBeginMillis(request.getParameter(<span class="string">"begin"</span>));</span><br><span class="line">    Long end = DateUtil.getYearEndMillis(request.getParameter(<span class="string">"end"</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> JSON.toJSONString(sdCagErrormonitorsService.getStatYearly(statType, typeValue, begin, end));</span><br><span class="line">    </span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 按时间维度统计完好率</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/statTime.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">statTime</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/sdCagErrormonitorsStatTime"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/statTimeErrormonitors.do"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">statTimeErrormonitors</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String time = request.getParameter(<span class="string">"time"</span>);</span><br><span class="line">    String statType = request.getParameter(<span class="string">"statType"</span>);</span><br><span class="line">    String year = request.getParameter(<span class="string">"year"</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"season"</span>.equals(time)) &#123;</span><br><span class="line">    Integer yr = Integer.valueOf(year);</span><br><span class="line">        Integer season = Integer.valueOf(request.getParameter(<span class="string">"season"</span>));</span><br><span class="line">        <span class="keyword">return</span> JSON.toJSONString(sdCagErrormonitorsService.getStatSeason(statType, yr, season));</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    Long begin = DateUtil.getYearBeginMillis(year);</span><br><span class="line">    Long end = DateUtil.getYearEndMillis(year);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"month"</span>.equals(time)) &#123;</span><br><span class="line">    String month = request.getParameter(<span class="string">"month"</span>);</span><br><span class="line">    begin = DateUtil.getMonthBeginMillis(year + month);</span><br><span class="line">    end = DateUtil.getMonthEndMillis(year + month);</span><br><span class="line">    <span class="keyword">return</span> JSON.toJSONString(sdCagErrormonitorsService.getStat(statType, begin, end));</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> JSON.toJSONString(sdCagErrormonitorsService.getStat(statType, begin, end));</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/getStatTimeList.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> CustomPager&lt;Map&lt;String, Object&gt;&gt; getStatTimeList(HttpServletRequest request) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    </span><br><span class="line">    String time = request.getParameter(<span class="string">"time"</span>);</span><br><span class="line">    String statType = request.getParameter(<span class="string">"statType"</span>);</span><br><span class="line">    String year = request.getParameter(<span class="string">"year"</span>);</span><br><span class="line">    </span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mapList = <span class="keyword">new</span> ArrayList&lt;Map&lt;String, Object&gt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"season"</span>.equals(time)) &#123;</span><br><span class="line">        Integer yr = Integer.valueOf(year);</span><br><span class="line">        Integer season = Integer.valueOf(request.getParameter(<span class="string">"season"</span>));</span><br><span class="line">        </span><br><span class="line">        mapList = sdCagErrormonitorsService.getStatSeason(statType, yr, season);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="string">"year"</span>.equals(time)) &#123;</span><br><span class="line">    Long begin = DateUtil.getYearBeginMillis(year);</span><br><span class="line">    Long end = DateUtil.getYearEndMillis(year);</span><br><span class="line">    </span><br><span class="line">    mapList = sdCagErrormonitorsService.getStat(statType, begin, end);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    String month = request.getParameter(<span class="string">"month"</span>);</span><br><span class="line">    Long begin = DateUtil.getMonthBeginMillis(year + month);</span><br><span class="line">    Long end = DateUtil.getMonthEndMillis(year + month);</span><br><span class="line">    </span><br><span class="line">    mapList = sdCagErrormonitorsService.getStat(statType, begin, end);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (Map&lt;String, Object&gt; map : mapList) &#123;</span><br><span class="line">BigDecimal o = (BigDecimal) (map.get(<span class="string">"percent"</span>));</span><br><span class="line">String s = String.format(<span class="string">"%.2f"</span>, o) + <span class="string">"%"</span>;</span><br><span class="line">map.put(<span class="string">"percent"</span>, s);</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> sdCagErrormonitorsService.getStatPager(mapList);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/exportTimeXls.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">exportTimeXls</span><span class="params">(HttpServletRequest request, HttpServletResponse response</span></span></span><br><span class="line"><span class="function"><span class="params">    , @RequestParam(<span class="string">"columnNames"</span>)</span> String[] columnNames, @<span class="title">RequestParam</span><span class="params">(<span class="string">"keys"</span>)</span> String[] keys) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String time = request.getParameter(<span class="string">"time"</span>);</span><br><span class="line">    String statType = request.getParameter(<span class="string">"statType"</span>);</span><br><span class="line">    String year = request.getParameter(<span class="string">"year"</span>);</span><br><span class="line">    </span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mapList = <span class="keyword">new</span> ArrayList&lt;Map&lt;String, Object&gt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"season"</span>.equals(time)) &#123;</span><br><span class="line">        Integer yr = Integer.valueOf(year);</span><br><span class="line">        Integer season = Integer.valueOf(request.getParameter(<span class="string">"season"</span>));</span><br><span class="line">        </span><br><span class="line">        mapList = sdCagErrormonitorsService.getStatSeason(statType, yr, season);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"year"</span>.equals(time)) &#123;</span><br><span class="line">    Long begin = DateUtil.getYearBeginMillis(year);</span><br><span class="line">    Long end = DateUtil.getYearEndMillis(year);</span><br><span class="line">    </span><br><span class="line">    mapList = sdCagErrormonitorsService.getStat(statType, begin, end);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    String month = request.getParameter(<span class="string">"month"</span>);</span><br><span class="line">    Long begin = DateUtil.getMonthBeginMillis(year + month);</span><br><span class="line">    Long end = DateUtil.getMonthEndMillis(year + month);</span><br><span class="line">    </span><br><span class="line">    mapList = sdCagErrormonitorsService.getStat(statType, begin, end);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    Base64 base64 = <span class="keyword">new</span> Base64();</span><br><span class="line">    <span class="keyword">byte</span>[] image = base64.decode(request.getParameter(<span class="string">"imagesBase64"</span>).substring(<span class="number">22</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (image == <span class="keyword">null</span>) &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (Map&lt;String, Object&gt; map : mapList) &#123;</span><br><span class="line">    BigDecimal o = (BigDecimal) (map.get(<span class="string">"percent"</span>));</span><br><span class="line">    String s = String.format(<span class="string">"%.2f"</span>, o) + <span class="string">"%"</span>;</span><br><span class="line">    map.put(<span class="string">"percent"</span>, s);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">    resultJson.put(<span class="string">"filePath"</span>, ExcelUtil.exportXls(response, mapList, keys, columnNames, image));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 故障率查询</span></span><br><span class="line"><span class="comment">     * 极值故障率 ExtremeFaultRate</span></span><br><span class="line"><span class="comment">     * 数据量异常故障率 VolumeFaultRate </span></span><br><span class="line"><span class="comment">     * 时间异常故障率 TimeFaultRate</span></span><br><span class="line"><span class="comment">     * 数值恒定故障率 UnchangeFaultRate</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/statFaultRate.do"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">statFaultRate</span><span class="params">(HttpServletRequest request)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String time = request.getParameter(<span class="string">"time"</span>);</span><br><span class="line">    String year = request.getParameter(<span class="string">"year"</span>);</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"season"</span>.equals(time)) &#123;</span><br><span class="line">    Integer yr = Integer.valueOf(year);</span><br><span class="line">        Integer season = Integer.valueOf(request.getParameter(<span class="string">"season"</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//季度报告数据</span></span><br><span class="line">        <span class="keyword">long</span> s1 = System.currentTimeMillis();</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjExtremeFaultRate = sdCagErrormonitorsService.getSeasonExtremeFaultRate(<span class="string">"dyj_name"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeExtremeFaultRate = sdCagErrormonitorsService.getSeasonExtremeFaultRate(<span class="string">"mtype_name"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryExtremeFaultRate = sdCagErrormonitorsService.getSeasonExtremeFaultRate(<span class="string">"factory"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjVolumeFaultRate = sdCagErrormonitorsService.getSeasonVolumeFaultRate(<span class="string">"dyj_name"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeVolumeFaultRate = sdCagErrormonitorsService.getSeasonVolumeFaultRate(<span class="string">"mtype_name"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryVolumeFaultRate = sdCagErrormonitorsService.getSeasonVolumeFaultRate(<span class="string">"factory"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjTimeFaultRate = sdCagErrormonitorsService.getSeasonTimeFaultRate(<span class="string">"dyj_name"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeTimeFaultRate = sdCagErrormonitorsService.getSeasonTimeFaultRate(<span class="string">"mtype_name"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryTimeFaultRate = sdCagErrormonitorsService.getSeasonTimeFaultRate(<span class="string">"factory"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjUnchangeFaultRate = sdCagErrormonitorsService.getSeasonUnchangeFaultRate(<span class="string">"dyj_name"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeUnchangeFaultRate = sdCagErrormonitorsService.getSeasonUnchangeFaultRate(<span class="string">"mtype_name"</span>, yr, season);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryUnchangeFaultRate = sdCagErrormonitorsService.getSeasonUnchangeFaultRate(<span class="string">"factory"</span>, yr, season);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">long</span> s2 = System.currentTimeMillis();</span><br><span class="line">        System.out.println(s2-s1);</span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"dyjExtremeFaultRate"</span>, dyjExtremeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"mtypeExtremeFaultRate"</span>, mtypeExtremeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"factoryExtremeFaultRate"</span>, factoryExtremeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"dyjVolumeFaultRate"</span>, dyjVolumeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"mtypeVolumeFaultRate"</span>, mtypeVolumeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"factoryVolumeFaultRate"</span>, factoryVolumeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"dyjTimeFaultRate"</span>, dyjTimeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"mtypeTimeFaultRate"</span>, mtypeTimeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"factoryTimeFaultRate"</span>, factoryTimeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"dyjUnchangeFaultRate"</span>, dyjUnchangeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"mtypeUnchangeFaultRate"</span>, mtypeUnchangeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"factoryUnchangeFaultRate"</span>, factoryUnchangeFaultRate);</span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    Long begin = DateUtil.getYearBeginMillis(year);</span><br><span class="line">    Long end = DateUtil.getYearEndMillis(year);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"month"</span>.equals(time)) &#123;</span><br><span class="line">    String month = request.getParameter(<span class="string">"month"</span>);</span><br><span class="line">    begin = DateUtil.getMonthBeginMillis(year + month);</span><br><span class="line">    end = DateUtil.getMonthEndMillis(year + month);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//月度报告数据</span></span><br><span class="line">        <span class="keyword">long</span> s1 = System.currentTimeMillis();</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjExtremeFaultRate = sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"dyj_name"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeExtremeFaultRate = sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"mtype_name"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryExtremeFaultRate = sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"factory"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjVolumeFaultRate = sdCagErrormonitorsService.getYearVolumeFaultRate(<span class="string">"dyj_name"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeVolumeFaultRate = sdCagErrormonitorsService.getYearVolumeFaultRate(<span class="string">"mtype_name"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryVolumeFaultRate = sdCagErrormonitorsService.getYearVolumeFaultRate(<span class="string">"factory"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjTimeFaultRate = sdCagErrormonitorsService.getYearTimeFaultRate(<span class="string">"dyj_name"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeTimeFaultRate = sdCagErrormonitorsService.getYearTimeFaultRate(<span class="string">"mtype_name"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryTimeFaultRate = sdCagErrormonitorsService.getYearTimeFaultRate(<span class="string">"factory"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjUnchangeFaultRate = sdCagErrormonitorsService.getYearUnchangeFaultRate(<span class="string">"dyj_name"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeUnchangeFaultRate = sdCagErrormonitorsService.getYearUnchangeFaultRate(<span class="string">"mtype_name"</span>, begin, end);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryUnchangeFaultRate = sdCagErrormonitorsService.getYearUnchangeFaultRate(<span class="string">"factory"</span>, begin, end);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">long</span> s2 = System.currentTimeMillis();</span><br><span class="line">        System.out.println(s2-s1);</span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"dyjExtremeFaultRate"</span>, dyjExtremeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"mtypeExtremeFaultRate"</span>, mtypeExtremeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"factoryExtremeFaultRate"</span>, factoryExtremeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"dyjVolumeFaultRate"</span>, dyjVolumeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"mtypeVolumeFaultRate"</span>, mtypeVolumeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"factoryVolumeFaultRate"</span>, factoryVolumeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"dyjTimeFaultRate"</span>, dyjTimeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"mtypeTimeFaultRate"</span>, mtypeTimeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"factoryTimeFaultRate"</span>, factoryTimeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"dyjUnchangeFaultRate"</span>, dyjUnchangeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"mtypeUnchangeFaultRate"</span>, mtypeUnchangeFaultRate);</span><br><span class="line">        resultJson.put(<span class="string">"factoryUnchangeFaultRate"</span>, factoryUnchangeFaultRate);</span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//年度报告数据</span></span><br><span class="line">    <span class="keyword">long</span> s1 = System.currentTimeMillis();</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; dyjExtremeFaultRate = sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"dyj_name"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mtypeExtremeFaultRate = sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"mtype_name"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; factoryExtremeFaultRate = sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"factory"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; dyjVolumeFaultRate = sdCagErrormonitorsService.getYearVolumeFaultRate(<span class="string">"dyj_name"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mtypeVolumeFaultRate = sdCagErrormonitorsService.getYearVolumeFaultRate(<span class="string">"mtype_name"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; factoryVolumeFaultRate = sdCagErrormonitorsService.getYearVolumeFaultRate(<span class="string">"factory"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; dyjTimeFaultRate = sdCagErrormonitorsService.getYearTimeFaultRate(<span class="string">"dyj_name"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mtypeTimeFaultRate = sdCagErrormonitorsService.getYearTimeFaultRate(<span class="string">"mtype_name"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; factoryTimeFaultRate = sdCagErrormonitorsService.getYearTimeFaultRate(<span class="string">"factory"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; dyjUnchangeFaultRate = sdCagErrormonitorsService.getYearUnchangeFaultRate(<span class="string">"dyj_name"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mtypeUnchangeFaultRate = sdCagErrormonitorsService.getYearUnchangeFaultRate(<span class="string">"mtype_name"</span>, begin, end);</span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; factoryUnchangeFaultRate = sdCagErrormonitorsService.getYearUnchangeFaultRate(<span class="string">"factory"</span>, begin, end);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">long</span> s2 = System.currentTimeMillis();</span><br><span class="line">    System.out.println(s2-s1);</span><br><span class="line">    JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">    resultJson.put(<span class="string">"dyjExtremeFaultRate"</span>, dyjExtremeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"mtypeExtremeFaultRate"</span>, mtypeExtremeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"factoryExtremeFaultRate"</span>, factoryExtremeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"dyjVolumeFaultRate"</span>, dyjVolumeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"mtypeVolumeFaultRate"</span>, mtypeVolumeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"factoryVolumeFaultRate"</span>, factoryVolumeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"dyjTimeFaultRate"</span>, dyjTimeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"mtypeTimeFaultRate"</span>, mtypeTimeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"factoryTimeFaultRate"</span>, factoryTimeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"dyjUnchangeFaultRate"</span>, dyjUnchangeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"mtypeUnchangeFaultRate"</span>, mtypeUnchangeFaultRate);</span><br><span class="line">    resultJson.put(<span class="string">"factoryUnchangeFaultRate"</span>, factoryUnchangeFaultRate);</span><br><span class="line">    <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 故障率导出</span></span><br><span class="line"><span class="comment">     * 极值故障率 ExtremeFaultRate</span></span><br><span class="line"><span class="comment">     * 数据量异常故障率 VolumeFaultRate </span></span><br><span class="line"><span class="comment">     * 时间异常故障率 TimeFaultRate</span></span><br><span class="line"><span class="comment">     * 数值恒定故障率 UnchangeFaultRate</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/exportTimeWord.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">exportWord</span><span class="params">(HttpServletRequest request, HttpServletResponse response</span></span></span><br><span class="line"><span class="function"><span class="params">    , @RequestParam(<span class="string">"columnNames"</span>)</span> String[] columnNames, @<span class="title">RequestParam</span><span class="params">(<span class="string">"keys"</span>)</span> String[] keys) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String time = request.getParameter(<span class="string">"time"</span>);</span><br><span class="line">    String year = request.getParameter(<span class="string">"year"</span>);</span><br><span class="line">    </span><br><span class="line">    Base64 base64 = <span class="keyword">new</span> Base64();</span><br><span class="line">    <span class="comment">//生成图片</span></span><br><span class="line">    Map&lt;String, Object&gt; pictureExtremeDyj = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">    pictureExtremeDyj.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">    pictureExtremeDyj.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">    pictureExtremeDyj.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">    pictureExtremeDyj.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64DyjExtreme"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        Map&lt;String, Object&gt; pictureExtremeMtype = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        pictureExtremeMtype.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">        pictureExtremeMtype.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">        pictureExtremeMtype.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">        pictureExtremeMtype.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64MtypeExtreme"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        Map&lt;String, Object&gt; pictureExtremeFactory = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        pictureExtremeFactory.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">        pictureExtremeFactory.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">        pictureExtremeFactory.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">        pictureExtremeFactory.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64FactoryExtreme"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">    </span><br><span class="line">        Map&lt;String, Object&gt; pictureVolumeDyj = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">    pictureVolumeDyj.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">    pictureVolumeDyj.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">    pictureVolumeDyj.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">    pictureVolumeDyj.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64DyjVolume"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        Map&lt;String, Object&gt; pictureVolumeMtype = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        pictureVolumeMtype.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">        pictureVolumeMtype.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">        pictureVolumeMtype.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">        pictureVolumeMtype.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64MtypeVolume"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        Map&lt;String, Object&gt; pictureVolumeFactory = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        pictureVolumeFactory.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">        pictureVolumeFactory.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">        pictureVolumeFactory.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">        pictureVolumeFactory.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64FactoryVolume"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; pictureTimeDyj = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">    pictureTimeDyj.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">    pictureTimeDyj.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">    pictureTimeDyj.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">    pictureTimeDyj.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64DyjTime"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        Map&lt;String, Object&gt; pictureTimeMtype = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        pictureTimeMtype.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">        pictureTimeMtype.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">        pictureTimeMtype.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">        pictureTimeMtype.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64MtypeTime"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        Map&lt;String, Object&gt; pictureTimeFactory = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        pictureTimeFactory.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">        pictureTimeFactory.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">        pictureTimeFactory.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">        pictureTimeFactory.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64FactoryTime"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; pictureUnchangeDyj = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">    pictureUnchangeDyj.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">    pictureUnchangeDyj.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">    pictureUnchangeDyj.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">    pictureUnchangeDyj.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64DyjUnchange"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        Map&lt;String, Object&gt; pictureUnchangeMtype = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        pictureUnchangeMtype.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">        pictureUnchangeMtype.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">        pictureUnchangeMtype.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">        pictureUnchangeMtype.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64MtypeUnchange"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        Map&lt;String, Object&gt; pictureUnchangeFactory = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        pictureUnchangeFactory.put(<span class="string">"width"</span>, <span class="number">560</span>);</span><br><span class="line">        pictureUnchangeFactory.put(<span class="string">"height"</span>, <span class="number">300</span>);</span><br><span class="line">        pictureUnchangeFactory.put(<span class="string">"type"</span>, <span class="string">"jpg"</span>);</span><br><span class="line">        pictureUnchangeFactory.put(<span class="string">"content"</span>,base64.decode(request.getParameter(<span class="string">"imagesBase64FactoryUnchange"</span>).substring(<span class="number">22</span>)));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//导出word</span></span><br><span class="line">        WordUtils wordUtil = <span class="keyword">new</span> WordUtils();</span><br><span class="line">        Map&lt;String, Object&gt; params = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        params.put(<span class="string">"$&#123;pictureExtremeDyj&#125;"</span>, pictureExtremeDyj);</span><br><span class="line">        params.put(<span class="string">"$&#123;pictureExtremeMtype&#125;"</span>, pictureExtremeMtype);</span><br><span class="line">        params.put(<span class="string">"$&#123;pictureExtremeFactory&#125;"</span>, pictureExtremeFactory);</span><br><span class="line">        </span><br><span class="line">        params.put(<span class="string">"$&#123;pictureVolumeDyj&#125;"</span>, pictureVolumeDyj);</span><br><span class="line">        params.put(<span class="string">"$&#123;pictureVolumeMtype&#125;"</span>, pictureVolumeMtype);</span><br><span class="line">        params.put(<span class="string">"$&#123;pictureVolumeFactory&#125;"</span>, pictureVolumeFactory);</span><br><span class="line">        </span><br><span class="line">        params.put(<span class="string">"$&#123;pictureTimeDyj&#125;"</span>, pictureTimeDyj);</span><br><span class="line">        params.put(<span class="string">"$&#123;pictureTimeMtype&#125;"</span>, pictureTimeMtype);</span><br><span class="line">        params.put(<span class="string">"$&#123;pictureTimeFactory&#125;"</span>, pictureTimeFactory);</span><br><span class="line">        </span><br><span class="line">        params.put(<span class="string">"$&#123;pictureUnchangeDyj&#125;"</span>, pictureUnchangeDyj);</span><br><span class="line">        params.put(<span class="string">"$&#123;pictureUnchangeMtype&#125;"</span>, pictureUnchangeMtype);</span><br><span class="line">        params.put(<span class="string">"$&#123;pictureUnchangeFactory&#125;"</span>, pictureUnchangeFactory);</span><br><span class="line">        </span><br><span class="line">        params.put(<span class="string">"$&#123;faultTypes&#125;"</span>, <span class="string">"统计类型"</span>);</span><br><span class="line">        params.put(<span class="string">"$&#123;faultRate&#125;"</span>, <span class="string">"故障率"</span>);</span><br><span class="line">        </span><br><span class="line">        params.put(<span class="string">"$&#123;titleFault&#125;"</span>, <span class="string">"1.1 错误数据分析"</span>);</span><br><span class="line">        params.put(<span class="string">"$&#123;titleExtreme&#125;"</span>, <span class="string">"1.1.1 极值型异常"</span>);</span><br><span class="line">        params.put(<span class="string">"$&#123;titleVolume&#125;"</span>, <span class="string">"1.1.2 数据量异常"</span>);</span><br><span class="line">        params.put(<span class="string">"$&#123;titleTime&#125;"</span>, <span class="string">"1.1.3 时间异常"</span>);</span><br><span class="line">        params.put(<span class="string">"$&#123;titleUnchange&#125;"</span>, <span class="string">"1.1.4 数值恒定异常"</span>);</span><br><span class="line">        </span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mapList = <span class="keyword">new</span> ArrayList&lt;Map&lt;String, Object&gt;&gt;();</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">"season"</span>.equals(time)) &#123;</span><br><span class="line">        Integer yr = Integer.valueOf(year);</span><br><span class="line">        Integer season = Integer.valueOf(request.getParameter(<span class="string">"season"</span>));</span><br><span class="line">        </span><br><span class="line">    String title = yr +<span class="string">"年第"</span>+ season + <span class="string">"季度故障率统计报告"</span>;</span><br><span class="line">        params.put(<span class="string">"$&#123;name&#125;"</span>, title);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 需要进行动态生成的信息</span></span><br><span class="line">            Map&lt;String, Object&gt; tableList = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">            mapList = sdCagErrormonitorsService.getSeasonExtremeFaultRate(<span class="string">"dyj_name"</span>, yr, season);</span><br><span class="line">            tableList.put(<span class="string">"mapList"</span>, mapList);</span><br><span class="line">            </span><br><span class="line">            String fileName = <span class="keyword">new</span> String((title+<span class="string">".docx"</span>).getBytes(<span class="string">"UTF-8"</span>), <span class="string">"UTF-8"</span>); <span class="comment">// 生成word文件的文件名</span></span><br><span class="line">            JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"filePath"</span>, wordUtil.getWord(params, fileName, tableList, response));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">"year"</span>.equals(time)) &#123;</span><br><span class="line">    Long begin = DateUtil.getYearBeginMillis(year);</span><br><span class="line">    Long end = DateUtil.getYearEndMillis(year);</span><br><span class="line">    </span><br><span class="line">    String title = year + <span class="string">"年度故障率统计报告"</span>;</span><br><span class="line">        params.put(<span class="string">"$&#123;title&#125;"</span>, title);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 需要进行动态生成的信息</span></span><br><span class="line">            Map&lt;String, Object&gt; tableList = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">            mapList = sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"dyj_name"</span>, begin, end);</span><br><span class="line">        </span><br><span class="line">            tableList.put(<span class="string">"dyjExtremeList"</span>, sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"dyj_name"</span>, begin, end));</span><br><span class="line">            tableList.put(<span class="string">"mtypeExtremeList"</span>, sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"mtype_name"</span>, begin, end));</span><br><span class="line">            tableList.put(<span class="string">"factoryExtremeList"</span>, sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"factory"</span>, begin, end));</span><br><span class="line">            </span><br><span class="line">            tableList.put(<span class="string">"dyjVolumeList"</span>, sdCagErrormonitorsService.getYearVolumeFaultRate(<span class="string">"dyj_name"</span>, begin, end));</span><br><span class="line">            tableList.put(<span class="string">"mtypeVolumeList"</span>, sdCagErrormonitorsService.getYearVolumeFaultRate(<span class="string">"mtype_name"</span>, begin, end));</span><br><span class="line">            tableList.put(<span class="string">"factoryVolumeList"</span>, sdCagErrormonitorsService.getYearVolumeFaultRate(<span class="string">"factory"</span>, begin, end));</span><br><span class="line">            </span><br><span class="line">            tableList.put(<span class="string">"dyjTimeList"</span>, sdCagErrormonitorsService.getYearTimeFaultRate(<span class="string">"dyj_name"</span>, begin, end));</span><br><span class="line">            tableList.put(<span class="string">"mtypeTimeList"</span>, sdCagErrormonitorsService.getYearTimeFaultRate(<span class="string">"mtype_name"</span>, begin, end));</span><br><span class="line">            tableList.put(<span class="string">"factoryTimeList"</span>, sdCagErrormonitorsService.getYearTimeFaultRate(<span class="string">"factory"</span>, begin, end));</span><br><span class="line">            </span><br><span class="line">            tableList.put(<span class="string">"dyjUnchangeList"</span>, sdCagErrormonitorsService.getYearUnchangeFaultRate(<span class="string">"dyj_name"</span>, begin, end));</span><br><span class="line">            tableList.put(<span class="string">"mtypeUnchangeList"</span>, sdCagErrormonitorsService.getYearUnchangeFaultRate(<span class="string">"mtype_name"</span>, begin, end));</span><br><span class="line">            tableList.put(<span class="string">"factoryUnchangeList"</span>, sdCagErrormonitorsService.getYearUnchangeFaultRate(<span class="string">"factory"</span>, begin, end));</span><br><span class="line">            </span><br><span class="line">            String fileName = <span class="keyword">new</span> String((title+<span class="string">".docx"</span>).getBytes(<span class="string">"UTF-8"</span>), <span class="string">"UTF-8"</span>); <span class="comment">// 生成word文件的文件名</span></span><br><span class="line">            JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"filePath"</span>, wordUtil.getWord(params, fileName, tableList, response));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    String month = request.getParameter(<span class="string">"month"</span>);</span><br><span class="line">    Long begin = DateUtil.getMonthBeginMillis(year + month);</span><br><span class="line">    Long end = DateUtil.getMonthEndMillis(year + month);</span><br><span class="line">    </span><br><span class="line">    String title = year+<span class="string">"年"</span>+month+ <span class="string">"月度故障率统计报告"</span>;</span><br><span class="line">        params.put(<span class="string">"$&#123;name&#125;"</span>, title);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 需要进行动态生成的信息</span></span><br><span class="line">            Map&lt;String, Object&gt; tableList = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">            mapList = sdCagErrormonitorsService.getYearExtremeFaultRate(<span class="string">"dyj_name"</span>, begin, end);</span><br><span class="line">            tableList.put(<span class="string">"mapList"</span>, mapList);</span><br><span class="line">            </span><br><span class="line">            String fileName = <span class="keyword">new</span> String((title+<span class="string">".docx"</span>).getBytes(<span class="string">"UTF-8"</span>), <span class="string">"UTF-8"</span>); <span class="comment">// 生成word文件的文件名</span></span><br><span class="line">            JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"filePath"</span>, wordUtil.getWord(params, fileName, tableList, response));</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/getStatYearList.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> CustomPager&lt;Map&lt;String, Object&gt;&gt; getStatYearList(HttpServletRequest request) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    </span><br><span class="line">    String statType = request.getParameter(<span class="string">"statType"</span>);</span><br><span class="line">    Long begin = DateUtil.getYearBeginMillis(request.getParameter(<span class="string">"year"</span>));</span><br><span class="line">    Long end = DateUtil.getYearEndMillis(request.getParameter(<span class="string">"year"</span>));</span><br><span class="line">    </span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mapList = sdCagErrormonitorsService.getStat(statType, begin, end);</span><br><span class="line">    <span class="keyword">for</span> (Map&lt;String, Object&gt; map : mapList) &#123;</span><br><span class="line">BigDecimal o = (BigDecimal) (map.get(<span class="string">"percent"</span>));</span><br><span class="line">String s = String.format(<span class="string">"%.2f"</span>, o) + <span class="string">"%"</span>;</span><br><span class="line">map.put(<span class="string">"percent"</span>, s);</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> sdCagErrormonitorsService.getStatPager(mapList);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/exportYearXls.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">exportYearXls</span><span class="params">(HttpServletRequest request, HttpServletResponse response</span></span></span><br><span class="line"><span class="function"><span class="params">    , @RequestParam(<span class="string">"columnNames"</span>)</span> String[] columnNames, @<span class="title">RequestParam</span><span class="params">(<span class="string">"keys"</span>)</span> String[] keys) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String statType = request.getParameter(<span class="string">"statType"</span>);</span><br><span class="line">    Long begin = DateUtil.getYearBeginMillis(request.getParameter(<span class="string">"year"</span>));</span><br><span class="line">    Long end = DateUtil.getYearEndMillis(request.getParameter(<span class="string">"year"</span>));</span><br><span class="line">    Base64 base64 = <span class="keyword">new</span> Base64();</span><br><span class="line">    <span class="keyword">byte</span>[] image = base64.decode(request.getParameter(<span class="string">"imagesBase64"</span>).substring(<span class="number">22</span>));</span><br><span class="line">    </span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mapList = sdCagErrormonitorsService.getStat(statType, begin, end);</span><br><span class="line">    <span class="keyword">for</span> (Map&lt;String, Object&gt; map : mapList) &#123;</span><br><span class="line">    BigDecimal o = (BigDecimal) (map.get(<span class="string">"percent"</span>));</span><br><span class="line">    String s = String.format(<span class="string">"%.2f"</span>, o) + <span class="string">"%"</span>;</span><br><span class="line">    map.put(<span class="string">"percent"</span>, s);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">    resultJson.put(<span class="string">"filePath"</span>, ExcelUtil.exportXls(response, mapList, keys, columnNames, image));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/statSeason.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">statSeason</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/sdCagErrormonitorsStatSeason"</span>);</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/statSeasonErrormonitors.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">statSeasonErrormonitors</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String statType = request.getParameter(<span class="string">"statType"</span>);</span><br><span class="line">    Integer year = Integer.valueOf(request.getParameter(<span class="string">"year"</span>));</span><br><span class="line">    Integer season = Integer.valueOf(request.getParameter(<span class="string">"season"</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> JSON.toJSONString(sdCagErrormonitorsService.getStatSeason(statType, year, season));</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/getStatSeasonList.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="keyword">public</span> CustomPager&lt;Map&lt;String, Object&gt;&gt; getStatSeasonList(HttpServletRequest request) &#123;</span><br><span class="line">    </span><br><span class="line">    String statType = request.getParameter(<span class="string">"statType"</span>);</span><br><span class="line">    Integer year = Integer.valueOf(request.getParameter(<span class="string">"year"</span>));</span><br><span class="line">    Integer season = Integer.valueOf(request.getParameter(<span class="string">"season"</span>));</span><br><span class="line">    </span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mapList = sdCagErrormonitorsService.getStatSeason(statType, year, season);</span><br><span class="line">    <span class="keyword">for</span> (Map&lt;String, Object&gt; map : mapList) &#123;</span><br><span class="line">    BigDecimal o = (BigDecimal) (map.get(<span class="string">"percent"</span>));</span><br><span class="line">    String s = String.format(<span class="string">"%.2f"</span>, o) + <span class="string">"%"</span>;</span><br><span class="line">    map.put(<span class="string">"percent"</span>, s);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> sdCagErrormonitorsService.getStatPager(mapList);</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/exportSeasonXls.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">exportSeasonXls</span><span class="params">(HttpServletRequest request, HttpServletResponse response</span></span></span><br><span class="line"><span class="function"><span class="params">    , @RequestParam(<span class="string">"columnNames"</span>)</span> String[] columnNames, @<span class="title">RequestParam</span><span class="params">(<span class="string">"keys"</span>)</span> String[] keys) <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String statType = request.getParameter(<span class="string">"statType"</span>);</span><br><span class="line">    Integer year = Integer.valueOf(request.getParameter(<span class="string">"year"</span>));</span><br><span class="line">    Integer season = Integer.valueOf(request.getParameter(<span class="string">"season"</span>));</span><br><span class="line">    Base64 base64 = <span class="keyword">new</span> Base64();</span><br><span class="line">    <span class="keyword">byte</span>[] image = base64.decode(request.getParameter(<span class="string">"imagesBase64"</span>).substring(<span class="number">22</span>));</span><br><span class="line">    </span><br><span class="line">    List&lt;Map&lt;String, Object&gt;&gt; mapList = sdCagErrormonitorsService.getStatSeason(statType, year, season);</span><br><span class="line">    <span class="keyword">for</span> (Map&lt;String, Object&gt; map : mapList) &#123;</span><br><span class="line">    BigDecimal o = (BigDecimal) (map.get(<span class="string">"percent"</span>));</span><br><span class="line">    String s = String.format(<span class="string">"%.2f"</span>, o) + <span class="string">"%"</span>;</span><br><span class="line">    map.put(<span class="string">"percent"</span>, s);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">    resultJson.put(<span class="string">"filePath"</span>, ExcelUtil.exportXls(response, mapList, keys, columnNames, image));</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/countByTwo.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">countByTwo</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    List&lt;SdCagCodeContent&gt; codeContentList = sdCagCodeContentService.getCodeContentList(Constant.ERROR_TYPE);</span><br><span class="line">    List&lt;SdCagCodeContent&gt; codeContents = sdCagCodeContentService.getCodeContentList(Constant.ERROR_IP);</span><br><span class="line">    codeContentList.addAll(codeContents);</span><br><span class="line">        JSONObject jsonObj = JsonUtil.getJSONObject(codeContentList, <span class="string">"code"</span>, <span class="string">"value"</span>);</span><br><span class="line">        request.setAttribute(<span class="string">"contentObj"</span>, jsonObj);</span><br><span class="line">        </span><br><span class="line">        codeContentList = sdCagCodeContentService.getCodeContentList(Constant.VOLTAGE_GRADE);</span><br><span class="line">        jsonObj = JsonUtil.getJSONObject(codeContentList, <span class="string">"code"</span>, <span class="string">"value"</span>);</span><br><span class="line">        request.setAttribute(<span class="string">"voltageObj"</span>, jsonObj);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/sdCagErrormonitorsCountByTwo"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="WordUtils-java"><a href="#WordUtils-java" class="headerlink" title="WordUtils.java"></a>WordUtils.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.matai.sdoms.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xwpf.usermodel.*;</span><br><span class="line"><span class="keyword">import</span> org.openxmlformats.schemas.wordprocessingml.x2006.main.CTTcPr;</span><br><span class="line"><span class="keyword">import</span> org.openxmlformats.schemas.wordprocessingml.x2006.main.CTVMerge;</span><br><span class="line"><span class="keyword">import</span> org.openxmlformats.schemas.wordprocessingml.x2006.main.STMerge;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.ClassUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Iterator;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******************************************</span></span><br><span class="line"><span class="comment"> * 通过word模板生成新的word工具类</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Package</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Date</span></span></span><br><span class="line"><span class="comment"> *******************************************/</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WordUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据模板生成word</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path      模板的路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> params    需要替换的参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> tableList 需要插入的参数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName  生成word文件的文件名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getWord</span><span class="params">(Map&lt;String, Object&gt; params, String fileName, Map&lt;String, Object&gt; tableList,</span></span></span><br><span class="line"><span class="function"><span class="params">            HttpServletResponse response)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 模板文件位置</span></span><br><span class="line">        String mobanPath = <span class="keyword">new</span> File(<span class="string">""</span>).getCanonicalPath() + <span class="string">"/src/main/resources/static/tempfile/mobanFile.docx"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//生成文件</span></span><br><span class="line">        String filePath = ClassUtils.getDefaultClassLoader().getResource(<span class="string">""</span>).getPath().substring(<span class="number">1</span>) + <span class="string">"static/tempfile/"</span> + fileName;</span><br><span class="line">        </span><br><span class="line">    File file = <span class="keyword">new</span> File(filePath);</span><br><span class="line">        <span class="keyword">if</span> (file.exists()) &#123;</span><br><span class="line">file.delete();</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line">        InputStream is = <span class="keyword">new</span> FileInputStream(mobanPath);</span><br><span class="line">        CustomXWPFDocument doc = <span class="keyword">new</span> CustomXWPFDocument(is);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 替换文本里面的变量</span></span><br><span class="line">        <span class="keyword">this</span>.replaceInPara(doc, params);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 替换表格里面的变量</span></span><br><span class="line">        <span class="keyword">this</span>.replaceInTable(doc, params, tableList);</span><br><span class="line">        </span><br><span class="line">        FileOutputStream os = <span class="keyword">new</span> FileOutputStream(filePath);</span><br><span class="line">        doc.write(os);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">this</span>.close(os);</span><br><span class="line">        <span class="keyword">this</span>.close(is);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">"/static/tempfile/"</span> + fileName;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 替换段落里面的变量</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> doc    要替换的文档</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> params 参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">replaceInPara</span><span class="params">(CustomXWPFDocument doc, Map&lt;String, Object&gt; params)</span> </span>&#123;</span><br><span class="line">        Iterator&lt;XWPFParagraph&gt; iterator = doc.getParagraphsIterator();</span><br><span class="line">        XWPFParagraph para;</span><br><span class="line">        <span class="keyword">while</span> (iterator.hasNext()) &#123;</span><br><span class="line">            para = iterator.next();</span><br><span class="line">            <span class="keyword">this</span>.replaceInPara(para, params, doc);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 替换段落里面的变量</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> para   要替换的段落</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> params 参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">replaceInPara</span><span class="params">(XWPFParagraph para, Map&lt;String, Object&gt; params, CustomXWPFDocument doc)</span> </span>&#123;</span><br><span class="line">        List&lt;XWPFRun&gt; runs = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (matcher(para.getParagraphText()).find()) &#123;</span><br><span class="line">            runs = para.getRuns();</span><br><span class="line">            <span class="keyword">int</span> start = -<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> end = -<span class="number">1</span>;</span><br><span class="line">            String str = <span class="string">""</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; runs.size(); i++) &#123;</span><br><span class="line">                XWPFRun run = runs.get(i);</span><br><span class="line">                String runText = run.toString();</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">'$'</span> == runText.charAt(<span class="number">0</span>) &amp;&amp; <span class="string">'&#123;'</span> == runText.charAt(<span class="number">1</span>)) &#123;</span><br><span class="line">                    start = i;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> ((start != -<span class="number">1</span>)) &#123;</span><br><span class="line">                    str += runText;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">'&#125;'</span> == runText.charAt(runText.length() - <span class="number">1</span>)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (start != -<span class="number">1</span>) &#123;</span><br><span class="line">                        end = i;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = start; i &lt;= end; i++) &#123;</span><br><span class="line">                para.removeRun(i);</span><br><span class="line">                i--;</span><br><span class="line">                end--;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; entry : params.entrySet()) &#123;</span><br><span class="line">                String key = entry.getKey();</span><br><span class="line">                <span class="keyword">if</span> (str.indexOf(key) != -<span class="number">1</span>) &#123;</span><br><span class="line">                    Object value = entry.getValue();</span><br><span class="line">                    <span class="keyword">if</span> (value <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">                        str = str.replace(key, value.toString());</span><br><span class="line">                        para.createRun().setText(str, <span class="number">0</span>);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (value <span class="keyword">instanceof</span> Map) &#123;</span><br><span class="line">                        str = str.replace(key, <span class="string">""</span>);</span><br><span class="line">                        Map&lt;?, ?&gt; pic = (Map&lt;?, ?&gt;) value;</span><br><span class="line">                        <span class="keyword">int</span> width = Integer.parseInt(pic.get(<span class="string">"width"</span>).toString());</span><br><span class="line">                        <span class="keyword">int</span> height = Integer.parseInt(pic.get(<span class="string">"height"</span>).toString());</span><br><span class="line">                        <span class="keyword">int</span> picType = getPictureType(pic.get(<span class="string">"type"</span>).toString());</span><br><span class="line">                        <span class="keyword">byte</span>[] byteArray = (<span class="keyword">byte</span>[]) pic.get(<span class="string">"content"</span>);</span><br><span class="line">                        ByteArrayInputStream byteInputStream = <span class="keyword">new</span> ByteArrayInputStream(byteArray);</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            doc.addPictureData(byteInputStream, picType);</span><br><span class="line">                            doc.createPicture(doc.getAllPictures().size() - <span class="number">1</span>, width, height, para);</span><br><span class="line">                            para.createRun().setText(str, <span class="number">0</span>);</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 动态生成表格</span></span><br><span class="line"><span class="comment">     * 替换表格里面的变量</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> doc    要替换的文档</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> params 参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SuppressWarnings</span>(<span class="string">"unchecked"</span>)</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">replaceInTable</span><span class="params">(CustomXWPFDocument doc, Map&lt;String, Object&gt; params, Map&lt;String, Object&gt; tableList)</span> </span>&#123;</span><br><span class="line">        List&lt;XWPFTable&gt; tables = doc.getTables();</span><br><span class="line">        XWPFTable table;</span><br><span class="line">        List&lt;XWPFTableRow&gt; rows;</span><br><span class="line">        List&lt;XWPFTableCell&gt; cells;</span><br><span class="line">        List&lt;XWPFParagraph&gt; paras;</span><br><span class="line">        </span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjExtremeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"dyjExtremeList"</span>);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeExtremeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"mtypeExtremeList"</span>);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryExtremeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"factoryExtremeList"</span>);</span><br><span class="line">        </span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjVolumeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"dyjVolumeList"</span>);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeVolumeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"mtypeVolumeList"</span>);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryVolumeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"factoryVolumeList"</span>);</span><br><span class="line">        </span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjTimeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"dyjTimeList"</span>);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeTimeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"mtypeTimeList"</span>);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryTimeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"factoryTimeList"</span>);</span><br><span class="line">        </span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; dyjUnchangeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"dyjUnchangeList"</span>);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; mtypeUnchangeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"mtypeUnchangeList"</span>);</span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; factoryUnchangeList = (List&lt;Map&lt;String, Object&gt;&gt;) tableList.get(<span class="string">"factoryUnchangeList"</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;tables.size();i++) &#123;</span><br><span class="line">        table = tables.get(i);</span><br><span class="line">            <span class="keyword">if</span> (table.getRows().size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 判断表格是需要替换还是需要插入，判断逻辑有$为替换，表格无$为插入</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>.matcher(table.getText()).find()) &#123;</span><br><span class="line">                    rows = table.getRows();</span><br><span class="line">                    <span class="keyword">for</span> (XWPFTableRow row : rows) &#123;</span><br><span class="line">                        cells = row.getTableCells();</span><br><span class="line">                        <span class="keyword">for</span> (XWPFTableCell cell : cells) &#123;</span><br><span class="line">                            paras = cell.getParagraphs();</span><br><span class="line">                            <span class="keyword">for</span> (XWPFParagraph para : paras) &#123;</span><br><span class="line">                                <span class="keyword">this</span>.replaceInPara(para, params, doc);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// 操作word中的表格</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != dyjExtremeList &amp;&amp; dyjExtremeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">0</span>) &#123;</span><br><span class="line">                        insertTable(table, dyjExtremeList);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != mtypeExtremeList &amp;&amp; mtypeExtremeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">1</span>) &#123;</span><br><span class="line">                        insertTable(table, mtypeExtremeList);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != factoryExtremeList &amp;&amp; factoryExtremeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">2</span>) &#123;</span><br><span class="line">                        insertTable(table, factoryExtremeList);</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != dyjVolumeList &amp;&amp; dyjVolumeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">3</span>) &#123;</span><br><span class="line">                        insertTable(table, dyjVolumeList);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != mtypeVolumeList &amp;&amp; mtypeVolumeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">4</span>) &#123;</span><br><span class="line">                        insertTable(table, mtypeVolumeList);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != factoryVolumeList &amp;&amp; factoryVolumeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">5</span>) &#123;</span><br><span class="line">                        insertTable(table, factoryVolumeList);</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != dyjTimeList &amp;&amp; dyjTimeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">6</span>) &#123;</span><br><span class="line">                        insertTable(table, dyjTimeList);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != mtypeTimeList &amp;&amp; mtypeTimeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">7</span>) &#123;</span><br><span class="line">                        insertTable(table, mtypeTimeList);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != factoryTimeList &amp;&amp; factoryTimeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">8</span>) &#123;</span><br><span class="line">                        insertTable(table, factoryTimeList);</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != dyjUnchangeList &amp;&amp; dyjUnchangeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">9</span>) &#123;</span><br><span class="line">                        insertTable(table, dyjUnchangeList);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != mtypeUnchangeList &amp;&amp; mtypeUnchangeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">10</span>) &#123;</span><br><span class="line">                        insertTable(table, mtypeUnchangeList);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> != factoryUnchangeList &amp;&amp; factoryUnchangeList.size() &gt; <span class="number">0</span> &amp;&amp; i == <span class="number">11</span>) &#123;</span><br><span class="line">                        insertTable(table, factoryUnchangeList);</span><br><span class="line">                &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 为表格插入数据，行数不够添加新行</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> table     需要插入数据的表格</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dataList 插入数据集合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">insertTable</span><span class="params">(XWPFTable table, List&lt;Map&lt;String, Object&gt;&gt; dataList)</span> </span>&#123;</span><br><span class="line"><span class="comment">// 插入表头下面第一行的数据</span></span><br><span class="line">List&lt;String&gt; nameList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">List&lt;BigDecimal&gt; rateList = <span class="keyword">new</span> ArrayList&lt;BigDecimal&gt;();</span><br><span class="line"><span class="keyword">for</span>(Map&lt;String, Object&gt; map : dataList) &#123;</span><br><span class="line">nameList.add((String) map.get(<span class="string">"type"</span>));</span><br><span class="line">rateList.add((BigDecimal) map.get(<span class="string">"percent"</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; nameList.size(); r++) &#123;</span><br><span class="line">    XWPFTableRow row = table.createRow();</span><br><span class="line">    List&lt;XWPFTableCell&gt; cell = row.getTableCells();</span><br><span class="line">    cell.get(<span class="number">0</span>).setText(nameList.get(r));</span><br><span class="line">    cell.get(<span class="number">1</span>).setText(rateList.get(r)+<span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 正则匹配字符串</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> str</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Matcher <span class="title">matcher</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        Pattern pattern = Pattern.compile(<span class="string">"\\$\\&#123;(.+?)\\&#125;"</span>, Pattern.CASE_INSENSITIVE);</span><br><span class="line">        Matcher matcher = pattern.matcher(str);</span><br><span class="line">        <span class="keyword">return</span> matcher;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据图片类型，取得对应的图片类型代码</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> picType</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> int</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getPictureType</span><span class="params">(String picType)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = CustomXWPFDocument.PICTURE_TYPE_PICT;</span><br><span class="line">        <span class="keyword">if</span> (picType != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (picType.equalsIgnoreCase(<span class="string">"png"</span>)) &#123;</span><br><span class="line">                res = CustomXWPFDocument.PICTURE_TYPE_PNG;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (picType.equalsIgnoreCase(<span class="string">"dib"</span>)) &#123;</span><br><span class="line">                res = CustomXWPFDocument.PICTURE_TYPE_DIB;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (picType.equalsIgnoreCase(<span class="string">"emf"</span>)) &#123;</span><br><span class="line">                res = CustomXWPFDocument.PICTURE_TYPE_EMF;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (picType.equalsIgnoreCase(<span class="string">"jpg"</span>) || picType.equalsIgnoreCase(<span class="string">"jpeg"</span>)) &#123;</span><br><span class="line">                res = CustomXWPFDocument.PICTURE_TYPE_JPEG;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (picType.equalsIgnoreCase(<span class="string">"wmf"</span>)) &#123;</span><br><span class="line">                res = CustomXWPFDocument.PICTURE_TYPE_WMF;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 合并行</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> table</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> col     需要合并的列</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fromRow 开始行</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> toRow   结束行</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">mergeCellVertically</span><span class="params">(XWPFTable table, <span class="keyword">int</span> col, <span class="keyword">int</span> fromRow, <span class="keyword">int</span> toRow)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> rowIndex = fromRow; rowIndex &lt;= toRow; rowIndex++) &#123;</span><br><span class="line">            CTVMerge vmerge = CTVMerge.Factory.newInstance();</span><br><span class="line">            <span class="keyword">if</span> (rowIndex == fromRow) &#123;</span><br><span class="line">                vmerge.setVal(STMerge.RESTART);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                vmerge.setVal(STMerge.CONTINUE);</span><br><span class="line">            &#125;</span><br><span class="line">            XWPFTableCell cell = table.getRow(rowIndex).getCell(col);</span><br><span class="line">            CTTcPr tcPr = cell.getCTTc().getTcPr();</span><br><span class="line">            <span class="keyword">if</span> (tcPr != <span class="keyword">null</span>) &#123;</span><br><span class="line">                tcPr.setVMerge(vmerge);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                tcPr = CTTcPr.Factory.newInstance();</span><br><span class="line">                tcPr.setVMerge(vmerge);</span><br><span class="line">                cell.getCTTc().setTcPr(tcPr);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取需要合并单元格的下标</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Integer[]&gt; startEnd(List&lt;String[]&gt; daList) &#123;</span><br><span class="line">        List&lt;Integer[]&gt; indexList = <span class="keyword">new</span> ArrayList&lt;Integer[]&gt;();</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; daList.size(); i++) &#123;</span><br><span class="line">            list.add(daList.get(i)[<span class="number">0</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        Map&lt;Object, Integer&gt; tm = <span class="keyword">new</span> HashMap&lt;Object, Integer&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; daList.size(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!tm.containsKey(daList.get(i)[<span class="number">0</span>])) &#123;</span><br><span class="line">                tm.put(daList.get(i)[<span class="number">0</span>], <span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> count = tm.get(daList.get(i)[<span class="number">0</span>]) + <span class="number">1</span>;</span><br><span class="line">                tm.put(daList.get(i)[<span class="number">0</span>], count);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;Object, Integer&gt; entry : tm.entrySet()) &#123;</span><br><span class="line">            String key = entry.getKey().toString();</span><br><span class="line">            <span class="keyword">if</span> (list.indexOf(key) != (-<span class="number">1</span>)) &#123;</span><br><span class="line">                Integer[] index = <span class="keyword">new</span> Integer[<span class="number">2</span>];</span><br><span class="line">                index[<span class="number">0</span>] = list.indexOf(key);</span><br><span class="line">                index[<span class="number">1</span>] = list.lastIndexOf(key);</span><br><span class="line">                indexList.add(index);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> indexList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将输入流中的数据写入字节数组</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> in</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] inputStream2ByteArray(InputStream in, <span class="keyword">boolean</span> isClose) &#123;</span><br><span class="line">        <span class="keyword">byte</span>[] byteArray = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">int</span> total = in.available();</span><br><span class="line">            byteArray = <span class="keyword">new</span> <span class="keyword">byte</span>[total];</span><br><span class="line">            in.read(byteArray);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isClose) &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    in.close();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e2) &#123;</span><br><span class="line">                    e2.getStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> byteArray;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭输入流</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> is</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(InputStream is)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (is != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                is.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关闭输出流</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> os</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(OutputStream os)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (os != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                os.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="CustomXWPFDocument-java"><a href="#CustomXWPFDocument-java" class="headerlink" title="CustomXWPFDocument.java"></a>CustomXWPFDocument.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.matai.sdoms.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.openxml4j.opc.OPCPackage;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xwpf.usermodel.XWPFDocument;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xwpf.usermodel.XWPFParagraph;</span><br><span class="line"><span class="keyword">import</span> org.apache.xmlbeans.XmlException;</span><br><span class="line"><span class="keyword">import</span> org.apache.xmlbeans.XmlToken;</span><br><span class="line"><span class="keyword">import</span> org.openxmlformats.schemas.drawingml.x2006.main.CTNonVisualDrawingProps;</span><br><span class="line"><span class="keyword">import</span> org.openxmlformats.schemas.drawingml.x2006.main.CTPositiveSize2D;</span><br><span class="line"><span class="keyword">import</span> org.openxmlformats.schemas.drawingml.x2006.wordprocessingDrawing.CTInline;</span><br><span class="line">  </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 自定义 XWPFDocument，并重写 createPicture()方法</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomXWPFDocument</span> <span class="keyword">extends</span> <span class="title">XWPFDocument</span> </span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomXWPFDocument</span><span class="params">(InputStream in)</span> <span class="keyword">throws</span> IOException </span>&#123;  </span><br><span class="line">        <span class="keyword">super</span>(in);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomXWPFDocument</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">super</span>();  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CustomXWPFDocument</span><span class="params">(OPCPackage pkg)</span> <span class="keyword">throws</span> IOException </span>&#123;  </span><br><span class="line">        <span class="keyword">super</span>(pkg);  </span><br><span class="line">    &#125;  </span><br><span class="line">  </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> width 宽</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> height 高</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> paragraph  段落</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">createPicture</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> width, <span class="keyword">int</span> height,XWPFParagraph paragraph)</span> </span>&#123;  </span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span> EMU = <span class="number">9525</span>;  </span><br><span class="line">        width *= EMU;  </span><br><span class="line">        height *= EMU;  </span><br><span class="line">        String blipId = getAllPictures().get(id).getPackageRelationship().getId();  </span><br><span class="line">        CTInline inline = paragraph.createRun().getCTR().addNewDrawing().addNewInline();  </span><br><span class="line">        </span><br><span class="line">        String picXml = <span class="string">""</span>  </span><br><span class="line">                + <span class="string">"&lt;a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\"&gt;"</span>  </span><br><span class="line">                + <span class="string">"   &lt;a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/picture\"&gt;"</span>  </span><br><span class="line">                + <span class="string">"      &lt;pic:pic xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\"&gt;"</span>  </span><br><span class="line">                + <span class="string">"         &lt;pic:nvPicPr&gt;"</span> + <span class="string">"            &lt;pic:cNvPr id=\""</span>  </span><br><span class="line">                + id  </span><br><span class="line">                + <span class="string">"\" name=\"Generated\"/&gt;"</span>  </span><br><span class="line">                + <span class="string">"            &lt;pic:cNvPicPr/&gt;"</span>  </span><br><span class="line">                + <span class="string">"         &lt;/pic:nvPicPr&gt;"</span>  </span><br><span class="line">                + <span class="string">"         &lt;pic:blipFill&gt;"</span>  </span><br><span class="line">                + <span class="string">"            &lt;a:blip r:embed=\""</span>  </span><br><span class="line">                + blipId  </span><br><span class="line">                + <span class="string">"\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"/&gt;"</span>  </span><br><span class="line">                + <span class="string">"            &lt;a:stretch&gt;"</span>  </span><br><span class="line">                + <span class="string">"               &lt;a:fillRect/&gt;"</span>  </span><br><span class="line">                + <span class="string">"            &lt;/a:stretch&gt;"</span>  </span><br><span class="line">                + <span class="string">"         &lt;/pic:blipFill&gt;"</span>  </span><br><span class="line">                + <span class="string">"         &lt;pic:spPr&gt;"</span>  </span><br><span class="line">                + <span class="string">"            &lt;a:xfrm&gt;"</span>  </span><br><span class="line">                + <span class="string">"               &lt;a:off x=\"0\" y=\"0\"/&gt;"</span>  </span><br><span class="line">                + <span class="string">"               &lt;a:ext cx=\""</span>  </span><br><span class="line">                + width  </span><br><span class="line">                + <span class="string">"\" cy=\""</span>  </span><br><span class="line">                + height  </span><br><span class="line">                + <span class="string">"\"/&gt;"</span>  </span><br><span class="line">                + <span class="string">"            &lt;/a:xfrm&gt;"</span>  </span><br><span class="line">                + <span class="string">"            &lt;a:prstGeom prst=\"rect\"&gt;"</span>  </span><br><span class="line">                + <span class="string">"               &lt;a:avLst/&gt;"</span>  </span><br><span class="line">                + <span class="string">"            &lt;/a:prstGeom&gt;"</span>  </span><br><span class="line">                + <span class="string">"         &lt;/pic:spPr&gt;"</span>  </span><br><span class="line">                + <span class="string">"      &lt;/pic:pic&gt;"</span>  </span><br><span class="line">                + <span class="string">"   &lt;/a:graphicData&gt;"</span> + <span class="string">"&lt;/a:graphic&gt;"</span>;  </span><br><span class="line">  </span><br><span class="line">        inline.addNewGraphic().addNewGraphicData();  </span><br><span class="line">        XmlToken xmlToken = <span class="keyword">null</span>;  </span><br><span class="line">        <span class="keyword">try</span> &#123;  </span><br><span class="line">            xmlToken = XmlToken.Factory.parse(picXml);  </span><br><span class="line">        &#125; <span class="keyword">catch</span> (XmlException xe) &#123;  </span><br><span class="line">            xe.printStackTrace();  </span><br><span class="line">        &#125;  </span><br><span class="line">        inline.set(xmlToken); </span><br><span class="line">        </span><br><span class="line">        inline.setDistT(<span class="number">0</span>);    </span><br><span class="line">        inline.setDistB(<span class="number">0</span>);    </span><br><span class="line">        inline.setDistL(<span class="number">0</span>);    </span><br><span class="line">        inline.setDistR(<span class="number">0</span>);    </span><br><span class="line">        </span><br><span class="line">        CTPositiveSize2D extent = inline.addNewExtent();  </span><br><span class="line">        extent.setCx(width);  </span><br><span class="line">        extent.setCy(height);  </span><br><span class="line">        </span><br><span class="line">        CTNonVisualDrawingProps docPr = inline.addNewDocPr();    </span><br><span class="line">        docPr.setId(id);    </span><br><span class="line">        docPr.setName(<span class="string">"图片"</span> + id);    </span><br><span class="line">        docPr.setDescr(<span class="string">"测试"</span>); </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在页面统计数据，导出Excel,根据模板导出word&lt;/p&gt;
    
    </summary>
    
      <category term="java总结" scheme="http://iayun.vip/categories/java%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="导出word" scheme="http://iayun.vip/tags/%E5%AF%BC%E5%87%BAword/"/>
    
  </entry>
  
  <entry>
    <title>Schedule定时任务</title>
    <link href="http://iayun.vip/Schedule%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1.html"/>
    <id>http://iayun.vip/Schedule定时任务.html</id>
    <published>2019-01-01T14:00:00.000Z</published>
    <updated>2019-04-21T08:20:35.195Z</updated>
    
    <content type="html"><![CDATA[<p>Schedule定时任务。定时执行，将结果放在指定的表中。LineiceSchedule.java 判段装置接受的数据是否为空，过多，过少;判定(EQUAL_ICETHICKNESS )等值覆冰厚度;检查超时接受的数据。MonitorDataSchedule.java 筛选同一id对应的所有IP，和同一IP对应所有id。<br><a id="more"></a></p><p><code>LineiceSchedule.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.evan.schedule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Map.Entry;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.TimeZone;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.evan.bean.SdCagErrormonitors;</span><br><span class="line"><span class="keyword">import</span> com.evan.bean.SdCagLineice;</span><br><span class="line"><span class="keyword">import</span> com.evan.bean.SdCagParam;</span><br><span class="line"><span class="keyword">import</span> com.evan.constant.Constant;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.ISdCagErrordatasService;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.ISdCagErrormonitorsService;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.ISdCagLineiceService;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.ISdCagParamService;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.ITsDeviceService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LineiceSchedule</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ISdCagErrormonitorsService sdCagErrormonitorsService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ISdCagLineiceService sdCagLineiceService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ITsDeviceService tsDeviceService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ISdCagParamService sdCagParamService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ISdCagErrordatasService sdCagErrordatasService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判段装置接受的数据是否为空，过多，过少</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Scheduled</span>(cron = <span class="string">"0 0 2 * * ?"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">analyse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">long</span> end = System.currentTimeMillis()/(<span class="number">1000</span>*<span class="number">3600</span>*<span class="number">24</span>)*(<span class="number">1000</span>*<span class="number">3600</span>*<span class="number">24</span>)-TimeZone.getDefault().getRawOffset();</span><br><span class="line">        <span class="keyword">long</span> start = end - <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>;</span><br><span class="line">        String type = Constant.MTYPE_LINEICE;</span><br><span class="line">        </span><br><span class="line">        SdCagErrormonitors errormonitors = <span class="keyword">null</span>;</span><br><span class="line">        List&lt;SdCagErrormonitors&gt; errormonitorsList = <span class="keyword">null</span>;</span><br><span class="line">        </span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; countList = sdCagLineiceService.getCount(start, end);</span><br><span class="line">        List&lt;String&gt; idList = tsDeviceService.getMonitorsByMtype(type);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//查询前一天错误装置cmdid</span></span><br><span class="line">        List&lt;String&gt; cmdidErrordataseList = sdCagErrordatasService.getSdCagErrordataseList(start, end);</span><br><span class="line">        <span class="comment">//先去除错误装置</span></span><br><span class="line">        idList.removeAll(cmdidErrordataseList);</span><br><span class="line">        </span><br><span class="line">        SdCagParam sdCagParamLineiceMin = sdCagParamService.getSdCagParam(Constant.PARAM_LINEICE_MIN);</span><br><span class="line">        SdCagParam sdCagParamLineiceMax = sdCagParamService.getSdCagParam(Constant.PARAM_LINEICE_MAX);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">float</span> lineiceMin = sdCagParamLineiceMin.getValue();</span><br><span class="line">        <span class="keyword">float</span> lineiceMax = sdCagParamLineiceMax.getValue();</span><br><span class="line"></span><br><span class="line">        errormonitorsList = <span class="keyword">new</span> ArrayList&lt;SdCagErrormonitors&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String id : idList) &#123;</span><br><span class="line">        <span class="keyword">int</span> quantity = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (Map&lt;String, Object&gt; count : countList) &#123;</span><br><span class="line"><span class="keyword">if</span> (id.equals(count.get(<span class="string">"cmdId"</span>))) &#123;</span><br><span class="line">quantity = ((Long)count.get(<span class="string">"quantity"</span>)).intValue();</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (quantity == <span class="number">0</span>) &#123; </span><br><span class="line">errormonitors = <span class="keyword">new</span> SdCagErrormonitors();</span><br><span class="line">errormonitors.setCmd_id(id);</span><br><span class="line">errormonitors.setType(type);</span><br><span class="line">errormonitors.setError_type(Constant.ERROR_TYPE_EMPTY);</span><br><span class="line">errormonitors.setTime(start);</span><br><span class="line">errormonitors.setTime_stamp(start);</span><br><span class="line">errormonitorsList.add(errormonitors);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (quantity &gt;= lineiceMax) &#123;</span><br><span class="line">errormonitors = <span class="keyword">new</span> SdCagErrormonitors();</span><br><span class="line">errormonitors.setCmd_id(id);</span><br><span class="line">errormonitors.setType(type);</span><br><span class="line">errormonitors.setError_type(Constant.ERROR_TYPE_CNT_TOOHIGH);</span><br><span class="line">errormonitors.setError_msg(<span class="string">"当前数据量:"</span> + quantity + <span class="string">";最大数据量:"</span> + lineiceMax);</span><br><span class="line">errormonitors.setTime(start);</span><br><span class="line">errormonitors.setTime_stamp(start);</span><br><span class="line">errormonitorsList.add(errormonitors);</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (quantity &gt; <span class="number">0</span> &amp;&amp; quantity &lt; lineiceMin) &#123;</span><br><span class="line">errormonitors = <span class="keyword">new</span> SdCagErrormonitors();</span><br><span class="line">errormonitors.setCmd_id(id);</span><br><span class="line">errormonitors.setType(type);</span><br><span class="line">errormonitors.setError_type(Constant.ERROR_TYPE_CNT_TOOLOW);</span><br><span class="line">errormonitors.setError_msg(<span class="string">"当前数据量:"</span> + quantity + <span class="string">";最小数据量:"</span> + lineiceMin);</span><br><span class="line">errormonitors.setTime(start);</span><br><span class="line">errormonitors.setTime_stamp(start);</span><br><span class="line">errormonitorsList.add(errormonitors);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line">        sdCagErrormonitorsService.deleteSdCagErrormonitors(type, Constant.ERROR_TYPE_EMPTY, start, end);</span><br><span class="line">sdCagErrormonitorsService.deleteSdCagErrormonitors(type, Constant.ERROR_TYPE_CNT_TOOHIGH, start, end);</span><br><span class="line">sdCagErrormonitorsService.deleteSdCagErrormonitors(type, Constant.ERROR_TYPE_CNT_TOOLOW, start, end);</span><br><span class="line"><span class="keyword">boolean</span> state = sdCagErrormonitorsService.batchAddSdCagErrormonitors(errormonitorsList);</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">"Lineice----"</span> + state);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判定EQUAL_ICETHICKNESS 等值覆冰厚度</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Scheduled</span>(cron = <span class="string">"0 0 2 * * ?"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">analyseIcethickness</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> end = System.currentTimeMillis()/(<span class="number">1000</span>*<span class="number">3600</span>*<span class="number">24</span>)*(<span class="number">1000</span>*<span class="number">3600</span>*<span class="number">24</span>)-TimeZone.getDefault().getRawOffset();</span><br><span class="line"><span class="keyword">long</span> start = end - <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>;</span><br><span class="line">        String type = Constant.MTYPE_LINEICE;</span><br><span class="line">        </span><br><span class="line">        List&lt;String&gt; idList = tsDeviceService.getMonitorsByMtype(type);</span><br><span class="line"><span class="comment">//查询前一天错误装置cmdid</span></span><br><span class="line">        List&lt;String&gt; cmdidErrordataseList = sdCagErrordatasService.getSdCagErrordataseList(start, end);</span><br><span class="line">        idList.removeAll(cmdidErrordataseList);</span><br><span class="line">        List&lt;SdCagLineice&gt; lineiceList = sdCagLineiceService.getSdCagLineiceList(start, end);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">float</span> icethicknessMin = (sdCagParamService.getSdCagParam(Constant.PARAM_ICETHICKNESS_MIN)).getValue();</span><br><span class="line">        <span class="keyword">float</span> icethicknessMax = (sdCagParamService.getSdCagParam(Constant.PARAM_ICETHICKNESS_MAX)).getValue();</span><br><span class="line">        </span><br><span class="line">        List&lt;SdCagErrormonitors&gt; errormonitorsList = <span class="keyword">new</span> ArrayList&lt;SdCagErrormonitors&gt;();</span><br><span class="line">        Map&lt;String, Set&lt;Double&gt;&gt; icethicknessMap = <span class="keyword">new</span> HashMap&lt;String,Set&lt;Double&gt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(String id : idList) &#123;</span><br><span class="line">        Set&lt;Double&gt; icethicknessSet = <span class="keyword">new</span> HashSet&lt;Double&gt;();</span><br><span class="line">        <span class="keyword">for</span>(SdCagLineice lineice : lineiceList) &#123;</span><br><span class="line">        <span class="keyword">if</span>(id.equals(lineice.getCmd_id())) &#123;</span><br><span class="line">        icethicknessSet.add(lineice.getEqual_icethickness());</span><br><span class="line">        &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        icethicknessMap.put(id, icethicknessSet);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(String id : idList) &#123;</span><br><span class="line">        <span class="keyword">for</span>(SdCagLineice lineice : lineiceList) &#123;</span><br><span class="line">        <span class="keyword">if</span>(id.equals(lineice.getCmd_id())) &#123;</span><br><span class="line">        <span class="keyword">if</span>(lineice.getEqual_icethickness() &gt; icethicknessMax) &#123;</span><br><span class="line">        SdCagErrormonitors errormonitors = <span class="keyword">new</span> SdCagErrormonitors();</span><br><span class="line">                        errormonitors.setCmd_id(id);</span><br><span class="line">                        errormonitors.setType(type);</span><br><span class="line">                        errormonitors.setError_type(Constant.ERROR_TYPE_DATA_TOOHIGH);</span><br><span class="line">                        errormonitors.setError_msg(<span class="string">"等值覆冰厚度过高，数据值为:"</span> + lineice.getEqual_icethickness());</span><br><span class="line">                        errormonitors.setTime(start);</span><br><span class="line">                        errormonitors.setTime_stamp(start);</span><br><span class="line">                        errormonitorsList.add(errormonitors);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(lineice.getEqual_icethickness() &lt; icethicknessMin) &#123;</span><br><span class="line">        SdCagErrormonitors errormonitors = <span class="keyword">new</span> SdCagErrormonitors();</span><br><span class="line">        errormonitors.setCmd_id(id);</span><br><span class="line">        errormonitors.setType(type);</span><br><span class="line">        errormonitors.setError_type(Constant.ERROR_TYPE_DATA_TOOLOW);</span><br><span class="line">        errormonitors.setError_msg(<span class="string">"等值覆冰厚度过低，数据值为:"</span> + lineice.getEqual_icethickness());</span><br><span class="line">        errormonitors.setTime(start);</span><br><span class="line">        errormonitors.setTime_stamp(start);</span><br><span class="line">        errormonitorsList.add(errormonitors);</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(Map.Entry&lt;String, Set&lt;Double&gt;&gt; entry : icethicknessMap.entrySet()) &#123;</span><br><span class="line">        List&lt;Double&gt; icethicknessList = <span class="keyword">new</span> ArrayList&lt;Double&gt;(entry.getValue());</span><br><span class="line">        <span class="keyword">if</span>(entry.getValue() != <span class="keyword">null</span> &amp;&amp; entry.getValue().size() == <span class="number">1</span> &amp;&amp; icethicknessList.get(<span class="number">0</span>) != <span class="number">0.0</span>) &#123;</span><br><span class="line">        SdCagErrormonitors errormonitors = <span class="keyword">new</span> SdCagErrormonitors();</span><br><span class="line">                errormonitors.setCmd_id(entry.getKey());</span><br><span class="line">                errormonitors.setType(type);</span><br><span class="line">                errormonitors.setError_type(Constant.ERROR_TYPE_UNCHANGED);</span><br><span class="line">                errormonitors.setError_msg(<span class="string">"等值覆冰厚度恒定为:"</span> + icethicknessList.get(<span class="number">0</span>));</span><br><span class="line">                errormonitors.setTime(start);</span><br><span class="line">                errormonitors.setTime_stamp(start);</span><br><span class="line">                errormonitorsList.add(errormonitors);</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sdCagErrormonitorsService.deleteSdCagErrormonitors(type, Constant.ERROR_TYPE_UNCHANGED, start, end);</span><br><span class="line">        sdCagErrormonitorsService.deleteSdCagErrormonitors(type, Constant.ERROR_TYPE_DATA_TOOHIGH, start, end);</span><br><span class="line">        sdCagErrormonitorsService.deleteSdCagErrormonitors(type, Constant.ERROR_TYPE_DATA_TOOLOW, start, end);</span><br><span class="line">        <span class="keyword">boolean</span> state = sdCagErrormonitorsService.batchAddSdCagErrormonitors(errormonitorsList);</span><br><span class="line">        System.out.println(<span class="string">"analyseIcethickness----"</span> + state);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">  * 检查超时接受的数据</span></span><br><span class="line"><span class="comment">     **/</span></span><br><span class="line"><span class="meta">@Scheduled</span>(cron = <span class="string">"0 0 2 * * ?"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkRecvtime</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">long</span> end = System.currentTimeMillis()/(<span class="number">1000</span>*<span class="number">3600</span>*<span class="number">24</span>)*(<span class="number">1000</span>*<span class="number">3600</span>*<span class="number">24</span>)-TimeZone.getDefault().getRawOffset();</span><br><span class="line">        <span class="keyword">long</span> start = end - <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>;</span><br><span class="line">        String type = Constant.MTYPE_LINEICE;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//查询前一天错误装置cmdid</span></span><br><span class="line">        List&lt;String&gt; cmdidErrordataseList = sdCagErrordatasService.getSdCagErrordataseList(start, end);</span><br><span class="line">        </span><br><span class="line">        SdCagErrormonitors errormonitors = <span class="keyword">null</span>;</span><br><span class="line">        List&lt;SdCagLineice&gt; lineiceList = sdCagLineiceService.getSdCagLineiceList(start, end);</span><br><span class="line">        </span><br><span class="line">        SdCagParam recvtimeInvalid = sdCagParamService.getSdCagParam(Constant.PARAM_RECVTIME_INVALID);</span><br><span class="line">        <span class="keyword">float</span> recvtimeInvalidVal = recvtimeInvalid.getValue();</span><br><span class="line">        SdCagParam frequency = sdCagParamService.getSdCagParam(Constant.PARAM_RECVTIME_FREQUENCY);</span><br><span class="line">        <span class="keyword">int</span> frequencyVal = (<span class="keyword">int</span>) frequency.getValue();</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Integer&gt; lineiceMap = <span class="keyword">new</span> HashMap&lt;String, Integer&gt;();</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(SdCagLineice lineice :lineiceList) &#123;</span><br><span class="line">            <span class="keyword">float</span> timeChange = (lineice.getRecvtime()-lineice.getTime_stamp())/<span class="number">1000</span>/<span class="number">60</span>;</span><br><span class="line">            <span class="keyword">if</span>(!cmdidErrordataseList.contains(lineice.getCmd_id()) &amp;&amp; timeChange &gt; recvtimeInvalidVal) &#123;</span><br><span class="line">                <span class="keyword">if</span> (lineiceMap.containsKey(lineice.getCmd_id())) &#123;</span><br><span class="line">                    Integer idNum = lineiceMap.get(lineice.getCmd_id());</span><br><span class="line">                    lineiceMap.put(lineice.getCmd_id(), ++idNum);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    lineiceMap.put(lineice.getCmd_id(), i);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        List&lt;SdCagErrormonitors&gt; recvtimeList = <span class="keyword">new</span> ArrayList&lt;SdCagErrormonitors&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Entry&lt;String, Integer&gt; entry : lineiceMap.entrySet()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (entry.getValue() &gt; frequencyVal) &#123;</span><br><span class="line">                errormonitors = <span class="keyword">new</span> SdCagErrormonitors();</span><br><span class="line">                errormonitors.setCmd_id(entry.getKey());</span><br><span class="line">                errormonitors.setType(type);</span><br><span class="line">                errormonitors.setError_type(Constant.ERROR_TYPE_RECVTIME_INVALID);</span><br><span class="line">                errormonitors.setError_msg(<span class="string">"当前数据量:"</span>+entry.getValue()+<span class="string">"条;容错量:"</span>+frequencyVal + <span class="string">"条"</span>);</span><br><span class="line">                errormonitors.setTime(start);</span><br><span class="line">                errormonitors.setTime_stamp(start);</span><br><span class="line">                recvtimeList.add(errormonitors);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">sdCagErrormonitorsService.deleteSdCagErrormonitors(type, Constant.ERROR_TYPE_RECVTIME_INVALID, start, end);</span><br><span class="line"><span class="keyword">boolean</span> state = sdCagErrormonitorsService.batchAddSdCagErrormonitors(recvtimeList);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">"Lineice--checkRecvtime"</span> + state);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>MonitorDataSchedule.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.evan.schedule;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.TimeZone;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.Collectors;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.scheduling.annotation.Scheduled;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.evan.bean.SdCagErrordatas;</span><br><span class="line"><span class="keyword">import</span> com.evan.bean.SdCagFromipId;</span><br><span class="line"><span class="keyword">import</span> com.evan.bean.VMonitorData;</span><br><span class="line"><span class="keyword">import</span> com.evan.constant.Constant;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.ISdCagErrordatasService;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.ISdCagFromipIdService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MonitorDataSchedule</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ISdCagErrordatasService sdCagErrordatasService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ISdCagFromipIdService sdCagFromipIdservice;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Scheduled</span>(cron = <span class="string">"0 0 2 * * ?"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">analyse</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">long</span> end = System.currentTimeMillis()/(<span class="number">1000</span>*<span class="number">3600</span>*<span class="number">24</span>)*(<span class="number">1000</span>*<span class="number">3600</span>*<span class="number">24</span>)-TimeZone.getDefault().getRawOffset();</span><br><span class="line">    <span class="keyword">long</span> start = end - <span class="number">24</span>*<span class="number">60</span>*<span class="number">60</span>*<span class="number">1000</span>;</span><br><span class="line">    </span><br><span class="line">    String sameId = Constant.ERROR_IP_SAMEID;</span><br><span class="line">        String sameIp = Constant.ERROR_IP_SAMEIP;</span><br><span class="line">        </span><br><span class="line">        SdCagErrordatas sdCagErrordatas = <span class="keyword">null</span>;</span><br><span class="line">        List&lt;SdCagErrordatas&gt; sdCagErrordatasList= <span class="keyword">null</span>; </span><br><span class="line">        </span><br><span class="line">        <span class="comment">//得到的List中 只包含distinct 后cmd_id fromip 字段</span></span><br><span class="line">        List&lt;VMonitorData&gt; vMonitorDataList = sdCagErrordatasService.getMonitorDataList(start, end);</span><br><span class="line">        </span><br><span class="line">        List&lt;String&gt; cmdIdList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        List&lt;String&gt; fromipList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">        <span class="keyword">for</span>(VMonitorData vMonitorData : vMonitorDataList) &#123;</span><br><span class="line">            cmdIdList.add(vMonitorData.getCmd_id());</span><br><span class="line">            fromipList.add(vMonitorData.getFromip().replace(<span class="string">"/"</span>, <span class="string">""</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//获取装置表fromipid的所有信息</span></span><br><span class="line">        List&lt;SdCagFromipId&gt; sdCagFromipIdList = sdCagFromipIdservice.getSdCagFromipIdList();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//将id数大于1的筛选出来</span></span><br><span class="line">        List&lt;String&gt; sameIdList = getDuplicateElements(cmdIdList);</span><br><span class="line">        sdCagErrordatasList = <span class="keyword">new</span> ArrayList&lt;SdCagErrordatas&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//防止重复执行产生重复数据</span></span><br><span class="line">        sdCagErrordatasService.batchDeleteByTime(start, end);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(String id : sameIdList) &#123;</span><br><span class="line">            <span class="comment">//取同id对应的ip</span></span><br><span class="line">            <span class="keyword">for</span>(VMonitorData vMonitorData :vMonitorDataList) &#123;</span><br><span class="line">                <span class="keyword">if</span>(id.equals(vMonitorData.getCmd_id()))&#123;</span><br><span class="line">                    sdCagErrordatas = <span class="keyword">new</span> SdCagErrordatas();</span><br><span class="line">                    sdCagErrordatas.setCmd_id(id);</span><br><span class="line">                    sdCagErrordatas.setFromip(vMonitorData.getFromip().replace(<span class="string">"/"</span>, <span class="string">""</span>));</span><br><span class="line">                    sdCagErrordatas.setType(sameId);</span><br><span class="line">                    sdCagErrordatas.setTime_stamp(start);</span><br><span class="line">                    sdCagErrordatas.setRecvtime(start);</span><br><span class="line">                    sdCagErrordatas.setCreatime(start);</span><br><span class="line">                    sdCagErrordatasList.add(sdCagErrordatas);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//将fromip数大于1的筛选出来</span></span><br><span class="line">        List&lt;String&gt; sameIpList = getDuplicateElements(fromipList);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">//获取同fromip对应的id</span></span><br><span class="line">        <span class="keyword">for</span>(String ip : sameIpList) &#123;</span><br><span class="line"></span><br><span class="line">            List&lt;String&gt; idList = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">            <span class="keyword">for</span>(VMonitorData vMonitorData :vMonitorDataList) &#123;</span><br><span class="line">                <span class="keyword">if</span>(ip.equals(vMonitorData.getFromip().replace(<span class="string">"/"</span>, <span class="string">""</span>)))&#123;</span><br><span class="line">                    idList.add(vMonitorData.getCmd_id());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            List&lt;String&gt; cmdIdListFromipId = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line">            <span class="keyword">for</span>(SdCagFromipId sdCagFromipId : sdCagFromipIdList) &#123;</span><br><span class="line">                <span class="keyword">if</span>(ip.equals(sdCagFromipId.getFromip()))&#123;</span><br><span class="line">                    cmdIdListFromipId.add(sdCagFromipId.getCmd_id());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">//求出差集</span></span><br><span class="line">            idList.removeAll(cmdIdListFromipId);</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">for</span>(String id:idList) &#123;</span><br><span class="line">            sdCagErrordatas = <span class="keyword">new</span> SdCagErrordatas();</span><br><span class="line">            sdCagErrordatas.setCmd_id(id);</span><br><span class="line">            sdCagErrordatas.setFromip(ip);</span><br><span class="line">            sdCagErrordatas.setType(sameIp);</span><br><span class="line">            sdCagErrordatas.setTime_stamp(start);</span><br><span class="line">            sdCagErrordatas.setRecvtime(start);</span><br><span class="line">            sdCagErrordatas.setCreatime(start);</span><br><span class="line">            sdCagErrordatasList.add(sdCagErrordatas);</span><br><span class="line">        &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sdCagErrordatasService.batchAddSdCagErrordatas(sdCagErrordatasList);</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">"VMonitorDataSchedule-----"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> List&lt;String&gt; <span class="title">getDuplicateElements</span><span class="params">(List&lt;String&gt; list)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> list.stream()</span><br><span class="line">                    .collect(Collectors.toMap(e -&gt; e, e -&gt; <span class="number">1</span>, Integer::sum))</span><br><span class="line">                    .entrySet().stream()</span><br><span class="line">                    .filter(entry -&gt; entry.getValue() &gt; <span class="number">1</span>)</span><br><span class="line">                    .map(entry -&gt; entry.getKey())</span><br><span class="line">                    .collect(Collectors.toList());</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Schedule定时任务。定时执行，将结果放在指定的表中。LineiceSchedule.java 判段装置接受的数据是否为空，过多，过少;判定(EQUAL_ICETHICKNESS )等值覆冰厚度;检查超时接受的数据。MonitorDataSchedule.java 筛选同一id对应的所有IP，和同一IP对应所有id。&lt;br&gt;
    
    </summary>
    
      <category term="java总结" scheme="http://iayun.vip/categories/java%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="Schedule" scheme="http://iayun.vip/tags/Schedule/"/>
    
  </entry>
  
  <entry>
    <title>二零一八年总结</title>
    <link href="http://iayun.vip/%E4%BA%8C%E9%9B%B6%E4%B8%80%E5%85%AB%E5%B9%B4%E6%80%BB%E7%BB%93.html"/>
    <id>http://iayun.vip/二零一八年总结.html</id>
    <published>2018-12-31T10:00:00.000Z</published>
    <updated>2019-04-21T04:28:04.572Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a><center>前言</center></h3><p>还有好多梦想没有实现，二零一八就这样过去了！<br><a id="more"></a></p><h3 id="关于生活"><a href="#关于生活" class="headerlink" title="关于生活"></a>关于生活</h3><p>将买的书认真读完，学着做更多的菜。多做点有意义的事，把制定好的计划认真的执行下去。感觉自己越来越木讷了，与有趣的灵魂背道而驰，相去愈远。</p><h3 id="关于工作"><a href="#关于工作" class="headerlink" title="关于工作"></a>关于工作</h3><p>继续积累技术，有意识地去学习一些高效的表达与沟通技巧。</p><h3 id="关于未来"><a href="#关于未来" class="headerlink" title="关于未来"></a>关于未来</h3><p>攒钱哇！控制一下自己的消费欲望。在大城市买房是不太现实的，回去买房又觉得不太理想，就这样在夹缝里还不知要持续多久。可能不买房，一直租也不错。以前一直想着不结婚，不要小孩，现在为了礼金是不是应该结一次，不然太亏了。结婚前先做个结扎手术，哈哈哈！</p><p>在身上偶尔又展现了自己怯懦的一面，也不清楚是下意识的伪装，还是没有随长大散去的懦弱。</p><p>想去蹦极，新年放假去！</p><p>锻炼一下自己的文笔，有机会的就去投稿哇！</p><h3 id="关于感情"><a href="#关于感情" class="headerlink" title="关于感情"></a>关于感情</h3><p>寻一个势均力敌熠熠生辉宠我如猫的猪猪女孩。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;&lt;center&gt;前言&lt;/center&gt;&lt;/h3&gt;&lt;p&gt;还有好多梦想没有实现，二零一八就这样过去了！&lt;br&gt;
    
    </summary>
    
      <category term="闲情逸致" scheme="http://iayun.vip/categories/%E9%97%B2%E6%83%85%E9%80%B8%E8%87%B4/"/>
    
    
      <category term="年度小结" scheme="http://iayun.vip/tags/%E5%B9%B4%E5%BA%A6%E5%B0%8F%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>画一个工作流程图</title>
    <link href="http://iayun.vip/%E7%94%BB%E4%B8%80%E4%B8%AA%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E5%9B%BE.html"/>
    <id>http://iayun.vip/画一个工作流程图.html</id>
    <published>2018-12-17T14:00:00.000Z</published>
    <updated>2019-04-21T09:01:57.747Z</updated>
    
    <content type="html"><![CDATA[<p>按需求画一个工作流程。根据流程完成对应的java代码。</p><a id="more"></a><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E5%90%8E%E7%AB%AF%E7%9F%A5%E8%AF%86/%E5%B7%A5%E4%BD%9C%E6%B5%81/%E8%AF%95%E9%AA%8C%E6%B5%81%E7%A8%8B.jpg" alt=""></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.evan.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONArray;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"><span class="keyword">import</span> com.evan.bean.CustomPager;</span><br><span class="line"><span class="keyword">import</span> com.evan.bean.PmsEmergencyProject;</span><br><span class="line"><span class="keyword">import</span> com.evan.bean.PmsProjectAttachFile;</span><br><span class="line"><span class="keyword">import</span> com.evan.bean.SysUser;</span><br><span class="line"><span class="keyword">import</span> com.evan.constant.Constant;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.IPmsEmergencyProjectService;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.IPmsProjectAttachFileService;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.ISysOrgService;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.ISysRoleUserService;</span><br><span class="line"><span class="keyword">import</span> com.evan.service.ISysUserService;</span><br><span class="line"><span class="keyword">import</span> com.evan.util.UserUtil;</span><br><span class="line"><span class="keyword">import</span> com.evan.util.UuidUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.activiti.engine.RuntimeService;</span><br><span class="line"><span class="keyword">import</span> org.activiti.engine.TaskService;</span><br><span class="line"><span class="keyword">import</span> org.activiti.engine.runtime.ProcessInstance;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> evan</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@company</span> </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@create</span> 2018-11-26 9:54</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@desc</span></span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/emergencyProject"</span>)</span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EmergencyProjectController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IPmsEmergencyProjectService pmsEmergencyProjectService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ISysOrgService sysOrgService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ISysUserService sysUserService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ISysRoleUserService sysRoleUserService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RuntimeService runtimeService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> TaskService taskService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IPmsProjectAttachFileService pmsProjectAttachFileService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 增加附件并返回emergencyProject对象，便于后续的更新</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> emergencyProject</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> JSONObject <span class="title">batchAddProjectAttachFile</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">String taskId = request.getParameter(<span class="string">"taskId"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        String projectId = request.getParameter(<span class="string">"projectId"</span>);</span><br><span class="line">        </span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line">        </span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(projectId);</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">boolean</span> state = pmsProjectAttachFileService.batchDeleteAddProjectAttachFile(projectId,projectAttachFileList);</span><br><span class="line">        </span><br><span class="line">        taskService.complete(taskId);</span><br><span class="line"></span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line"><span class="keyword">return</span> resultJson;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询之前上传的所有信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">selectEmergencyProject</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">String proInstId = request.getParameter(<span class="string">"proInstId"</span>);</span><br><span class="line">        PmsEmergencyProject emergencyProject = pmsEmergencyProjectService.getEmergencyProjectByProInstId(proInstId);</span><br><span class="line"></span><br><span class="line">        request.setAttribute(<span class="string">"emergencyProjectObj"</span>, JSON.toJSONStringWithDateFormat(emergencyProject, <span class="string">"yyyy-MM-dd"</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/index.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProject"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/getProjectAttachFileList.do"</span>, produces = <span class="string">"text/html;charset=UTF-8"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getProjectAttachFileList</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    String projectId = request.getParameter(<span class="string">"projectId"</span>);</span><br><span class="line">    List&lt;PmsProjectAttachFile&gt; fileList = pmsProjectAttachFileService.getProjectAttachFileList(projectId);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> JSON.toJSONString(fileList);</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/getEmergencyProjectList.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CustomPager&lt;PmsEmergencyProject&gt; <span class="title">getEmergencyProjectList</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String page = request.getParameter(<span class="string">"page"</span>);</span><br><span class="line">        String rows = request.getParameter(<span class="string">"rows"</span>);</span><br><span class="line">        String orgId = UserUtil.getCurrentOrgId();</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(orgId)) &#123;</span><br><span class="line"><span class="keyword">return</span> pmsEmergencyProjectService.getEmergencyProjectPager(<span class="keyword">null</span>, page, rows);</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line">        String parentId = sysOrgService.getParentOrgId(orgId);</span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(parentId)) &#123;</span><br><span class="line">orgId = parentId;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pmsEmergencyProjectService.getEmergencyProjectPager(orgId, page, rows);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/addEmergencyProject.do"</span>, produces = <span class="string">"text/html;charset=UTF-8"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addEmergencyProject</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        String formData = request.getParameter(<span class="string">"formData"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line">        </span><br><span class="line">        PmsEmergencyProject emergencyProject = JSON.parseObject(formData, PmsEmergencyProject.class);</span><br><span class="line">        emergencyProject.setRec_obj_id(UuidUtil.getUUID());</span><br><span class="line">        emergencyProject.setRec_create_date(<span class="keyword">new</span> Date());</span><br><span class="line">        emergencyProject.setRec_create_user(UserUtil.getCurrentUserId());</span><br><span class="line">        emergencyProject.setRec_create_org(UserUtil.getCurrentOrgId());</span><br><span class="line"></span><br><span class="line">        Map&lt;String, Object&gt; assigneeIdMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        assigneeIdMap.put(<span class="string">"assigneeId"</span>, UserUtil.getCurrentUser().getRec_loginname());</span><br><span class="line">        </span><br><span class="line">        ProcessInstance processInstance = runtimeService.startProcessInstanceByKey(Constant.EMERGENCY_PROJECT_PROCESS,assigneeIdMap);</span><br><span class="line">        runtimeService.setProcessInstanceName(processInstance.getProcessInstanceId(), emergencyProject.getRec_line());</span><br><span class="line"></span><br><span class="line">        emergencyProject.setRec_process_instance_id(processInstance.getProcessInstanceId());</span><br><span class="line">        </span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(emergencyProject.getRec_obj_id());</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">boolean</span> state = pmsEmergencyProjectService.addEmergencyProject(emergencyProject,projectAttachFileList);</span><br><span class="line">        </span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/edit.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">edit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">     selectEmergencyProject(request);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectEdit"</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/editSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">editSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String taskId = request.getParameter(<span class="string">"taskId"</span>);</span><br><span class="line">        String formData = request.getParameter(<span class="string">"formData"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        </span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line">        PmsEmergencyProject emergencyProject = JSON.parseObject(formData, PmsEmergencyProject.class);</span><br><span class="line">        </span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(emergencyProject.getRec_obj_id());</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">boolean</span> state = pmsProjectAttachFileService.batchDeleteAddProjectAttachFile(emergencyProject.getRec_obj_id(),projectAttachFileList);</span><br><span class="line">        </span><br><span class="line">        List&lt;String&gt; userIdList = sysRoleUserService.getUserIdListByRoleId(Constant.ROLE_TRANSPORT_PROCESS);</span><br><span class="line">        </span><br><span class="line">        List&lt;String&gt; objIdList = sysOrgService.getObjIdListByParentId(UserUtil.getCurrentOrgId());</span><br><span class="line">        Map&lt;String, Object&gt; assigneeIdMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(String org : objIdList) &#123;</span><br><span class="line">            SysUser user = sysUserService.getUserByOrg(org);</span><br><span class="line">            <span class="keyword">if</span>(userIdList.contains(user.getRec_obj_id())) &#123;</span><br><span class="line">                assigneeIdMap.put(<span class="string">"assigneeId"</span>, user.getRec_loginname());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        taskService.complete(taskId, assigneeIdMap);</span><br><span class="line"></span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/reportDemand.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">reportDemand</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">        selectEmergencyProject(request);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectReportDemand"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/reportDemandSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">reportDemandSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/examine.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">examine</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">        selectEmergencyProject(request);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectExamine"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/examineSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">examineSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/releaseTaskList.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">releaseTaskList</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectReleaseTaskList"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/releaseTaskListSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">releaseTaskListSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/localeInvestigation.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">localeInvestigation</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">        selectEmergencyProject(request);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectLocaleInvestigation"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/localeInvestigationSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">localeInvestigationSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String taskId = request.getParameter(<span class="string">"taskId"</span>);</span><br><span class="line">        String formData = request.getParameter(<span class="string">"formData"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        </span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line">        PmsEmergencyProject emergencyProject = JSON.parseObject(formData, PmsEmergencyProject.class);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">boolean</span> state = pmsEmergencyProjectService.updateEmergencyProject(emergencyProject);</span><br><span class="line">        </span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(emergencyProject.getRec_obj_id());</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        pmsProjectAttachFileService.batchDeleteAddProjectAttachFile(emergencyProject.getRec_obj_id(), projectAttachFileList);</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">"isSatisfied"</span>, emergencyProject.getRec_is_satisfied());</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span> == emergencyProject.getRec_is_satisfied()) &#123;</span><br><span class="line">            </span><br><span class="line">            map.put(<span class="string">"assigneeId"</span>, UserUtil.getCurrentUser().getRec_loginname());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            </span><br><span class="line">            PmsEmergencyProject oldEmergencyProject = pmsEmergencyProjectService.getEmergencyProject(emergencyProject.getRec_obj_id());</span><br><span class="line">            </span><br><span class="line">            SysUser sysUser = sysUserService.getUser(oldEmergencyProject.getRec_create_user());</span><br><span class="line">            </span><br><span class="line">            map.put(<span class="string">"assigneeId"</span>, sysUser.getRec_loginname());</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        taskService.complete(taskId, map);</span><br><span class="line"></span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/arrangeOutageMaintenance.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">arrangeOutageMaintenance</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectArrangeOutageMaintenance"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/arrangeOutageMaintenanceSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">arrangeOutageMaintenanceSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String taskId = request.getParameter(<span class="string">"taskId"</span>);</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; assigneeIdMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        assigneeIdMap.put(<span class="string">"assigneeId"</span>, UserUtil.getCurrentUser().getRec_loginname());</span><br><span class="line">        </span><br><span class="line">        taskService.complete(taskId, assigneeIdMap);</span><br><span class="line"></span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, <span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/editScheme.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">editScheme</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">        selectEmergencyProject(request);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectEditScheme"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/editSchemeSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">editSchemeSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/examineScheme.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">examineScheme</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectExamineScheme"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/examineSchemeSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">examineSchemeSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/writeRepairSheet.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">writeRepairSheet</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectWriteRepairSheet"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/writeRepairSheetSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">writeRepairSheetSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String taskId = request.getParameter(<span class="string">"taskId"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        String projectId = request.getParameter(<span class="string">"projectId"</span>);</span><br><span class="line">        </span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line">        </span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(projectId);</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">boolean</span> state = pmsProjectAttachFileService.batchDeleteAddProjectAttachFile(projectId,projectAttachFileList);</span><br><span class="line">        </span><br><span class="line">        PmsEmergencyProject emergencyProject = pmsEmergencyProjectService.getEmergencyProject(projectId);</span><br><span class="line">        SysUser sysUser = sysUserService.getUser(emergencyProject.getRec_create_user());</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; assigneeIdMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        assigneeIdMap.put(<span class="string">"assigneeId"</span>, sysUser.getRec_loginname());</span><br><span class="line">        </span><br><span class="line">        taskService.complete(taskId, assigneeIdMap);</span><br><span class="line">        </span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/applyWork.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">applyWork</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectApplyWork"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/applyWorkSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">applyWorkSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String taskId = request.getParameter(<span class="string">"taskId"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        String projectId = request.getParameter(<span class="string">"projectId"</span>);</span><br><span class="line">        </span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line">        </span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(projectId);</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">boolean</span> state = pmsProjectAttachFileService.batchDeleteAddProjectAttachFile(projectId,projectAttachFileList);</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; assigneeIdMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        assigneeIdMap.put(<span class="string">"assigneeId"</span>, UserUtil.getCurrentUser().getRec_loginname());</span><br><span class="line">        </span><br><span class="line">        taskService.complete(taskId, assigneeIdMap);</span><br><span class="line"></span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/applyWorkPermit.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">applyWorkPermit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectApplyWork"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/applyWorkPermitSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">applyWorkPermitSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String taskId = request.getParameter(<span class="string">"taskId"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        String projectId = request.getParameter(<span class="string">"projectId"</span>);</span><br><span class="line">        </span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line">        </span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(projectId);</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">boolean</span> state = pmsProjectAttachFileService.batchDeleteAddProjectAttachFile(projectId,projectAttachFileList);</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; assigneeIdMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        assigneeIdMap.put(<span class="string">"assigneeId"</span>, UserUtil.getCurrentUser().getRec_loginname());</span><br><span class="line">        </span><br><span class="line">        taskService.complete(taskId, assigneeIdMap);</span><br><span class="line"></span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/approvePermit.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">approvePermit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectApprovePermit"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/approvePermitSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">approvePermitSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/transmitWorkCommand.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">transmitWorkCommand</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">        selectEmergencyProject(request);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectTransmitWorkCommand"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/transmitWorkCommandSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">transmitWorkCommandSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String taskId = request.getParameter(<span class="string">"taskId"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        String projectId = request.getParameter(<span class="string">"projectId"</span>);</span><br><span class="line">        </span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line">        </span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(projectId);</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">boolean</span> state = pmsProjectAttachFileService.batchDeleteAddProjectAttachFile(projectId,projectAttachFileList);</span><br><span class="line">        </span><br><span class="line">        PmsEmergencyProject emergencyProject = pmsEmergencyProjectService.getEmergencyProject(projectId);</span><br><span class="line">        SysUser sysUser = sysUserService.getUser(emergencyProject.getRec_create_user());</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; assigneeIdMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        assigneeIdMap.put(<span class="string">"assigneeId"</span>, sysUser.getRec_loginname());</span><br><span class="line">        </span><br><span class="line">        taskService.complete(taskId, assigneeIdMap);</span><br><span class="line">        </span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/acceptWorkCommand.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">acceptWorkCommand</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectAcceptWorkCommand"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/acceptWorkCommandSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">acceptWorkCommandSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/operationImplementation.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">operationImplementation</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectOperationImplementation"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/operationImplementationSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">operationImplementationSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/operationFinish.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">operationFinish</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectOperationFinish"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/operationFinishSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">operationFinishSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String taskId = request.getParameter(<span class="string">"taskId"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        String projectId = request.getParameter(<span class="string">"projectId"</span>);</span><br><span class="line">        </span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line">        </span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(projectId);</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">boolean</span> state = pmsProjectAttachFileService.batchDeleteAddProjectAttachFile(projectId,projectAttachFileList);</span><br><span class="line">        </span><br><span class="line">        PmsEmergencyProject emergencyProject = pmsEmergencyProjectService.getEmergencyProject(projectId);</span><br><span class="line">        SysUser sysUser = sysUserService.getUser(emergencyProject.getRec_create_user());</span><br><span class="line">        </span><br><span class="line">        Map&lt;String, Object&gt; assigneeIdMap = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">        assigneeIdMap.put(<span class="string">"assigneeId"</span>, sysUser.getRec_loginname());</span><br><span class="line">        </span><br><span class="line">        taskService.complete(taskId, assigneeIdMap);</span><br><span class="line">        </span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/localeCheck.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">localeCheck</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">    String proInstId = request.getParameter(<span class="string">"proInstId"</span>);</span><br><span class="line">        PmsEmergencyProject emergencyProject = pmsEmergencyProjectService.getEmergencyProjectByProInstId(proInstId);</span><br><span class="line"></span><br><span class="line">        request.setAttribute(<span class="string">"emergencyProjectObj"</span>, JSON.toJSONStringWithDateFormat(emergencyProject, <span class="string">"yyyy-MM-dd"</span>));</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectLocaleCheck"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/localeCheckSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">localeCheckSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String taskId = request.getParameter(<span class="string">"taskId"</span>);</span><br><span class="line">        String formData = request.getParameter(<span class="string">"formData"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        </span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line">        PmsEmergencyProject emergencyProject = JSON.parseObject(formData, PmsEmergencyProject.class);</span><br><span class="line">        </span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(emergencyProject.getRec_obj_id());</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">boolean</span> state = pmsEmergencyProjectService.updateEmergencyProject(emergencyProject);</span><br><span class="line">        pmsProjectAttachFileService.batchDeleteAddProjectAttachFile(emergencyProject.getRec_obj_id(), projectAttachFileList);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (state) &#123;</span><br><span class="line"></span><br><span class="line">            Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">            map.put(<span class="string">"isQualified"</span>, emergencyProject.getRec_is_qualified());</span><br><span class="line">            map.put(<span class="string">"assigneeId"</span>, UserUtil.getCurrentUser().getRec_loginname());</span><br><span class="line">            </span><br><span class="line">            taskService.complete(taskId, map);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/completeReport.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">completeReport</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectCompleteReport"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/completeReportSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">completeReportSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/localeWorkFinish.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">localeWorkFinish</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectLocaleWorkFinish"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/localeWorkFinishSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">localeWorkFinishSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/handleRepairSheetFinish.do"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRepairSheetFinish</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    selectEmergencyProject(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/emergencyProjectHandleRepairSheetFinish"</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/handleRepairSheetFinishSubmit.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">handleRepairSheetFinishSubmit</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    JSONObject resultJson = batchAddProjectAttachFile(request);</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;按需求画一个工作流程。根据流程完成对应的java代码。&lt;/p&gt;
    
    </summary>
    
      <category term="java总结" scheme="http://iayun.vip/categories/java%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="工作流" scheme="http://iayun.vip/tags/%E5%B7%A5%E4%BD%9C%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>在页面添加一个文本域</title>
    <link href="http://iayun.vip/%E5%9C%A8%E9%A1%B5%E9%9D%A2%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E6%96%87%E6%9C%AC%E5%9F%9F.html"/>
    <id>http://iayun.vip/在页面添加一个文本域.html</id>
    <published>2018-12-16T14:00:00.000Z</published>
    <updated>2019-04-21T04:17:24.842Z</updated>
    
    <content type="html"><![CDATA[<p>在一个表单中添加文本域，在用户进行判断时，文本域在可编辑与不可编辑之间切换，并将之前输入的内容清除。</p><a id="more"></a><h3 id="功能实现"><a href="#功能实现" class="headerlink" title="功能实现"></a>功能实现</h3><p>这种方法在页面直接编写下面简单的代码就可以实现了</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span> <span class="attr">id</span>=<span class="string">"form-toolUsePlan"</span> <span class="attr">role</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldset</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>是否计划出错<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4 switch"</span> <span class="attr">data-on</span>=<span class="string">"primary"</span> <span class="attr">data-off</span>=<span class="string">"danger"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">id</span>=<span class="string">"toolUsePlan-rec_is_plan_error"</span> <span class="attr">data-on-text</span>=<span class="string">"是"</span></span></span><br><span class="line"><span class="tag">                <span class="attr">data-off-text</span>=<span class="string">"否"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>出错原因<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4 switch"</span> <span class="attr">data-on</span>=<span class="string">"primary"</span> <span class="attr">data-off</span>=<span class="string">"danger"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">rows</span>=<span class="string">"3"</span> <span class="attr">cols</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"form-control input-sm"</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">id</span>=<span class="string">"toolUsePlan-rec_reason_error"</span> <span class="attr">disabled</span>=<span class="string">"disabled"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    $("#toolUsePlan-rec_is_plan_error").on(</span></span><br><span class="line"><span class="undefined">        'switchChange.bootstrapSwitch',</span></span><br><span class="line"><span class="undefined">        function(event, state) &#123;</span></span><br><span class="line"><span class="undefined">           if (state) &#123;</span></span><br><span class="line"><span class="undefined">              $('#toolUsePlan-rec_reason_error').removeAttr("disabled");</span></span><br><span class="line"><span class="undefined">           &#125; else &#123;</span></span><br><span class="line"><span class="undefined">              $("#toolUsePlan-rec_reason_error").attr("disabled","disabled");</span></span><br><span class="line"><span class="undefined">            $("#toolUsePlan-rec_reason_error").val('');//将之前的清空</span></span><br><span class="line"><span class="undefined">           &#125;</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>另一种方法</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>是否按时归还<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-4 switch"</span> <span class="attr">data-on</span>=<span class="string">"primary"</span> <span class="attr">data-off</span>=<span class="string">"danger"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">id</span>=<span class="string">"toolUsePlan-rec_is_return_intime"</span> <span class="attr">data-on-text</span>=<span class="string">"是"</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-off-text</span>=<span class="string">"否"</span> <span class="attr">onchange</span>=<span class="string">"reason();"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-1 control-label"</span>&gt;</span>延期理由<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-5"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">rows</span>=<span class="string">"3"</span> <span class="attr">cols</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">"form-control input-sm"</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">id</span>=<span class="string">"toolUsePlan-rec_delay_reason"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    function reason() &#123;</span></span><br><span class="line"><span class="undefined">    if(typeof($("#toolUsePlan-rec_delay_reason").attr("readonly"))=="undefined") &#123;</span></span><br><span class="line"><span class="undefined">    $("#toolUsePlan-rec_delay_reason").attr("readonly", "readonly");</span></span><br><span class="line"><span class="undefined">    $("#toolUsePlan-rec_delay_reason").val("");</span></span><br><span class="line"><span class="undefined">    &#125; else &#123;</span></span><br><span class="line"><span class="undefined">    $("#toolUsePlan-rec_delay_reason").removeAttr("readonly");</span></span><br><span class="line"><span class="undefined">    &#125;    </span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="知识拓展"><a href="#知识拓展" class="headerlink" title="知识拓展"></a>知识拓展</h3><h4 id="attr-方法同时设置多个属性"><a href="#attr-方法同时设置多个属性" class="headerlink" title="attr() 方法同时设置多个属性"></a>attr() 方法同时设置多个属性</h4><p><strong>attr()有4个表达式</strong></p><ol><li>attr(传入属性名)：获取属性的值</li><li>attr(属性名, 属性值)：设置属性的值</li><li>attr(属性名,函数值)：设置属性的函数值</li><li>attr(attributes)：给指定元素设置多个属性值，即：{属性名一: “属性值一” , 属性名二: “属性值二” , … … }</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$("button").click(function()&#123;</span><br><span class="line">  $("#w3s").attr(&#123;</span><br><span class="line">    "href" : "http://www.w3school.com.cn/jquery",</span><br><span class="line">    "title" : "W3School jQuery Tutorial"</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="removeAttr-方法从被选元素移除一个或多个属性"><a href="#removeAttr-方法从被选元素移除一个或多个属性" class="headerlink" title="removeAttr() 方法从被选元素移除一个或多个属性"></a>removeAttr() 方法从被选元素移除一个或多个属性</h4><p>.removeAttr( attributeName ) : 为匹配的元素集合中的每个元素中移除一个属性（attribute）</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$('div').removeAttr("title class");</span><br></pre></td></tr></table></figure><h4 id="表单中readonly和disabled的区别"><a href="#表单中readonly和disabled的区别" class="headerlink" title="表单中readonly和disabled的区别"></a>表单中readonly和disabled的区别</h4><p>readonly只是使文本框不能输入，外观没有变化，而且表单提交时不影响获取value值；</p><p>disabled会使文本框变灰，而且通过表单提交时，获取不到文本框中的value值（如果有的话）。</p><p>readonly只针对input(text/password)和textarea有效;</p><p>disabled对于所有的表单元素都有效，包括select, radio, checkbox, button等。</p><h4 id="操作disabled属性的方法"><a href="#操作disabled属性的方法" class="headerlink" title="操作disabled属性的方法"></a>操作disabled属性的方法</h4><p>1.两种方法设置disabled属性：</p><p>　　$(‘#areaSelect’).attr(“disabled”,true);</p><p>　　$(‘#areaSelect’).attr(“disabled”,”disabled”);</p><p>2.三种方法移除disabled属性：</p><p>　　$(‘#areaSelect’).attr(“disabled”,false);</p><p>　　$(‘#areaSelect’).removeAttr(“disabled”);</p><p>　　$(‘#areaSelect’).attr(“disabled”,””);</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在一个表单中添加文本域，在用户进行判断时，文本域在可编辑与不可编辑之间切换，并将之前输入的内容清除。&lt;/p&gt;
    
    </summary>
    
      <category term="js总结" scheme="http://iayun.vip/categories/js%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="textarea" scheme="http://iayun.vip/tags/textarea/"/>
    
      <category term="disabled" scheme="http://iayun.vip/tags/disabled/"/>
    
      <category term="readonly" scheme="http://iayun.vip/tags/readonly/"/>
    
      <category term="removeAttr()" scheme="http://iayun.vip/tags/removeAttr/"/>
    
      <category term="attr()" scheme="http://iayun.vip/tags/attr/"/>
    
  </entry>
  
  <entry>
    <title>点击柱形图展示详细信息</title>
    <link href="http://iayun.vip/%E7%82%B9%E5%87%BB%E6%9F%B1%E5%BD%A2%E5%9B%BE%E5%B1%95%E7%A4%BA%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF.html"/>
    <id>http://iayun.vip/点击柱形图展示详细信息.html</id>
    <published>2018-12-15T14:00:00.000Z</published>
    <updated>2019-04-21T04:27:26.205Z</updated>
    
    <content type="html"><![CDATA[<p>先通过柱形图统计分析。</p><a id="more"></a><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/%E5%8F%96%E8%AF%81%E6%A1%A3%E6%A1%88%E7%BB%9F%E8%AE%A1.jpg" alt="取证档案统计"></p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E5%89%8D%E7%AB%AF%E7%9F%A5%E8%AF%86/%E5%8F%96%E8%AF%81%E6%A1%A3%E6%A1%88%E7%BB%9F%E8%AE%A1%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF.jpg" alt="取证档案统计详细信息"></p><p><code>.html</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>取证档案统计<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--公共资源开始--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">    <span class="attr">include</span>("<span class="attr">..</span>/<span class="attr">common</span>/<span class="attr">common.html</span>")&#123;&#125;</span></span><br><span class="line"><span class="tag">    %&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--公共资源结束--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span> <span class="attr">class</span>=<span class="string">"form-inline"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h5</span>&gt;</span></span><br><span class="line">        选择年份:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm form_year"</span> <span class="attr">id</span>=<span class="string">"stat-year"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-success btn-sm"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">onclick</span>=<span class="string">"statForensicsFiles();"</span>&gt;</span>统计</span><br><span class="line">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"myChart"</span> <span class="attr">style</span>=<span class="string">"width: auto;height: 500px;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"modal-forensicsFilesStat"</span> <span class="attr">class</span>=<span class="string">"modal fade"</span> <span class="attr">tabindex</span>=<span class="string">"-1"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-dialog"</span> <span class="attr">style</span>=<span class="string">"width: 1000px; height: 400px;"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-content"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-header"</span></span></span><br><span class="line"><span class="tag">                 <span class="attr">style</span>=<span class="string">"background-color: #307095; font-weight: bold;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"close"</span> <span class="attr">data-dismiss</span>=<span class="string">"modal"</span>&gt;</span>×</span><br><span class="line">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"modal-body"</span> <span class="attr">style</span>=<span class="string">"height:450px;width:997px;overflow:auto;"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">table</span> <span class="attr">id</span>=<span class="string">"jqGrid"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"jqGridPager"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">$(".form_year").datetimepicker(&#123;</span></span><br><span class="line"><span class="undefined">    format: 'yyyy',</span></span><br><span class="line"><span class="undefined">    autoclose: true,</span></span><br><span class="line"><span class="undefined">    startView: 'decade',</span></span><br><span class="line"><span class="undefined">minView: 'decade',</span></span><br><span class="line"><span class="undefined">    maxViewMode: 2,</span></span><br><span class="line"><span class="undefined">    minViewMode: 2,</span></span><br><span class="line"><span class="undefined">    forceParse: false,</span></span><br><span class="line"><span class="undefined">    language: 'zh-CN'</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">statForensicsFiles();</span></span><br><span class="line"><span class="undefined">    function statForensicsFiles() &#123;</span></span><br><span class="line"><span class="undefined">    $.ajax(&#123;</span></span><br><span class="line"><span class="undefined">            url: "$&#123;ctxPath&#125;/forensics/statPmsForensicsFiles.do",</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                year: $("#stat-year").val()</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            type: 'post',</span></span><br><span class="line"><span class="undefined">            cache: false,</span></span><br><span class="line"><span class="undefined">            dataType: 'json',</span></span><br><span class="line"><span class="undefined">            success: function (data) &#123;</span></span><br><span class="line"><span class="undefined">                var xA = [];</span></span><br><span class="line"><span class="undefined">                var yA = [];</span></span><br><span class="line"><span class="undefined">                for (var i=0; i&lt;data.length; i++) &#123;</span></span><br><span class="line"><span class="undefined">                xA.push(data[i].name);</span></span><br><span class="line"><span class="undefined">                yA.push(data[i].quantity);</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">                var myChart = echarts.init(document.getElementById('myChart'));</span></span><br><span class="line"><span class="undefined">                myChart.setOption(&#123;</span></span><br><span class="line"><span class="undefined">                    title: &#123;</span></span><br><span class="line"><span class="undefined">                        text: '取证档案统计'</span></span><br><span class="line"><span class="undefined">                    &#125;,</span></span><br><span class="line"><span class="undefined">                    tooltip: &#123;&#125;,</span></span><br><span class="line"><span class="undefined">                    legend: &#123;</span></span><br><span class="line"><span class="undefined">                        data:['文件数量']</span></span><br><span class="line"><span class="undefined">                    &#125;,</span></span><br><span class="line"><span class="undefined">                    xAxis: &#123;</span></span><br><span class="line"><span class="undefined">                        data: xA</span></span><br><span class="line"><span class="undefined">                    &#125;,</span></span><br><span class="line"><span class="undefined">                    yAxis: &#123;&#125;,</span></span><br><span class="line"><span class="undefined">                    series: [&#123;</span></span><br><span class="line"><span class="undefined">                        name: '数量',</span></span><br><span class="line"><span class="undefined">                        type: 'bar',</span></span><br><span class="line"><span class="undefined">                        itemStyle: &#123;</span></span><br><span class="line"><span class="undefined">                            normal: &#123;</span></span><br><span class="line"><span class="undefined">                                color: function(d)&#123;</span></span><br><span class="line"><span class="undefined">                                return </span></span><br><span class="line"><span class="undefined">                                    "#"+Math.</span></span><br><span class="line"><span class="undefined">                                    floor(Math.random()</span></span><br><span class="line"><span class="undefined">                                          *(256*256*256-1)).toString(16);</span></span><br><span class="line"><span class="undefined">                                &#125;</span></span><br><span class="line"><span class="undefined">                            &#125;</span></span><br><span class="line"><span class="undefined">                        &#125;,</span></span><br><span class="line"><span class="undefined">                        data: yA</span></span><br><span class="line"><span class="undefined">                    &#125;]</span></span><br><span class="line"><span class="undefined">                &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                  myChart.on('click', function(params)&#123;</span></span><br><span class="line"><span class="undefined">                    $("#jqGrid").jqGrid('setGridParam', &#123;</span></span><br><span class="line"><span class="undefined">                        datatype: 'json',</span></span><br><span class="line"><span class="undefined">                        postData: &#123;</span></span><br><span class="line"><span class="undefined">                        type: getProp(typeObj, params.name),</span></span><br><span class="line"><span class="undefined">                        year: $("#stat-year").val()</span></span><br><span class="line"><span class="undefined">                        &#125;, //发送数据</span></span><br><span class="line"><span class="undefined">                        page: 1</span></span><br><span class="line"><span class="undefined">                    &#125;).trigger("reloadGrid"); //重新载入                </span></span><br><span class="line"><span class="undefined">                $('#modal-forensicsFilesStat').modal('show');</span></span><br><span class="line"><span class="undefined">                &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            error: function (msg) &#123;</span></span><br><span class="line"><span class="undefined">                console.log(msg);</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="undefined">    var userObj = JSON.parse('$&#123;userObj&#125;');</span></span><br><span class="line"><span class="undefined">    var typeObj = JSON.parse('$&#123;typeObj&#125;');</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="undefined">    var colNames = ['ID', '姓名', '作业类别', '发证部门', </span></span><br><span class="line"><span class="undefined">                    '证号',  '现证书有效时间', '首次取证时间', </span></span><br><span class="line"><span class="undefined">                    '最后复审时间', '下次复审时间'];</span></span><br><span class="line"><span class="undefined">    var colModel = [&#123;</span></span><br><span class="line"><span class="undefined">        name: 'rec_obj_id',</span></span><br><span class="line"><span class="undefined">        index: 'rec_obj_id',</span></span><br><span class="line"><span class="undefined">        hidden: true,</span></span><br><span class="line"><span class="undefined">        sortable: false</span></span><br><span class="line"><span class="undefined">    &#125;, &#123;</span></span><br><span class="line"><span class="undefined">        name: 'rec_userid',</span></span><br><span class="line"><span class="undefined">        index: 'rec_userid',</span></span><br><span class="line"><span class="undefined">        formatter: function (v, opt, rec) &#123;</span></span><br><span class="line"><span class="undefined">            return userObj[v];</span></span><br><span class="line"><span class="undefined">        &#125;,</span></span><br><span class="line"><span class="undefined">        sortable: false</span></span><br><span class="line"><span class="undefined">    &#125;, &#123;</span></span><br><span class="line"><span class="undefined">        name: 'rec_work_category',</span></span><br><span class="line"><span class="undefined">        index: 'rec_work_category',</span></span><br><span class="line"><span class="undefined">        formatter: function (v, opt, rec) &#123;</span></span><br><span class="line"><span class="undefined">        return typeObj[v] == undefined ? "" : typeObj[v];</span></span><br><span class="line"><span class="undefined">    &#125;,</span></span><br><span class="line"><span class="undefined">        sortable: false</span></span><br><span class="line"><span class="undefined">    &#125;, &#123;</span></span><br><span class="line"><span class="undefined">        name: 'rec_issuing_org',</span></span><br><span class="line"><span class="undefined">        index: 'rec_issuing_org',</span></span><br><span class="line"><span class="undefined">        sortable: false</span></span><br><span class="line"><span class="undefined">    &#125;, &#123;</span></span><br><span class="line"><span class="undefined">        name: 'rec_certify_num',</span></span><br><span class="line"><span class="undefined">        index: 'rec_certify_num',</span></span><br><span class="line"><span class="undefined">        sortable: false</span></span><br><span class="line"><span class="undefined">    &#125;, &#123;</span></span><br><span class="line"><span class="undefined">        name: 'rec_certificate_valid',</span></span><br><span class="line"><span class="undefined">        index: 'rec_certificate_valid',</span></span><br><span class="line"><span class="undefined">    &#125;, &#123;</span></span><br><span class="line"><span class="undefined">        name: 'rec_first_forensics_time',</span></span><br><span class="line"><span class="undefined">        index: 'rec_first_forensics_time',</span></span><br><span class="line"><span class="undefined">    &#125;, &#123;</span></span><br><span class="line"><span class="undefined">        name: 'rec_latest_review_time',</span></span><br><span class="line"><span class="undefined">        index: 'rec_latest_review_time',</span></span><br><span class="line"><span class="undefined">    &#125;, &#123;</span></span><br><span class="line"><span class="undefined">        name: 'rec_next_review_time',</span></span><br><span class="line"><span class="undefined">        index: 'rec_next_review_time',</span></span><br><span class="line"><span class="undefined">    &#125;];</span></span><br><span class="line"><span class="undefined">    $("#jqGrid")</span></span><br><span class="line"><span class="undefined">    .jqGrid(</span></span><br><span class="line"><span class="undefined">        &#123;</span></span><br><span class="line"><span class="undefined">            url: "$&#123;ctxPath&#125;/forensics/getListByType.do",</span></span><br><span class="line"><span class="undefined">            datatype: "json",</span></span><br><span class="line"><span class="undefined">            mtype: "post",</span></span><br><span class="line"><span class="undefined">            styleUI: 'Bootstrap',</span></span><br><span class="line"><span class="undefined">            postData: &#123;&#125;,</span></span><br><span class="line"><span class="undefined">            colNames: colNames,</span></span><br><span class="line"><span class="undefined">            colModel: colModel,</span></span><br><span class="line"><span class="undefined">            /* 分页 */</span></span><br><span class="line"><span class="undefined">            autowidth: true,</span></span><br><span class="line"><span class="undefined">            caption: "取证档案展示",</span></span><br><span class="line"><span class="undefined">            rowNum: 10,</span></span><br><span class="line"><span class="undefined">            rowList: [10, 20, 30],</span></span><br><span class="line"><span class="undefined">            jsonReader: &#123;</span></span><br><span class="line"><span class="undefined">                root: "rows",</span></span><br><span class="line"><span class="undefined">                page: "page",</span></span><br><span class="line"><span class="undefined">                total: "total",</span></span><br><span class="line"><span class="undefined">                records: "records",</span></span><br><span class="line"><span class="undefined">                repeatitems: false</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            onSelectRow: function (id) &#123;</span></span><br><span class="line"><span class="undefined">                var data = $("#jqGrid")</span></span><br><span class="line"><span class="undefined">                    .jqGrid("getRowData", id);</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            pager: "#jqGridPager"</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">$("#jqGrid").setGridWidth(930);</span></span><br><span class="line"><span class="undefined">    $("#jqGrid").setGridHeight(280);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;先通过柱形图统计分析。&lt;/p&gt;
    
    </summary>
    
      <category term="js总结" scheme="http://iayun.vip/categories/js%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="柱形图" scheme="http://iayun.vip/tags/%E6%9F%B1%E5%BD%A2%E5%9B%BE/"/>
    
  </entry>
  
  <entry>
    <title>新增上传附件的功能</title>
    <link href="http://iayun.vip/%E6%96%B0%E5%A2%9E%E4%B8%8A%E4%BC%A0%E9%99%84%E4%BB%B6%E7%9A%84%E5%8A%9F%E8%83%BD.html"/>
    <id>http://iayun.vip/新增上传附件的功能.html</id>
    <published>2018-12-15T14:00:00.000Z</published>
    <updated>2019-04-21T04:18:18.317Z</updated>
    
    <content type="html"><![CDATA[<p>在选择附件后，自动上传到指定目录下，不随其它数据的失败插入而终止。<br><a id="more"></a><br><code>.html</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span> <span class="attr">class</span>=<span class="string">"form-horizontal"</span> <span class="attr">autocomplete</span>=<span class="string">"off"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">fieldset</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>线路<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm"</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">id</span>=<span class="string">"modal-normalProject-rec_line"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>杆塔<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm"</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">id</span>=<span class="string">"modal-normalProject-rec_pole"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>缺陷日期<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm form_date"</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">id</span>=<span class="string">"modal-normalProject-rec_bug_date"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>缺陷描述<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">rows</span>=<span class="string">"5"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm"</span></span></span><br><span class="line"><span class="tag">                          <span class="attr">id</span>=<span class="string">"modal-normalProject-rec_bug_desc"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label"</span>&gt;</span>计划检修日期<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm form_date1"</span></span></span><br><span class="line"><span class="tag">                       <span class="attr">id</span>=<span class="string">"modal-normalProject-rec_inspect_date"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- ********************************附件******************************** --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">"col-sm-2 control-label input-sm"</span>&gt;</span>附件<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"fileDiv"</span> <span class="attr">class</span>=<span class="string">"col-sm-10"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    var opFlag = 'add';</span></span><br><span class="line"><span class="undefined">    var statusObj = JSON.parse('$&#123;statusObj&#125;');</span></span><br><span class="line"><span class="undefined">    $(".form_date").datetimepicker(&#123;</span></span><br><span class="line"><span class="undefined">        format: 'yyyy-mm-dd',</span></span><br><span class="line"><span class="undefined">        autoclose: true,</span></span><br><span class="line"><span class="undefined">        minView: 2,</span></span><br><span class="line"><span class="undefined">        bootcssVer: 3,</span></span><br><span class="line"><span class="undefined">        language: 'zh-CN',</span></span><br><span class="line"><span class="undefined">        todayHighlight: true,</span></span><br><span class="line"><span class="undefined">        todayBtn: true</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined">    $(".form_date1").datetimepicker(&#123;</span></span><br><span class="line"><span class="undefined">        format: 'yyyy-mm-dd',</span></span><br><span class="line"><span class="undefined">        autoclose: true,</span></span><br><span class="line"><span class="undefined">        minView: 2,</span></span><br><span class="line"><span class="undefined">        bootcssVer: 3,</span></span><br><span class="line"><span class="undefined">        language: 'zh-CN',</span></span><br><span class="line"><span class="undefined">        todayHighlight: true,</span></span><br><span class="line"><span class="undefined">        todayBtn: true,</span></span><br><span class="line"><span class="undefined">        pickerPosition: 'top-right'</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined">    $("#jqGrid")</span></span><br><span class="line"><span class="undefined">        .jqGrid(</span></span><br><span class="line"><span class="undefined">            &#123;</span></span><br><span class="line"><span class="undefined">                url: "$&#123;ctxPath&#125;/normalProject/getNormalProjectList.do",</span></span><br><span class="line"><span class="undefined">                datatype: "json",</span></span><br><span class="line"><span class="undefined">                mtype: "post",</span></span><br><span class="line"><span class="undefined">                styleUI: 'Bootstrap',</span></span><br><span class="line"><span class="undefined">                postData: &#123;&#125;,</span></span><br><span class="line"><span class="undefined">                colNames: ['编号', '线路', '杆塔', '缺陷描述', '缺陷日期', '计划检修日期', '状态'],</span></span><br><span class="line"><span class="undefined">                colModel: [&#123;</span></span><br><span class="line"><span class="undefined">                    name: 'rec_obj_id',</span></span><br><span class="line"><span class="undefined">                    index: 'rec_obj_id',</span></span><br><span class="line"><span class="undefined">                    hidden: true,</span></span><br><span class="line"><span class="undefined">                    sortable: false</span></span><br><span class="line"><span class="undefined">                &#125;, &#123;</span></span><br><span class="line"><span class="undefined">                    name: 'rec_line',</span></span><br><span class="line"><span class="undefined">                    index: 'rec_line',</span></span><br><span class="line"><span class="undefined">                    sortable: false</span></span><br><span class="line"><span class="undefined">                &#125;, &#123;</span></span><br><span class="line"><span class="undefined">                    name: 'rec_pole',</span></span><br><span class="line"><span class="undefined">                    index: 'rec_pole',</span></span><br><span class="line"><span class="undefined">                    sortable: false</span></span><br><span class="line"><span class="undefined">                &#125;, &#123;</span></span><br><span class="line"><span class="undefined">                    name: 'rec_bug_desc',</span></span><br><span class="line"><span class="undefined">                    index: 'rec_bug_desc',</span></span><br><span class="line"><span class="undefined">                    sortable: false</span></span><br><span class="line"><span class="undefined">                &#125;, &#123;</span></span><br><span class="line"><span class="undefined">                    name: 'rec_bug_date',</span></span><br><span class="line"><span class="undefined">                    index: 'rec_bug_date',</span></span><br><span class="line"><span class="undefined">                    sortable: false</span></span><br><span class="line"><span class="undefined">                &#125;, &#123;</span></span><br><span class="line"><span class="undefined">                    name: 'rec_inspect_date',</span></span><br><span class="line"><span class="undefined">                    index: 'rec_inspect_date',</span></span><br><span class="line"><span class="undefined">                    sortable: false</span></span><br><span class="line"><span class="undefined">                &#125;, &#123;</span></span><br><span class="line"><span class="undefined">                    name: 'rec_status',</span></span><br><span class="line"><span class="undefined">                    index: 'rec_status',</span></span><br><span class="line"><span class="undefined">                    formatter: function (v, opt, rec) &#123;</span></span><br><span class="line"><span class="undefined">                    return statusObj[v];</span></span><br><span class="line"><span class="undefined">                    &#125;,</span></span><br><span class="line"><span class="undefined">                    sortable: false</span></span><br><span class="line"><span class="undefined">                &#125;],</span></span><br><span class="line"><span class="undefined">                autowidth: true,</span></span><br><span class="line"><span class="undefined">                caption: "常规项目列表",</span></span><br><span class="line"><span class="undefined">                rowNum: 10,</span></span><br><span class="line"><span class="undefined">                rowList: [10, 20, 30],</span></span><br><span class="line"><span class="undefined">                jsonReader: &#123;</span></span><br><span class="line"><span class="undefined">                    root: "rows",</span></span><br><span class="line"><span class="undefined">                    page: "page",</span></span><br><span class="line"><span class="undefined">                    total: "total",</span></span><br><span class="line"><span class="undefined">                    records: "records",</span></span><br><span class="line"><span class="undefined">                    repeatitems: false</span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="undefined">                onSelectRow: function (id) &#123;</span></span><br><span class="line"><span class="undefined">                    var data = $("#jqGrid")</span></span><br><span class="line"><span class="undefined">                        .jqGrid("getRowData", id);</span></span><br><span class="line"><span class="undefined">                &#125;,</span></span><br><span class="line"><span class="undefined">                pager: "#jqGridPager"</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    $("#jqGrid").setGridHeight(window.innerHeight - 170);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    function openNormalProjectModal(flag) &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        opFlag = flag;</span></span><br><span class="line"><span class="undefined">        $("#modal-normalProject :input").each(function () &#123;</span></span><br><span class="line"><span class="undefined">            $(this).val("");</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">        if (opFlag == 'add') &#123;</span></span><br><span class="line"><span class="undefined">            $("#modal-normalProject-title").text("添加常规项目信息");</span></span><br><span class="line"><span class="undefined">            /* ******************************增加附件*********************** */</span></span><br><span class="line"><span class="undefined">            refreshMultiFileUpload('fileDiv');</span></span><br><span class="line"><span class="undefined">            $("#modal-normalProject-rec_projectid").removeAttr("disabled", "disabled");</span></span><br><span class="line"><span class="undefined">            $('#modal-normalProject').modal('show');</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    function handleNormalProject() &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        if ($("#modal-normalProject-rec_line").val() == '') &#123;</span></span><br><span class="line"><span class="undefined">            alertify.alert('提示', '线路不能为空!');</span></span><br><span class="line"><span class="undefined">            return false;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        if ($("#modal-normalProject-rec_line").val() == '') &#123;</span></span><br><span class="line"><span class="undefined">            alertify.alert('提示', '杆塔不能为空!');</span></span><br><span class="line"><span class="undefined">            return false;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        if ($("#modal-normalProject-rec_bug_date").val() == '') &#123;</span></span><br><span class="line"><span class="undefined">            alertify.alert('提示', '缺陷日期不能为空!');</span></span><br><span class="line"><span class="undefined">            return false;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        if ($("#modal-normalProject-rec_bug_desc").val() == '') &#123;</span></span><br><span class="line"><span class="undefined">            alertify.alert('提示', '缺陷描述不能为空!');</span></span><br><span class="line"><span class="undefined">            return false;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        if ($("#modal-normalProject-rec_inspect_date").val() == '') &#123;</span></span><br><span class="line"><span class="undefined">            alertify.alert('提示', '计划检修日期不能为空!');</span></span><br><span class="line"><span class="undefined">            return false;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        /* ***************************附件不能为空************************ */</span></span><br><span class="line"><span class="undefined">        if(fileNameArr.length==0)&#123;</span></span><br><span class="line"><span class="undefined">        alertify.alert('提示', '请上传附件!');</span></span><br><span class="line"><span class="undefined">            return false;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        var data = &#123;&#125;;</span></span><br><span class="line"><span class="undefined">        var url = '';</span></span><br><span class="line"><span class="undefined">        data = getFormData("modal-normalProject", "modal-normalProject");</span></span><br><span class="line"><span class="undefined">        url = '$&#123;ctxPath&#125;/normalProject/addNormalProject.do';</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        alertify</span></span><br><span class="line"><span class="undefined">            .confirm(</span></span><br><span class="line"><span class="undefined">                '确认框',</span></span><br><span class="line"><span class="undefined">                '确认提交该常规项目?',</span></span><br><span class="line"><span class="undefined">                function () &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                    $.ajax(&#123;</span></span><br><span class="line"><span class="undefined">                        url: url,</span></span><br><span class="line"><span class="undefined">                        data: &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                            formData: JSON.stringify(data),</span></span><br><span class="line"><span class="undefined">                   /***************************图片************************* */</span></span><br><span class="line"><span class="undefined">                            fileNameArr: JSON.stringify(fileNameArr)</span></span><br><span class="line"><span class="undefined">                        &#125;,</span></span><br><span class="line"><span class="undefined">                        type: 'post',</span></span><br><span class="line"><span class="undefined">                        cache: false,</span></span><br><span class="line"><span class="undefined">                        dataType: 'json',</span></span><br><span class="line"><span class="undefined">                        success: function (data) &#123;</span></span><br><span class="line"><span class="undefined">                            if (data.state) &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                                $('#modal-normalProject').modal('hide');</span></span><br><span class="line"><span class="undefined">                                queryNormalProject();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                            &#125; else &#123;</span></span><br><span class="line"><span class="undefined">                                alertify.error('保存失败!' + data.msg);</span></span><br><span class="line"><span class="undefined">                            &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                        &#125;,</span></span><br><span class="line"><span class="undefined">                        error: function (msg) &#123;</span></span><br><span class="line"><span class="undefined">                            console.log(msg);</span></span><br><span class="line"><span class="undefined">                        &#125;</span></span><br><span class="line"><span class="undefined">                    &#125;);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">                &#125;, function () &#123;</span></span><br><span class="line"><span class="undefined">                    alertify.error('Cancel');</span></span><br><span class="line"><span class="undefined">                &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    function queryNormalProject() &#123;</span></span><br><span class="line"><span class="undefined">        var data = &#123;&#125;;</span></span><br><span class="line"><span class="undefined">        $("#jqGrid").jqGrid('setGridParam', &#123;</span></span><br><span class="line"><span class="undefined">            datatype: 'json',</span></span><br><span class="line"><span class="undefined">            postData: data, //发送数据</span></span><br><span class="line"><span class="undefined">            page: 1</span></span><br><span class="line"><span class="undefined">        &#125;).trigger("reloadGrid"); //重新载入</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>Controller.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/normalProject"</span>)</span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NormalProjectController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IPmsNormalProjectService pmsNormalProjectService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ISysCodeContentService sysCodeContentService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ISysUserService sysUserService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/index.do"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">index</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">List&lt;SysCodeContent&gt; statusList = sysCodeContentService.getCodeContentList(Constant.CODE_CATEGORY_PROJECT_STATUS);</span><br><span class="line">JSONObject statusObject = JsonUtil.getJSONObject(statusList);</span><br><span class="line">request.setAttribute(<span class="string">"statusObj"</span>, statusObject);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/normalProject"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/getNormalProjectList.do"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CustomPager&lt;PmsNormalProject&gt; <span class="title">getNormalProjectList</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String page = request.getParameter(<span class="string">"page"</span>);</span><br><span class="line">        String rows = request.getParameter(<span class="string">"rows"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> pmsNormalProjectService.getNormalProjectPager(<span class="keyword">null</span>, <span class="keyword">null</span>, page, rows);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping</span>(value = <span class="string">"/addNormalProject.do"</span>, produces = <span class="string">"text/html;charset=UTF-8"</span>)</span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">addNormalProject</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String formData = request.getParameter(<span class="string">"formData"</span>);</span><br><span class="line">        String fileNameArr = request.getParameter(<span class="string">"fileNameArr"</span>);</span><br><span class="line">        JSONArray fileNameArray = JSON.parseArray(fileNameArr);</span><br><span class="line"></span><br><span class="line">        PmsNormalProject normalProject = JSON.parseObject(formData, PmsNormalProject.class);</span><br><span class="line">        normalProject.setRec_obj_id(UuidUtil.getUUID());</span><br><span class="line">        normalProject.setRec_create_date(<span class="keyword">new</span> Date());</span><br><span class="line">        normalProject.setRec_create_user(UserUtil.getCurrentUserId());</span><br><span class="line">        normalProject.setRec_create_org(UserUtil.getCurrentOrgId());</span><br><span class="line">        normalProject.setRec_status(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;PmsProjectAttachFile&gt; projectAttachFileList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; fileNameArray.size(); i++) &#123;</span><br><span class="line">            JSONObject fileNameObj = (JSONObject) fileNameArray.get(i);</span><br><span class="line">            PmsProjectAttachFile projectAttachFile = <span class="keyword">new</span> PmsProjectAttachFile();</span><br><span class="line">            projectAttachFile.setRec_projectid(normalProject.getRec_obj_id());</span><br><span class="line">            projectAttachFile.setRec_order(i);</span><br><span class="line">            projectAttachFile.setRec_file_name(fileNameObj.getString(<span class="string">"fileName"</span>));</span><br><span class="line">            projectAttachFileList.add(projectAttachFile);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> state = pmsNormalProjectService.addNormalProject(normalProject,projectAttachFileList);</span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        resultJson.put(<span class="string">"state"</span>, state);</span><br><span class="line">        <span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><code>Bean.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.pms.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.activerecord.Model;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotations.TableId;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotations.TableName;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.enums.IdType;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonFormat;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TableName</span>(<span class="string">"pms_normal_project"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PmsNormalProject</span> <span class="keyword">extends</span> <span class="title">Model</span>&lt;<span class="title">PmsNormalProject</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">4301532149343662957L</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TableId</span>(value = <span class="string">"rec_obj_id"</span>, type = IdType.UUID)</span><br><span class="line"><span class="keyword">private</span> String rec_obj_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String rec_year_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String rec_month_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> String rec_line;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String rec_pole;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String rec_bug_desc;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String rec_create_user;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String rec_create_org;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date rec_bug_date;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date rec_create_date;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer rec_status;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String rec_process_instance_id;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer rec_is_satisfied;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer rec_is_qualified;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date rec_inspect_date;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getRec_obj_id</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> rec_obj_id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRec_obj_id</span><span class="params">(String rec_obj_id)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.rec_obj_id = rec_obj_id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonFormat</span>(pattern = <span class="string">"yyyy-MM-dd"</span>, timezone = <span class="string">"GMT+8"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Date <span class="title">getRec_bug_date</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> rec_bug_date;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRec_bug_date</span><span class="params">(Date rec_bug_date)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.rec_bug_date = rec_bug_date;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Integer <span class="title">getRec_status</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> rec_status;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setRec_status</span><span class="params">(Integer rec_status)</span> </span>&#123;</span><br><span class="line"><span class="keyword">this</span>.rec_status = rec_status;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">protected</span> Serializable <span class="title">pkVal</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.rec_obj_id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">"PmsNormalProject [rec_obj_id="</span> + rec_obj_id + <span class="string">", rec_year_id="</span> + rec_year_id + <span class="string">", rec_month_id="</span></span><br><span class="line">+ rec_month_id + <span class="string">", rec_line="</span> + rec_line + <span class="string">", rec_pole="</span> + rec_pole + <span class="string">", rec_bug_desc="</span> + rec_bug_desc</span><br><span class="line">+ <span class="string">", rec_create_user="</span> + rec_create_user + <span class="string">", rec_create_org="</span> + rec_create_org + <span class="string">", rec_bug_date="</span></span><br><span class="line">+ rec_bug_date + <span class="string">", rec_create_date="</span> + rec_create_date + <span class="string">", rec_status="</span> + rec_status</span><br><span class="line">+ <span class="string">", rec_process_instance_id="</span> + rec_process_instance_id + <span class="string">", rec_is_satisfied="</span> + rec_is_satisfied</span><br><span class="line">+ <span class="string">", rec_is_qualified="</span> + rec_is_qualified + <span class="string">", rec_inspect_date="</span> + rec_inspect_date + <span class="string">"]"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Service.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.matai.pms.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.service.IService;</span><br><span class="line"><span class="keyword">import</span> com.matai.pms.bean.CustomPager;</span><br><span class="line"><span class="keyword">import</span> com.matai.pms.bean.PmsNormalProject;</span><br><span class="line"><span class="keyword">import</span> com.matai.pms.bean.PmsProjectAttachFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IPmsNormalProjectService</span> <span class="keyword">extends</span> <span class="title">IService</span>&lt;<span class="title">PmsNormalProject</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">addNormalProject</span><span class="params">(PmsNormalProject normalProject)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">updateNormalProject</span><span class="params">(PmsNormalProject normalProject)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">PmsNormalProject <span class="title">getNormalProject</span><span class="params">(String objId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">PmsNormalProject <span class="title">getNormalProjectByProInstId</span><span class="params">(String proInstId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">CustomPager&lt;PmsNormalProject&gt; <span class="title">getNormalProjectPager</span><span class="params">(String yearId, String monthId, String page, String rows)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">CustomPager&lt;PmsNormalProject&gt; <span class="title">getNormalProjectReportedPager</span><span class="params">(String page, String rows)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">CustomPager&lt;PmsNormalProject&gt; <span class="title">getNormalProjectReportedYearlyPager</span><span class="params">(String yearId, String page, String rows)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;PmsNormalProject&gt; <span class="title">getNormalProjectListByMonth</span><span class="params">(String monthId)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">List&lt;PmsNormalProject&gt; <span class="title">getNormalProjectListByYear</span><span class="params">(String yearId)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">boolean</span> <span class="title">addNormalProject</span><span class="params">(PmsNormalProject normalProject, List&lt;PmsProjectAttachFile&gt; projectAttachFileServiceList)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ServiceImpl.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.matai.pms.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.StringUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.mapper.EntityWrapper;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.plugins.Page;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.service.impl.ServiceImpl;</span><br><span class="line"><span class="keyword">import</span> com.matai.pms.bean.CustomPager;</span><br><span class="line"><span class="keyword">import</span> com.matai.pms.bean.PmsNormalProject;</span><br><span class="line"><span class="keyword">import</span> com.matai.pms.bean.PmsProjectAttachFile;</span><br><span class="line"><span class="keyword">import</span> com.matai.pms.dao.IPmsNormalProjectMapper;</span><br><span class="line"><span class="keyword">import</span> com.matai.pms.service.IPmsNormalProjectService;</span><br><span class="line"><span class="keyword">import</span> com.matai.pms.service.IPmsProjectAttachFileService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PmsNormalProjectServiceImpl</span> <span class="keyword">extends</span> <span class="title">ServiceImpl</span>&lt;<span class="title">IPmsNormalProjectMapper</span>, <span class="title">PmsNormalProject</span>&gt; <span class="keyword">implements</span> <span class="title">IPmsNormalProjectService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> IPmsProjectAttachFileService iPmsProjectAttachFileService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addNormalProject</span><span class="params">(PmsNormalProject normalProject)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.insert(normalProject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">updateNormalProject</span><span class="params">(PmsNormalProject normalProject)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.updateById(normalProject);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PmsNormalProject <span class="title">getNormalProject</span><span class="params">(String objId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.selectById(objId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> PmsNormalProject <span class="title">getNormalProjectByProInstId</span><span class="params">(String proInstId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.selectOne(<span class="keyword">new</span> EntityWrapper&lt;PmsNormalProject&gt;().eq(<span class="string">"rec_process_instance_id"</span>, proInstId));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CustomPager&lt;PmsNormalProject&gt; <span class="title">getNormalProjectPager</span><span class="params">(String yearId, String monthId, String page, String rows)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pageSize = StringUtils.isEmpty(rows) ? <span class="number">10</span> : Integer.valueOf(rows);</span><br><span class="line">        <span class="keyword">int</span> currPage = StringUtils.isEmpty(page) ? <span class="number">1</span> : Integer.valueOf(page);</span><br><span class="line"></span><br><span class="line">        Page&lt;PmsNormalProject&gt; queryPage = <span class="keyword">new</span> Page&lt;&gt;(currPage, pageSize);</span><br><span class="line">        EntityWrapper&lt;PmsNormalProject&gt; entityWrapper = <span class="keyword">new</span> EntityWrapper&lt;&gt;();</span><br><span class="line">        entityWrapper.orderBy(<span class="string">"rec_create_date"</span>, <span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(yearId)) &#123;</span><br><span class="line">entityWrapper.eq(<span class="string">"rec_year_id"</span>, yearId);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!StringUtils.isEmpty(monthId)) &#123;</span><br><span class="line">        entityWrapper.eq(<span class="string">"rec_month_id"</span>, monthId);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Page&lt;PmsNormalProject&gt; normalProjectPage = <span class="keyword">this</span>.selectPage(queryPage, entityWrapper);</span><br><span class="line"></span><br><span class="line">        CustomPager&lt;PmsNormalProject&gt; customPager = <span class="keyword">new</span> CustomPager&lt;&gt;(normalProjectPage);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> customPager;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CustomPager&lt;PmsNormalProject&gt; <span class="title">getNormalProjectReportedPager</span><span class="params">(String page, String rows)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> pageSize = StringUtils.isEmpty(rows) ? <span class="number">10</span> : Integer.valueOf(rows);</span><br><span class="line">        <span class="keyword">int</span> currPage = StringUtils.isEmpty(page) ? <span class="number">1</span> : Integer.valueOf(page);</span><br><span class="line"></span><br><span class="line">        Page&lt;PmsNormalProject&gt; queryPage = <span class="keyword">new</span> Page&lt;&gt;(currPage, pageSize);</span><br><span class="line">        EntityWrapper&lt;PmsNormalProject&gt; entityWrapper = <span class="keyword">new</span> EntityWrapper&lt;&gt;();</span><br><span class="line">        entityWrapper.orderBy(<span class="string">"rec_create_date"</span>, <span class="keyword">false</span>).eq(<span class="string">"rec_status"</span>, <span class="number">1</span>).andNew()</span><br><span class="line">        .isNull(<span class="string">"rec_year_id"</span>).or().eq(<span class="string">"rec_year_id"</span>, <span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">        Page&lt;PmsNormalProject&gt; normalProjectPage = <span class="keyword">this</span>.selectPage(queryPage, entityWrapper);</span><br><span class="line"></span><br><span class="line">        CustomPager&lt;PmsNormalProject&gt; customPager = <span class="keyword">new</span> CustomPager&lt;&gt;(normalProjectPage);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> customPager;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CustomPager&lt;PmsNormalProject&gt; <span class="title">getNormalProjectReportedYearlyPager</span><span class="params">(String yearId, String page, String rows)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> pageSize = StringUtils.isEmpty(rows) ? <span class="number">10</span> : Integer.valueOf(rows);</span><br><span class="line">        <span class="keyword">int</span> currPage = StringUtils.isEmpty(page) ? <span class="number">1</span> : Integer.valueOf(page);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(yearId)) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> CustomPager&lt;&gt;();</span><br><span class="line">&#125;</span><br><span class="line">        Page&lt;PmsNormalProject&gt; queryPage = <span class="keyword">new</span> Page&lt;&gt;(currPage, pageSize);</span><br><span class="line">        EntityWrapper&lt;PmsNormalProject&gt; entityWrapper = <span class="keyword">new</span> EntityWrapper&lt;&gt;();</span><br><span class="line">        entityWrapper.orderBy(<span class="string">"rec_create_date"</span>, <span class="keyword">false</span>).eq(<span class="string">"rec_year_id"</span>, yearId).andNew()</span><br><span class="line">        .isNull(<span class="string">"rec_month_id"</span>).or().eq(<span class="string">"rec_month_id"</span>, <span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">        Page&lt;PmsNormalProject&gt; normalProjectPage = <span class="keyword">this</span>.selectPage(queryPage, entityWrapper);</span><br><span class="line">        CustomPager&lt;PmsNormalProject&gt; customPager = <span class="keyword">new</span> CustomPager&lt;&gt;(normalProjectPage);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> customPager;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;PmsNormalProject&gt; <span class="title">getNormalProjectListByMonth</span><span class="params">(String monthId)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.selectList(<span class="keyword">new</span> EntityWrapper&lt;PmsNormalProject&gt;().eq(<span class="string">"rec_month_id"</span>, monthId));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;PmsNormalProject&gt; <span class="title">getNormalProjectListByYear</span><span class="params">(String yearId)</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.selectList(<span class="keyword">new</span> EntityWrapper&lt;PmsNormalProject&gt;().eq(<span class="string">"rec_year_id"</span>, yearId));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addNormalProject</span><span class="params">(PmsNormalProject normalProject,</span></span></span><br><span class="line"><span class="function"><span class="params">List&lt;PmsProjectAttachFile&gt; projectAttachFileList)</span> </span>&#123;</span><br><span class="line"><span class="keyword">boolean</span> state = <span class="keyword">this</span>.insert(normalProject);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (state) &#123;</span><br><span class="line">            <span class="keyword">if</span> (projectAttachFileList != <span class="keyword">null</span> &amp;&amp; projectAttachFileList.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                state = iPmsProjectAttachFileService.batchAddProjectAttachFile(projectAttachFileList);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Mapper.java</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.matai.pms.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.matai.pms.bean.PmsNormalProject;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IPmsNormalProjectMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">PmsNormalProject</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在选择附件后，自动上传到指定目录下，不随其它数据的失败插入而终止。&lt;br&gt;
    
    </summary>
    
      <category term="java总结" scheme="http://iayun.vip/categories/java%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="上传文件" scheme="http://iayun.vip/tags/%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>《We Are Not Ourselves》</title>
    <link href="http://iayun.vip/%E3%80%8AWe-Are-Not-Ourselves%E3%80%8B.html"/>
    <id>http://iayun.vip/《We-Are-Not-Ourselves》.html</id>
    <published>2018-11-21T13:25:35.000Z</published>
    <updated>2019-01-01T05:04:28.548Z</updated>
    
    <content type="html"><![CDATA[<p>《We Are Not Ourselves》被翻译《不属于我们的世纪》，或许翻译成《身不由己》更好点，谁知道呢。读书之间发生了很多事，跨度有点长，先前读的已经记不真切了，但还是想写点什么，读到的更多是欲望与不满，或许自己正处于这样一个阶段，也是在算不上一个淡泊名利的人。</p><a id="more"></a><p>故事发生在二十世纪中叶，爱尔兰移民美国，一个是货车司机，一个是商铺的售货员，他们在酒吧相遇。豪气冲天却又碌碌无为的父亲，埋怨丈夫无能幽怨母亲，有了一个倔犟好强的女儿。</p><p>故事中的人啊，大多都是特点鲜明，纯粹，现实中的自己总是没法做到如此。</p><p>母亲酗酒半生，到头来将烟酒戒掉，妄图身体安康，在病床临终说病痛没有放过她，好强父亲也在不久后终于癌症晚期。</p><p>书中描述到他们的母亲坐地铁上下班，惊讶了一下，比中国提前了好久，又去百度科普一下，美国十九世纪末就开通第一辆地铁，这次是震惊！</p><p>令艾琳童年影响深刻的是父母在她的视线里没有牵过彼此的手，是父亲提前接她放学只是为了去酒吧有尊严的喝一杯，是母亲带她去壁橱前看奢侈品，是母亲在沙发上卷曲着右手夹烟，左手持红酒的落魄，每次她都帮母亲盖好被子，在她怀里偷偷躺一会。</p><p>在社区上的中学，后来去读了大多人期望的护士本科，在学校兼职努力赚研究生学费，期待要去留学，去读自己喜欢的专业，管理或者金融。在我将这本书认作描述美国女性解放自由的时候，作者却快速的在推动情节。</p><p>在大学认识了一个蛮优秀的青年人，埃德尽管不是她心目中的幻想，她还是决定嫁给他，因为他们有很多共同语言。彼此认同之间的追求，所以他们相恋，他们结婚。</p><p>结婚后，由于埃德要做实验，没有去蜜月旅行，有一天埃德养的动物全死了，没有试验数据，学院表示他可以正常毕业，但是埃德还是决定重新再来一次，后来就平稳的度过几年。在他们准备要生孩子的时候，却发现不能生育，她特别喜欢万圣节去她家讨要糖果的小孩。或许是上帝的一时仁慈，他们在三十岁时突然发现怀孕了，艾琳很是害怕自己像母亲那样流产，不过最终还是顺利有了一个健康的孩子——康奈尔。</p><p>房东联系了艾琳，提出房子买给了她，同时允许房东一家像他们之前一样可以继续租用。艾琳同埃德商量买下了，不过让他们到二楼去。</p><p>再后后来，他们发现社区里的印度裔人越来越多，所以艾琳想要搬去更好的社区，住更大的房子，埃德似乎并不这样想。埃德没有听从艾琳的建议去当一名教授，而是继续做社区老师，继续做着实验，她自己也因为工作不顺心，一直在换医院工作。起初艾琳自己一个人去看房子，好房子当然价格也昂贵，后来康奈尔也陪她去看房，这样又过去几年，艾琳遇上了一个房子很大的价格又不贵的地方，不过有一些瑕疵，地下室被水淹过，有的房间墙皮脱落。不过艾琳接受了，表示埃德有很强的动手能力，会摆平一切的。后来艾琳把原来的房子卖给了印度人，之前房东已经去世了，他的家庭成员也无法将房子重新买回来。</p><p>买了房子艾琳觉离梦想中的生活更近了一步，埃德倔强的不要任何人插手修缮房屋的事情，最后艾琳忍受不了如此低的修缮速度，请工人来修理，艾琳怀疑工人偷走了埃德的修理工具，但是并没有去询问他们，而是买了新的工具放回了原处。</p><p>有天晚上，学生抱怨埃德把他们的分数弄错了，埃德工作到深夜，艾琳发现埃德在把卷子上的分数抄到成绩单时出现了问题，起初并没有十分在意，而是一个读，一个抄，默契的完成了这项工作，后来艾琳独自帮他完成工作。艾琳发现了埃德的变化，医生确认是老年痴呆，目前没有有效的治疗手段，有些临床试用药或许可以提供帮助。他们瞒着康奈尔，瞒着朋友，但是最终还是有暴露的一天。他们举办了大型的party，埃德亲自说了自己患病的情况，艾琳向朋友打电话寻求安慰，时间久了之后，朋友们都不怎么关心埃德的病情。</p><p>埃德记忆力退化的厉害，已经不能继续做一个合格的老师了，但是还没到退休的年龄，就这样又坚持了一年，退休了艾琳才发现埃德参加工作没有满30年，还是没能如愿的让埃德获得高额的退休金，起初埃德在家里，每天都在看一个电视台，康奈尔大学假期回来照顾父亲的时候，总是自己偷偷溜到街上玩，不能陪在他父亲身边，后来康奈尔宁愿打工也不愿意回家。艾琳请了几个护工来那个，都不是很令人满意。</p><p>最后请了一个男护工，他总是把埃德照顾的很好，后来艾琳被朋友引荐去参加了几次充满迷信的心里治疗，艾琳自然是不相信那些胡言乱语的，单她很享受一个人独自放空的那份轻松。艾琳将埃德送到了疗养院，康奈尔与男护工去城堡里将艾琳带回来，不让他的妈妈继续受骗了。</p><p>康奈尔没能顺利完成学业，没有与家里人说。他在之前打工的地方留了下来，做着一份打杂的活，并辅导老板儿子功课。埃德去死了，康奈尔没能见到父亲最后一面，他懊恼。听取母亲将学位证重新学习拿了回来，最后他感觉自己做个老师也不错，后来他发现自己记忆力也不好了。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;《We Are Not Ourselves》被翻译《不属于我们的世纪》，或许翻译成《身不由己》更好点，谁知道呢。读书之间发生了很多事，跨度有点长，先前读的已经记不真切了，但还是想写点什么，读到的更多是欲望与不满，或许自己正处于这样一个阶段，也是在算不上一个淡泊名利的人。&lt;/p&gt;
    
    </summary>
    
      <category term="闲情逸致" scheme="http://iayun.vip/categories/%E9%97%B2%E6%83%85%E9%80%B8%E8%87%B4/"/>
    
    
      <category term="《We Are Not Ourselves》" scheme="http://iayun.vip/tags/%E3%80%8AWe-Are-Not-Ourselves%E3%80%8B/"/>
    
      <category term="《不属于我们的世纪》" scheme="http://iayun.vip/tags/%E3%80%8A%E4%B8%8D%E5%B1%9E%E4%BA%8E%E6%88%91%E4%BB%AC%E7%9A%84%E4%B8%96%E7%BA%AA%E3%80%8B/"/>
    
  </entry>
  
  <entry>
    <title>Windows用脚本复制文件</title>
    <link href="http://iayun.vip/Windows%E7%94%A8%E8%84%9A%E6%9C%AC%E5%A4%8D%E5%88%B6%E6%96%87%E4%BB%B6.html"/>
    <id>http://iayun.vip/Windows用脚本复制文件.html</id>
    <published>2018-10-28T14:00:00.000Z</published>
    <updated>2019-04-21T04:34:06.219Z</updated>
    
    <content type="html"><![CDATA[<h3 id="简单实用的脚本"><a href="#简单实用的脚本" class="headerlink" title="简单实用的脚本"></a>简单实用的脚本</h3><p>xcopy.bat文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">echo &quot;backup iayun &quot;</span><br><span class="line">echo.</span><br><span class="line">xcopy D:\hexo\iayun\*.* E:\Evan\iayun\ /s /e /c /y /h /r</span><br><span class="line">pause</span><br></pre></td></tr></table></figure></p><p>将以上命令写入其中。只需要更改路径就可以使用了。<br><a id="more"></a></p><h3 id="百度百科的Xcopy介绍"><a href="#百度百科的Xcopy介绍" class="headerlink" title="百度百科的Xcopy介绍"></a>百度百科的Xcopy介绍</h3><p>XCOPY是COPY的扩展，可以把指定的目录连文件和目录结构一并拷贝，但不能拷贝系统文件；使用时源盘符、源目标路径名、源文件名至少指定一个；选用/S时对源目录下及其子目录下的所有文件进行COPY。除非指定/E参数，否则/S不会拷贝空目录，若不指定/S参数，则XCOPY只拷贝源目录本身的文件，而不涉及其下的子目录；选用/V参数时，对拷贝的扇区都进行较验，但速度会降低。</p><h3 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">XCOPY source [destination] [/A | /M] [/D[:date]] [/P] [/S [/E]] [/V] [/W]</span><br><span class="line">[/C] [/Q] [/F] [/L] [/G] [/H] [/R] [/T] [/U]</span><br><span class="line">[/K] [/N] [/O] [/X] [/Y] [/-Y] [/Z]</span><br><span class="line">[/EXCLUDE:file1[+file2][+file3]...]</span><br></pre></td></tr></table></figure><h3 id="参数详情"><a href="#参数详情" class="headerlink" title="参数详情"></a>参数详情</h3><table><thead><tr><th>目录</th><th>简介</th></tr></thead><tbody><tr><td>Source</td><td>必需的。指定要复制的文件的位置和名称。该参数必须包含驱动器或路径。</td></tr><tr><td>Destination</td><td>指定要复制的文件的目标。该参数可以包含驱动器盘符和冒号、目录名、文件名或者它们的组合。</td></tr><tr><td>/w</td><td>在开始复制文件之前将显示以下消息并等待您的响应。</td></tr><tr><td>/p</td><td>提示您确认是否要创建每个目标文件。</td></tr><tr><td>/c</td><td>忽略错误。</td></tr><tr><td>/v</td><td>在写入目标文件时验证每个文件，以确保目标文件与源文件完全相同。</td></tr><tr><td>/q</td><td>禁止显示 xcopy 消息。</td></tr><tr><td>/f</td><td>复制时显示源文件名和目标文件名。</td></tr><tr><td>/l</td><td>显示要复制的文件列表。</td></tr><tr><td>/g</td><td>创建解密的目标文件。</td></tr><tr><td>/d[:mm-dd-yyyy]</td><td>只复制那些在指定日期或指定日期之后更改过的源文件。如果不包括 mm-dd-yyyy 值，xcopy 会复制比现有 Destination 文件新的所有 Source 文件。该命令行选项使您可以更新更改过的文件。</td></tr><tr><td>/u</td><td>只从 source 复制 destination 中已有的文件。</td></tr><tr><td>/i</td><td>如果 Source 是一个目录或包含通配符，而 Destination 不存在，xcopy 会假定destination 指定目录名并创建一个新目录。然后，xcopy 会将所有指定文件复制到新目录中。默认情况下，xcopy 将提示您指定 destination 是文件还是目录。</td></tr><tr><td>/s</td><td>复制非空的目录和子目录。如果省略 /s，xcopy 将在一个目录中工作。</td></tr><tr><td>/e</td><td>复制所有子目录，包括空目录。同时使用 /e、/s 和 /t 命令行选项。</td></tr><tr><td>/k</td><td>复制文件，如果源文件具有只读属性，则在目标文件中保留该属性。默认情况下，xcopy 会删除只读属性。</td></tr><tr><td>/r</td><td>复制只读文件。</td></tr><tr><td>/h</td><td>复制具有隐藏和系统文件属性的文件。默认情况下，xcopy 不复制隐藏或系统文件。</td></tr><tr><td>/a</td><td>只复制那些具有存档文件属性设置的源文件。/a 不修改源文件的存档文件属性。</td></tr><tr><td>/m</td><td>复制具有存档文件属性设置的源文件。与 /a 不同，/m 关闭在源中指定的文件的存档文件属性。</td></tr><tr><td>/n</td><td>使用 NTFS 短文件或目录名创建副本。将文件或目录从 NTFS 卷复制到 FAT 卷或者当目标文件系统需要 FAT 文件系统命名约定（即 8.3 个字符）时，需要 /n。目标文件系统可以是 FAT 或 NTFS。</td></tr><tr><td>/o</td><td>复制文件所有权与自由选择的访问控制列表(DACL) 信息。</td></tr><tr><td>/x</td><td>复制文件审核设置和系统访问控制列表(SACL) 信息（包含 /o）。</td></tr><tr><td>/exclude:filename1 [+[filename2]] [+[filename3]]</td><td>指定包含字符串的文件列表。</td></tr><tr><td>/y</td><td>禁止提示您确认要覆盖现存的目标文件。</td></tr><tr><td>/-y</td><td>提示您确认要覆盖现有目标文件。</td></tr><tr><td>/z</td><td>在可重启模式中通过网络复制。</td></tr><tr><td>/?</td><td>在命令提示符显示帮助。</td></tr><tr><td>/t</td><td>只复制子目录结构（即目录树），不复制文件。要复制空目录，必须包含 /e 命令行选项</td></tr></tbody></table><h3 id="退出码"><a href="#退出码" class="headerlink" title="退出码"></a>退出码</h3><p>0 文件复制没有错误。<br>1 没有找到要复制的文件。<br>2 用户按 CTRL+C 终止了 xcopy。<br>4 出现了初始化错误。没有足够的内存或磁盘空间，或命令行上输入了无效的驱动器名称或语法。<br>5 出现了磁盘写入错误。</p><h3 id="范例"><a href="#范例" class="headerlink" title="范例"></a>范例</h3><p>1.要从驱动器A 将所有文件和子目录（包括所有空的子目录）复制到驱动器 B，请键入：</p><blockquote><p>copy a: b: /e</p></blockquote><p>2.要包含上一示例中的任何系统或隐藏文件，请按如下所示添加 /h 命令行选项：</p><blockquote><p>xcopy a: b: /s /e /h</p></blockquote><p>3.要使用 \Rawdata 目录中 1993 年 12 月 29 日后更改的文件更新 \Reports 目录中的文件，请键入：</p><blockquote><p>xcopy \rawdata \reports /d:10-30-2018</p></blockquote><p>4.要更新上例中 \Reports 中存在的所有文件，而不考虑日期，请键入：</p><blockquote><p>xcopy \rawdata \reports /u</p></blockquote><p>5.如果只想获得前一个命令要复制的文件列表，而不复制文件，请键入：</p><blockquote><p>xcopy \rawdata \reports /d:10-29-2018 /l &gt; xcopy.out</p></blockquote><p>文件 Xcopy.out 列出了要复制的所有文件。</p><p>6.要将 \Customer 目录和所有子目录复制到网络驱动器H: 上的目录 \Public\Address，保留只读属性，并在 H: 上创建新文件时对您做出提示，请键入：</p><blockquote><p>xcopy \customer h:\public\address /s /e /k /p</p></blockquote><p>7.要发出上一个命令，确保在 \Address 目录不存在时 xcopy 会创建该目录，同时应抑制显示创建新目录时要显示的消息，请按如下所示添加 /i 命令行选项：</p><blockquote><p>xcopy \customer h:\public\address /s /e /k /p /i</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;简单实用的脚本&quot;&gt;&lt;a href=&quot;#简单实用的脚本&quot; class=&quot;headerlink&quot; title=&quot;简单实用的脚本&quot;&gt;&lt;/a&gt;简单实用的脚本&lt;/h3&gt;&lt;p&gt;xcopy.bat文件&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;@echo off&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;echo &amp;quot;backup iayun &amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;echo.&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;xcopy D:\hexo\iayun\*.* E:\Evan\iayun\ /s /e /c /y /h /r&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pause&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;将以上命令写入其中。只需要更改路径就可以使用了。&lt;br&gt;
    
    </summary>
    
      <category term="Windows总结" scheme="http://iayun.vip/categories/Windows%E6%80%BB%E7%BB%93/"/>
    
    
      <category term=".bat" scheme="http://iayun.vip/tags/bat/"/>
    
  </entry>
  
  <entry>
    <title>Windows用脚本收集文件夹下文件名</title>
    <link href="http://iayun.vip/Windows%E7%94%A8%E8%84%9A%E6%9C%AC%E6%94%B6%E9%9B%86%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%8B%E6%96%87%E4%BB%B6%E5%90%8D.html"/>
    <id>http://iayun.vip/Windows用脚本收集文件夹下文件名.html</id>
    <published>2018-10-22T12:00:00.000Z</published>
    <updated>2019-04-21T04:33:55.035Z</updated>
    
    <content type="html"><![CDATA[<h3 id="简单实用的脚本"><a href="#简单实用的脚本" class="headerlink" title="简单实用的脚本"></a>简单实用的脚本</h3><p>新建list.bat文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">dir /b /on &gt;list.txt</span><br></pre></td></tr></table></figure></p><p>将以上命令写入其中。将list.bat文件放在你想收集文件名的文件夹下，双击执行，在文件下会生成一个list.txt文件，里面有你想要的文件名，额外包括list.bat、list.txt整两个文件名。<br><a id="more"></a></p><h3 id="百度百科的dir介绍"><a href="#百度百科的dir介绍" class="headerlink" title="百度百科的dir介绍"></a>百度百科的dir介绍</h3><p>DIR，是directory的缩写，是目录的意思。DIR也是DOS操作系统用来查看磁盘中文件的。命令dir有很多的参数，这是在windowsXP中的参数以及说明，也可能是Macromedia Director MX产生的文件。</p><h3 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DIR [drive:][path][filename] [/A[[:]attributes]] [/C] [/D] [/L] [/N]</span><br><span class="line">[/O[[:]sortorder]] [/P] [/Q] [/S] [/T[[:]timefield]] [/W] [/X] [/4]</span><br></pre></td></tr></table></figure><table><thead><tr><th>目录</th><th>简介</th></tr></thead><tbody><tr><td>[drive:][path][filename]</td><td>路径,指定要列出的驱动器、目录和/或文件。</td></tr><tr><td>/A</td><td>显示具有指定属性的文件。</td></tr><tr><td>attributes</td><td></td></tr><tr><td>D</td><td>目录</td></tr><tr><td>R</td><td>只读文件</td></tr><tr><td>H</td><td>隐藏文件</td></tr><tr><td>A</td><td>准备存档的文件</td></tr><tr><td>S</td><td>系统文件</td></tr><tr><td>-</td><td>表示“否”的前缀</td></tr><tr><td>/B</td><td>使用空格式(没有标题信息或摘要)。</td></tr><tr><td>/C</td><td>在文件大小中显示千位数分隔符。这是默认值。用 /-C 来停用分隔符显示。</td></tr><tr><td>/D</td><td>跟宽式相同，但文件是按栏分类列出的。</td></tr><tr><td>/L</td><td>用小写。</td></tr><tr><td>/N</td><td>新的长列表格式，其中文件名在最右边。</td></tr><tr><td>/O</td><td>用分类顺序列出文件。</td></tr><tr><td>sortorder</td><td></td></tr><tr><td>N</td><td>按名称(字母顺序)</td></tr><tr><td>S</td><td>按大小(从小到大)</td></tr><tr><td>E</td><td>按扩展名(字母顺序)</td></tr><tr><td>D</td><td>按日期/时间(从先到后)</td></tr><tr><td>G</td><td>组目录优先</td></tr><tr><td>-</td><td>颠倒顺序的前缀</td></tr><tr><td>/P</td><td>在每个信息屏幕后暂停。</td></tr><tr><td>/Q</td><td>显示文件所有者。</td></tr><tr><td>/S</td><td>显示指定目录和所有子目录中的文件。</td></tr><tr><td>/T</td><td>控制显示或用来分类的时间字符域。</td></tr><tr><td>timefield</td></tr><tr><td>C</td><td>创建时间</td></tr><tr><td>A</td><td>上次访问时间</td></tr><tr><td>W</td><td>上次写入的时间</td></tr><tr><td>/W</td><td>用宽列表格式。</td></tr><tr><td>/X</td><td>显示为非 8dot3 文件名产生的短名称。格式是 /N 的格式，短名称插在长名称前面。如果没有短名称，在其位置则显示空白。</td></tr><tr><td>/4</td><td>用四位数字显示年</td></tr><tr><td>/-W。/?</td><td>可以在 DIRCMD 环境变量中预先设定开关。来替代预先设定的开关。例如，/-W。/? 在命令提示符下显示帮助。注释? 使用多个FileName 参数可以使用多个 FileName 参数。用空格、逗号或分号隔开文件名。可以在 FileName 中使用通配符(? 和*)来显示一组文件。</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;简单实用的脚本&quot;&gt;&lt;a href=&quot;#简单实用的脚本&quot; class=&quot;headerlink&quot; title=&quot;简单实用的脚本&quot;&gt;&lt;/a&gt;简单实用的脚本&lt;/h3&gt;&lt;p&gt;新建list.bat文件&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;@echo off&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;dir /b /on &amp;gt;list.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;将以上命令写入其中。将list.bat文件放在你想收集文件名的文件夹下，双击执行，在文件下会生成一个list.txt文件，里面有你想要的文件名，额外包括list.bat、list.txt整两个文件名。&lt;br&gt;
    
    </summary>
    
      <category term="Windows总结" scheme="http://iayun.vip/categories/Windows%E6%80%BB%E7%BB%93/"/>
    
    
      <category term=".bat" scheme="http://iayun.vip/tags/bat/"/>
    
  </entry>
  
  <entry>
    <title>linux下常用的命令</title>
    <link href="http://iayun.vip/linux%E4%B8%8B%E5%B8%B8%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4.html"/>
    <id>http://iayun.vip/linux下常用的命令.html</id>
    <published>2018-10-18T12:02:31.000Z</published>
    <updated>2019-04-21T04:24:44.586Z</updated>
    
    <content type="html"><![CDATA[<p>在使用XShell过程中经常用到的一些命令<br><a id="more"></a></p><p>1.查看服务端口启动</p><blockquote><p>netstat -lntp|grep 6101<br>lsof -i:6101</p></blockquote><p>2.查看日志</p><blockquote><p>view admin6101.log</p></blockquote><p>3.从底部查看日志</p><blockquote><p>tail -f admin6101.log</p></blockquote><p>4.退出查看日志</p><blockquote><p>ctrl + c</p></blockquote><p>5.上传文件（直接从桌面上传）</p><blockquote><p>rz</p></blockquote><p>6.赋予执行权限</p><blockquote><p>chmod u+x weblogic_prod.sh</p></blockquote><p>7.服务重复启动</p><blockquote><p>lock        rm -rf domain/servers/{cache,data,tmp}</p></blockquote><p>8.复制文件<br>file2文件不存在</p><blockquote><p>cp -r file1 file2</p></blockquote><p>file2文件已存在</p><blockquote><p>cp -r file1/. file2</p></blockquote><p>9.移动文件<br>将/usr/udt中的所有文件移到当前目录(用”.”表示)中：</p><blockquote><p>mv /usr/udt/* .</p></blockquote><p>将文件test.txt重命名为wbk.txt：</p><blockquote><p>mv test.txt wbk.txt</p></blockquote><p>把当前目录的一个子目录里的文件移动到另一个子目录里</p><blockquote><p>mv 文件名/* 另一个目录</p></blockquote><p>移动当前文件夹下的所有文件到上一级目录</p><blockquote><p>mv * ../</p></blockquote><p>10.解压命令</p><blockquote><p><em>.tar 用 tar –xvf 解压</em>.gz 用 gzip -d或者gunzip 解压<br><em>.tar.gz和</em>.tgz 用 tar –xzf 解压<br><em>.bz2 用 bzip2 -d或者用bunzip2 解压</em>.tar.bz2用tar –xjf 解压<br><em>.Z 用 uncompress 解压</em>.tar.Z 用tar –xZf 解压<br><em>.rar 用 unrar e解压</em>.zip 用 unzip 解压</p></blockquote><p>11.Linux系统中创建分组、创建用户、设置密码、修改用户、删除用户<br>创建分组</p><blockquote><p>groupadd -g 1000 evan</p></blockquote><p>创建用户testuser</p><blockquote><p>useradd testuser</p></blockquote><p>给已创建的用户testuser设置密码(新创建的用户会在/home下创建一个用户目录testuser)</p><blockquote><p>passwd testuser</p></blockquote><p>移动用户</p><blockquote><p>usermod -a -G evan testuser</p></blockquote><p>修改用户这个命令的相关参数</p><blockquote><p>usermod –help</p></blockquote><p>删除用户testuser</p><blockquote><p>userdel testuser</p></blockquote><p>删除用户testuser所在目录</p><blockquote><p>rm -rf testuser</p></blockquote><p>切换用户的命令为</p><blockquote><p>su username 会使用root的环境变量<br>su - username</p></blockquote><p>从普通用户切换到root用户，还可以使用命令</p><blockquote><p>sudo su</p></blockquote><p>查看用户分组</p><blockquote><p>id username</p></blockquote><p>恢复普通用户权限</p><blockquote><p>chown -R group.username /u05</p></blockquote><p>12.数据库的导入导出<br>建立导出的目录</p><blockquote><p>create directory dmps as ‘/u02/dmps’;</p></blockquote><p>赋权给导出来的用户</p><blockquote><p>grant read,write on directory dmps to system;</p></blockquote><p>在Linux上的服务端执行导出schema</p><blockquote><p>expdp system/manager directory=dmps dumpfile=user_20180928.dmp logfile=user_20180928_exp.log schemas=user</p></blockquote><p>切换用户 进行映射</p><blockquote><p>impdp system/manager directory=dmps dumpfile=user_20180928.dmp logfile=user_20180928_exp.log remap_schema=user:prod</p></blockquote><p>13.寻找</p><blockquote><p>find / -name “<em>mysql</em>“</p></blockquote><p>/代表从选择要模糊查询的目录<br>也可以是其他的 比如user  查找user目录<br>mysql代表要模糊查找的名字<br>14.运行级别</p><blockquote><p>runlevel</p></blockquote><p>15.替换</p><blockquote><p>view<br>:%s#01#02#g</p></blockquote><p>16.给予权限–命令:</p><blockquote><p>chmod 777 web.xml</p></blockquote><p>17.关闭weblogic用户下所有进程</p><blockquote><p>killall -uweblogic java</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在使用XShell过程中经常用到的一些命令&lt;br&gt;
    
    </summary>
    
      <category term="linux总结" scheme="http://iayun.vip/categories/linux%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="linux命令" scheme="http://iayun.vip/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>在服务器下搭建测试环境</title>
    <link href="http://iayun.vip/%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8B%E6%90%AD%E5%BB%BA%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83.html"/>
    <id>http://iayun.vip/在服务器下搭建测试环境.html</id>
    <published>2018-06-15T14:00:00.000Z</published>
    <updated>2019-04-21T04:26:55.905Z</updated>
    
    <content type="html"><![CDATA[<p>在服务器搭建sit测试环境，不经常搭建，偶尔一次就参照这个。<br><a id="more"></a></p><h3 id="安装前的准备"><a href="#安装前的准备" class="headerlink" title="安装前的准备"></a>安装前的准备</h3><h4 id="安装清单"><a href="#安装清单" class="headerlink" title="安装清单"></a>安装清单</h4><table><thead><tr><th>软件</th><th>包名</th><th>备注</th></tr></thead><tbody><tr><td>WebLogic 12cR2</td><td>fmw_12.2.1.3.0_wls_Disk1_1of1.zip</td><td></td></tr><tr><td>Java SE 8</td><td>jdk-8u181-linux-x64.tar.gz</td><td>WebLogic安装需要1.8.0_131以上</td></tr><tr><td>Java SE 6</td><td>jdk-6u21-linux-x64.bin</td><td>应用程序需要JDK1.6</td></tr><tr><td>WebLogic最新补丁</td></tr></tbody></table><h4 id="确认”-etc-hosts”中写入正确的主机名"><a href="#确认”-etc-hosts”中写入正确的主机名" class="headerlink" title="确认”/etc/hosts”中写入正确的主机名"></a>确认”/etc/hosts”中写入正确的主机名</h4><p>这里为appServer22.localdomain<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.0.22 appServer22.localdomain appServer22</span><br></pre></td></tr></table></figure></p><h4 id="创建组和用户"><a href="#创建组和用户" class="headerlink" title="创建组和用户"></a>创建组和用户</h4><blockquote><p>groupadd -g 1000 weblogic<br>useradd -u 1000 -g weblogic weblogic<br>password weblogic</p></blockquote><h4 id="创建目录"><a href="#创建目录" class="headerlink" title="创建目录"></a>创建目录</h4><blockquote><p>mkdir -p /wls/bea/Oracle/Middleware/<br>mkdir –p /wls/webapps<br>mkdir /wls/software/<br>chown -R wlgylis:weblogic /wls/<br>chmod -R 775 /wls/</p></blockquote><h4 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h4><p>用weblogic用户执行</p><blockquote><p>tar -xvf jdk-8u181-linux-x64.tar.gz<br>sh jdk-6u21-linux-x64.bin<br>ln -s jdk1.6.0_21 default</p></blockquote><h4 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h4><p>编辑文件”vi ~/.bash_profile”，在最后追加：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">###For WebLogic</span><br><span class="line">export MW_HOME=/wls/bea/Oracle/Middleware</span><br><span class="line">export WLS_HOME=$MW_HOME/wlserver_10.3</span><br><span class="line">export WL_HOME=$WLS_HOME</span><br><span class="line">export JAVA_HOME=/wls/software/jdk1.6.0_20</span><br><span class="line">export PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line"></span><br><span class="line">##END</span><br></pre></td></tr></table></figure></p><p>使环境变量生效</p><blockquote><p>source ~/.bash_profile</p></blockquote><h3 id="安装WebLogic软件"><a href="#安装WebLogic软件" class="headerlink" title="安装WebLogic软件"></a>安装WebLogic软件</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><blockquote><p>unzip /wls/bea/software/<br>java -Xmx1024m -jar /wls/bea/software/wls1036_generic.jar</p></blockquote><p>根据提示安装。</p><h4 id="查看WebLogic版本"><a href="#查看WebLogic版本" class="headerlink" title="查看WebLogic版本"></a>查看WebLogic版本</h4><blockquote><p>. /wls/bea/Oracle/Middleware/wlserver_10.3/server/bin/setWLSEnv.sh<br>java weblogic.version</p></blockquote><h4 id="给WebLogic打补丁"><a href="#给WebLogic打补丁" class="headerlink" title="给WebLogic打补丁"></a>给WebLogic打补丁</h4><p>在MOS上找到最新的补丁，将补丁数据文件，例如：p20780171_1036_Generic.zip、p22248372_1036012_Generic.zip解压并拷贝到weblogic目录下<br>/wls/bea/Oracle/Middleware/utils/bsu/cache_dir中，<br>如果没有cache_dir 自己创建</p><blockquote><p>mkdir cache_dir<br>unzip p20780171_1036_Generic.zip<br>unzip p22248372_1036012_Generic.zip</p></blockquote><blockquote><p>java -jar /wls/bea/Oracle/Middleware/utils/bsu/patch-client.jar -install -patch_download_dir=/wls/bea/Oracle/Middleware/utils/bsu/cache_dir/ -patchlist=EJUW -prod_dir=/wls/bea/Oracle/Middleware/wlserver_10.3</p></blockquote><blockquote><p>java -jar /wls/bea/Oracle/Middleware/utils/bsu/patch-client.jar -install -patch_download_dir=/wls/bea/Oracle/Middleware/utils/bsu/cache_dir/ -patchlist=ZLNA -prod_dir=/wls/bea/Oracle/Middleware/wlserver_10.3</p></blockquote><p>再次查看WebLogic的版本，版本有可能有发生改变。</p><h3 id="创建域"><a href="#创建域" class="headerlink" title="创建域"></a>创建域</h3><h4 id="设置环境变量-1"><a href="#设置环境变量-1" class="headerlink" title="设置环境变量"></a>设置环境变量</h4><blockquote><p>export CONFIG_JVM_ARGS=’-Djava.security.egd=file:/dev/urandom’<br>. /wls/bea/Oracle/Middleware/wlserver_10.3/server/bin/setWLSEnv.sh</p></blockquote><h4 id="使用config-sh创建域"><a href="#使用config-sh创建域" class="headerlink" title="使用config.sh创建域"></a>使用config.sh创建域</h4><h5 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h5><blockquote><p>. /wls/bea/Oracle/Middleware/wlserver_10.3/common/bin/config.sh</p></blockquote><p>根据提示填写合适的名称、密码、服务名。</p><p>创建成功后，检查用户是否为root，否则，切换到weblogic用户。</p><blockquote><p>su - weblogic</p></blockquote><h5 id="第一次启动域"><a href="#第一次启动域" class="headerlink" title="第一次启动域"></a>第一次启动域</h5><blockquote><p>cd /wls/bea/Oracle/Middleware/user_projects/domains/picchk9001/<br>./startWebLogic.sh</p></blockquote><p>输入前面设置的Name:  weblogic<br>User password:  weblogic8<br>出现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Server state changed to RUNNING mode&gt;</span><br></pre></td></tr></table></figure></p><p>代表域启动成功。按Ctrl+C关闭。</p><h5 id="配置无密码和用户启动"><a href="#配置无密码和用户启动" class="headerlink" title="配置无密码和用户启动"></a>配置无密码和用户启动</h5><p>必须先启动域才会生成servers 目录</p><blockquote><p>cd /wls/bea/Oracle/Middleware/user_projects/domains/picchk9001/servers/server9001<br>mkdir security<br>cd security<br>vi boot.properties</p></blockquote><p>在security下面创建‘boot.properties’文件，内容如下：<br>其中的值为前面设置的Name和User password<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=weblogic</span><br><span class="line">password=weblogic1</span><br></pre></td></tr></table></figure></p><h5 id="免密码启动域"><a href="#免密码启动域" class="headerlink" title="免密码启动域"></a>免密码启动域</h5><blockquote><p>cd /wls/bea/Oracle/Middleware/user_projects/domains/picchk9001<br>nohup ./startWebLogic.sh &gt;nohup.out 2&gt;&amp;1 &amp;</p></blockquote><p>检查nohup.out是否有报错。</p><h5 id="重新安装域"><a href="#重新安装域" class="headerlink" title="重新安装域"></a>重新安装域</h5><p>1.先停止服务<br>2.打开”$MW_HOME/domain-registry.xml” 文件,删除对应的配置。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;domain-registry xmlns=&quot;http://xmlns.oracle.com/weblogic/domain-registry&quot;&gt;</span><br><span class="line">  &lt;domain location=&quot;/u01/app/oracle/middleware/user_projects/domains/picchk9001&quot;/&gt;</span><br><span class="line">&lt;/domain-registry&gt;</span><br></pre></td></tr></table></figure></p><p>3.打开”$WLS_HOME/common/nodemanager/nodemanager.domains”文件。删除对应配置。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#Domains and directories created by Configuration Wizard</span><br><span class="line">#Thu Aug 23 22:53:14 BST 2012</span><br><span class="line">picchk9001=/u01/app/oracle/middleware/user_projects/domains/picchk9001</span><br><span class="line">Delete the &quot;testDomain&quot; application and domain directories.</span><br></pre></td></tr></table></figure></p><p>4.清空对应的目录下的所有文件</p><blockquote><p>$ rm -Rf $MW_HOME/user_projects/applications/picchk9001<br>$ rm -Rf $MW_HOME/user_projects/domains/picchk9001</p></blockquote><h4 id="建立其它域"><a href="#建立其它域" class="headerlink" title="建立其它域"></a>建立其它域</h4><h3 id="部署项目"><a href="#部署项目" class="headerlink" title="部署项目"></a>部署项目</h3><h4 id="配置数据源"><a href="#配置数据源" class="headerlink" title="配置数据源"></a>配置数据源</h4><p>进入WebLogic控制台：‘<a href="http://IP:9001/console’" target="_blank" rel="noopener">http://IP:9001/console’</a></p><h4 id="部署程序"><a href="#部署程序" class="headerlink" title="部署程序"></a>部署程序</h4><h4 id="解決啟動報錯（jar包沖突）"><a href="#解決啟動報錯（jar包沖突）" class="headerlink" title="解決啟動報錯（jar包沖突）"></a>解決啟動報錯（jar包沖突）</h4><p>复制应用中的jar包到modules下</p><blockquote><p>cp /wls/webapps/8002/webapps/WEB-INF/lib/hibernate-jpa-2.0-api-1.0.1.Final.jar /wls/bea/Oracle/Middleware/modules</p></blockquote><p>编辑/wls/bea/Oracle/Middleware/wlserver_10.3/common/bin/commEnv.sh<br>在文件顶部添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wls_modules=&quot;/wls/bea/Oracle/Middleware/modules&quot;</span><br><span class="line">export PRE_CLASSPATH=&quot;$&#123;wls_modules&#125;/hibernate-jpa-2.0-api-1.0.1.Final.jar&quot;</span><br></pre></td></tr></table></figure></p><h4 id="安装字体"><a href="#安装字体" class="headerlink" title="安装字体"></a>安装字体</h4><p>用root用户，执行下面命令</p><blockquote><p>cd $JAVA_HOME/jre/lib/fonts<br>mkdir fallback</p></blockquote><p>复制字体到下列目录<br>$JAVA_HOME/jre/lib/fonts/fallback</p><blockquote><p>cd fallback<br>mkfontscale<br>mkfontdir</p></blockquote><p>重新启动服务器。</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在服务器搭建sit测试环境，不经常搭建，偶尔一次就参照这个。&lt;br&gt;
    
    </summary>
    
      <category term="linux总结" scheme="http://iayun.vip/categories/linux%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="Weblogic" scheme="http://iayun.vip/tags/Weblogic/"/>
    
      <category term="linux" scheme="http://iayun.vip/tags/linux/"/>
    
      <category term="sit" scheme="http://iayun.vip/tags/sit/"/>
    
  </entry>
  
  <entry>
    <title>J2EE从零搭建开发环境</title>
    <link href="http://iayun.vip/J2EE%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83.html"/>
    <id>http://iayun.vip/J2EE从零搭建开发环境.html</id>
    <published>2018-06-08T14:00:00.000Z</published>
    <updated>2019-04-21T04:17:05.960Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a><center>前言</center></h3><p>写在前面，记录一下搭建开发环境的常用步骤，虽然网上也有很多更详细的教程，但是不够全面，要去找很多才能搭建成功，收藏的链接也会失效，也不保证我的教程适用于所有人，仅供参考。以后也许还会不断的完善这份教程。在安装的过程中，我省略了一些路径的详细信息，大家按照自己的实际路径设置即可，实在没必要与我一模一样。一些参数更是如此。欢迎大家留言指教。<br><a id="more"></a></p><h3 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h3><p>Oracle JDK8<a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">官网下载地址</a>，其他的版本也在里面，下载首先注册一个Oracle账号。</p><h3 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h3><p>在我的电脑高级设置里配置如下环境变量。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME       Program\JDK\jdk1.6.0_10</span><br><span class="line">CLASSPATH       .;%JAVA_HOME%\lib\tools.jar;%JAVA_HOME%\lib\dt.jar</span><br><span class="line">Path            ;%JAVA_HOME%\bin;</span><br></pre></td></tr></table></figure></p><p>也可以直接配置绝对路径，但建议使用%JAVA_HOME%的方式。至此JDK的配置也完成，打开一个命令行窗口，输入</p><blockquote><p>set CLASSPATH</p></blockquote><blockquote><p>set JAVA_HOME</p></blockquote><p>应该可以看到正确的配置信息。同时，输入</p><blockquote><p>java -version</p></blockquote><p>看系统能否找到JAVA 的版本号。显示下图所示，代表配置成功<br><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%831.png" alt="1"></p><h3 id="安装weblogic"><a href="#安装weblogic" class="headerlink" title="安装weblogic"></a>安装weblogic</h3><p>安装Weblogic时，有最低JDK版本的要求，最新版本的Weblogic12.2.1.3服务器要求必须是JDK8及以上。<br>这里安装的是10.3.5版本，点击安装，可能防火墙会阻挡下，允许通过就行</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%835.png" alt="5"><br>点击下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%836.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%837.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%838.png" alt="8"><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%839.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8310.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8311.png" alt="11"><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8312.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8313.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8314.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8315.png" alt=""><br>等待安装完成</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8316.png" alt="16"><br>安装完成了</p><h3 id="安装SVN客户端"><a href="#安装SVN客户端" class="headerlink" title="安装SVN客户端"></a>安装SVN客户端</h3><p>SVN安装就是傻瓜式安装,除了安装路径自己设置以外，其余都点击Next即可。</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8317.png" alt=""><br>点击next</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8318.png" alt=""><br>点击next</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8319.png" alt=""><br>更改好安装路径</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8320.png" alt=""><br>点击Install</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8321.png" alt="21"><br>等待安装，如被防火墙阻挡了，放行即可。</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8322.png" alt=""><br>安装完成。在桌面点击右键就会发现SVN的相关标志——小乌龟。</p><h3 id="部署项目"><a href="#部署项目" class="headerlink" title="部署项目"></a>部署项目</h3><h4 id="搞定工作空间"><a href="#搞定工作空间" class="headerlink" title="搞定工作空间"></a>搞定工作空间</h4><p>将项目代码用SVN工具Check out项目到本地，将项目导入到工作空间中，也可以在工作空间直接安装SVN插件进行Check out，maven项目需要下载jar包，普通项目将ja rRemove掉，然后重新build path,注意编码是GBK还是utf-8,等待编译完成，然后看是否报错。<br>工作空间Preferences，java选项下Compiler可以设置代码的编译版本，Installed JREs可以选择使用的jre版本。<br>要注意编译使用的jdk版本与部署使用的jdk版本是否一致，jdk是向下兼容的，低版本jdk编译后的代码可以在高版本上正常运行，反之，则不可以。<br>以下是我Eclipse同级目录下 eclipse.ini 文件的配置信息。结合项目大小和自己内存大小设置参数。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">-startup</span><br><span class="line">plugins/org.eclipse.equinox.launcher_1.5.0.v20180512-1130.jar</span><br><span class="line">--launcher.library</span><br><span class="line">C:/Users/Administrator/.p2/pool/plugins/org.eclipse.equinox.launcher.win32.win32.x86_64_1.1.700.v20180518-1200</span><br><span class="line">-product</span><br><span class="line">org.eclipse.epp.package.jee.product</span><br><span class="line">-showsplash</span><br><span class="line">org.eclipse.epp.package.common</span><br><span class="line">--launcher.defaultAction</span><br><span class="line">openFile</span><br><span class="line">-vm</span><br><span class="line">F:\MyTool\jdks\jre1.8\bin\server\jvm.dll</span><br><span class="line">--launcher.appendVmargs</span><br><span class="line">-vmargs</span><br><span class="line">-Dosgi.requiredJavaVersion=1.8</span><br><span class="line">-Dosgi.instance.area.default=@user.home/eclipse-workspace</span><br><span class="line">-XX:+UseG1GC</span><br><span class="line">-XX:+UseStringDeduplication</span><br><span class="line">--add-modules=ALL-SYSTEM</span><br><span class="line">-Dosgi.requiredJavaVersion=1.8</span><br><span class="line">-Dosgi.dataAreaRequiresExplicitInit=true</span><br><span class="line">-Xms512m</span><br><span class="line">-Xmx2048m</span><br><span class="line">--add-modules=ALL-SYSTEM</span><br><span class="line">-Declipse.p2.max.threads=10</span><br><span class="line">-Doomph.update.url=http://download.eclipse.org/oomph/updates/milestone/latest</span><br><span class="line">-Doomph.redirection.index.redirection=index:/-&gt;http://git.eclipse.org/c/oomph/org.eclipse.oomph.git/plain/setups/</span><br><span class="line">-Dsun.lang.ClassLoader.allowArraySyntax=true</span><br><span class="line"></span><br><span class="line">-Xmn256m</span><br><span class="line"></span><br><span class="line">-XX:PermSize=256m</span><br><span class="line">-XX:MaxPermSize=512m</span><br><span class="line"></span><br><span class="line">-Xloggc:F:\MyTool\Eclipse\eclipse\gc.log</span><br><span class="line">-XX:+PrintGCTimeStamps</span><br><span class="line">-XX:+PrintGCDetails</span><br></pre></td></tr></table></figure></p><h4 id="搞定服务器"><a href="#搞定服务器" class="headerlink" title="搞定服务器"></a>搞定服务器</h4><p>代码运行要使用服务器，Tomcat与Weblogicd都可以。我使用的是Tomcat7，需要在server.xml中的<host></host>标签里配置数据源<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;Context docBase=&quot;E:\Source\DEV\application\modules\webapps&quot; path=&quot;/&quot; reloadable=&quot;false&quot;&gt;</span><br><span class="line">  &lt;Resource auth=&quot;Container&quot;</span><br><span class="line">            driverClassName=&quot;oracle.jdbc.driver.OracleDriver&quot; logAbandoned=&quot;true&quot;</span><br><span class="line">            maxActive=&quot;50&quot;</span><br><span class="line">            maxIdle=&quot;30&quot;</span><br><span class="line">            maxWait=&quot;10000&quot;</span><br><span class="line">            name=&quot;iayunoDataSource&quot;</span><br><span class="line">            password=&quot;404&quot;</span><br><span class="line">            type=&quot;javax.sql.DataSource&quot; url=&quot;jdbc:oracle:thin:@192.168.0.22:1521:iayun&quot; username=&quot;hxuser&quot;/&gt;</span><br><span class="line">&lt;/Context&gt;</span><br></pre></td></tr></table></figure></p><p>在Arguments下配置参数</p><blockquote><p>-XX:MaxPermSize=256m</p></blockquote><p>这个参数过小会导致内存溢出<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.OutOfMemoryError: PermGen space</span><br></pre></td></tr></table></figure></p><p>使用weblogic服务器就比较麻烦了，但是他的功能也十分强大。首先找到weblogic的安装路径，在weblogic\wlserver_10.3\common\bin下，然后点击config.cmd，可能的等待的时间比较长<br><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8323.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8324.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8325.png" alt=""><br>这里域名称要自己写，最好加上自己要设置的端口号，这样部署多个项目时不容易混淆。下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8326.png" alt="26"><br>用户名和密码，建议设为weblogic/weblogic8,这样不容易忘记。下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8327.png" alt=""><br>选择默认的JDK。下一步  </p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8328.png" alt=""><br>选择管理服务器。下一步  </p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8329.png" alt=""><br>这里填上你刚才在域名里准备的端口7001</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8330.png" alt=""><br>创建</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8331.png" alt="31"><br>完成</p><h4 id="搞定数据源"><a href="#搞定数据源" class="headerlink" title="搞定数据源"></a>搞定数据源</h4><p>先要启动domain进入E:\Program\weblogic\user_projects\domains\yl7001\bin目录下，点击startWebLogic.cmd运行，进入控制台，等待出现RUNNING mode</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8332.png" alt=""><br>在浏览器输入<a href="http://localhost:7001/console" target="_blank" rel="noopener">http://localhost:7001/console</a><br>输入上面设置的账户密码 weblogic、weblogic8<br>配置数据源</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8333.png" alt=""><br>填写数据源的名称</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/InkedJ2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8334_LI.jpg" alt=""><br>名称最好保持一致。JNDI名称在代码里面会有对应的配置信息去读去。下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8335.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8336.png" alt="36"><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/InkedJ2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8337_LI.jpg" alt=""><br>这里填写对应数据库的信息。下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8338.png" alt=""><br>进行测试配置</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8339.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8340.png" alt=""><br>完成</p><h4 id="搞定代码"><a href="#搞定代码" class="headerlink" title="搞定代码"></a>搞定代码</h4><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8341.png" alt="41"><br>点击部署，开始安装</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/InkedJ2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8342_LI.jpg" alt=""><br>找到程序路径</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8343.png" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/InkedJ2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8344_LI.jpg" alt=""><br>下一步</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/InkedJ2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8345_LI.jpg" alt=""><br>需要耐心等待。完成</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8346.png" alt="46"><br>保存</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8348.png" alt="48"><br>为所有请求停供服务</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8349.png" alt=""><br>出现这个状态还是有问题的，再重新启动下，会出现报错信息</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8350.png" alt=""><br><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8351.png" alt="51"><br>startWebLogic.cmd里也会有详细的日志信息<br>根据提示表明内存太小，所以我们需要加大内存<br>进入weblogic\user_projects\domains\yl7001\bin目录下，编辑setDomainEnv.cmd文件,适当加大</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8352.png" alt=""><br>修改成</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8353.png" alt=""><br>在cmd窗口Ctrl + C，关闭weblogic服务器，也可以通过stopWeblogic.cmd关闭服务器。然后重新启动服务</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8354.png" alt=""><br>启动完成后，再进入控制台查看</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8355.png" alt=""><br>这种状态才是成功的。</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8356.png" alt="56"><br>其实cmd中的启动时的日志信息我们可以从<br>weblogic\user_projects\domains\yl7001\servers\AdminServer\logs\下<br>日志中查看的，没有报错，状态显示活动代表部署项目成功了，我们可以进入服务了。<br>在浏览器中输入项目的URL：<a href="http://localhost:7001" target="_blank" rel="noopener">http://localhost:7001</a></p><h3 id="安装Oracle客户端"><a href="#安装Oracle客户端" class="headerlink" title="安装Oracle客户端"></a>安装Oracle客户端</h3><h4 id="找到适合的版本"><a href="#找到适合的版本" class="headerlink" title="找到适合的版本"></a>找到适合的版本</h4><h4 id="配置监听文件"><a href="#配置监听文件" class="headerlink" title="配置监听文件"></a>配置监听文件</h4><p>在对应安装路径下oracleClient\Instant Client\network\admin\tnsnames.ora<br>内容如下，注意要注意格式，Oracle对这个有严格的要求。在更改这个文件后，保存时可能会出现权限不足，建议用Notepad++记事本工具打开，保存时给予权限保存即可。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">test =</span><br><span class="line">  (DESCRIPTION =</span><br><span class="line">    (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.0.88)(PORT = 1521))</span><br><span class="line">    (CONNECT_DATA =</span><br><span class="line">      (SERVER = DEDICATED)</span><br><span class="line">      (SERVICE_NAME = test)</span><br><span class="line">    )</span><br><span class="line">  )</span><br></pre></td></tr></table></figure></p><p>以后如果还要连接其它数据库，添加在文件下面就可以.</p><h4 id="配置Oracle环境变量"><a href="#配置Oracle环境变量" class="headerlink" title="配置Oracle环境变量"></a>配置Oracle环境变量</h4><p>在电脑高级设置中配置环境变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ORACLE_HOME    Program\oracleClient\Instant Client</span><br></pre></td></tr></table></figure></p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8357.png" alt=""><br>在path后面添加，注意用;分割多个变量。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Path   %ORACLE_HOME%\bin</span><br></pre></td></tr></table></figure></p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8358.png" alt=""><br>打开cmd窗口，输入</p><blockquote><p>sqlplus / as sysdba</p></blockquote><p>测试看有没有成功</p><h3 id="安装PL-SQL-develop开发工具"><a href="#安装PL-SQL-develop开发工具" class="headerlink" title="安装PL/SQL develop开发工具"></a>安装PL/SQL develop开发工具</h3><h4 id="找到合适的版本"><a href="#找到合适的版本" class="headerlink" title="找到合适的版本"></a>找到合适的版本</h4><h4 id="配置字符集"><a href="#配置字符集" class="headerlink" title="配置字符集"></a>配置字符集</h4><p>解压即可使用，登陆中如果发现这个<br><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8360.png" alt=""><br>出现这个代表客户端的字符集没有安装,我们可以查看数据库采用的字符集,在数据库下cmd窗口输入</p><blockquote><p>select userenv(‘language’) from dual;</p></blockquote><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8361.png" alt="61"><br>然后写到环境变量中</p><p><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/J2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8362.png" alt=""><br>启动就正常了。<br>全部环境就已经搭建完成了，有问题要先学会自己思考。</p><h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><p>1、如果出现这个<br><img src="http://iayun.oss-cn-hangzhou.aliyuncs.com/%E6%95%99%E7%A8%8B/j2ee%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/InkedJ2EE%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%8347_LI.jpg" alt="47"><br>数据源名字不对，需要重新配置数据源。<br>2、如果有中文乱码，在项目代码编译后，启动服务器前将application\modules\component\resources路径下的.cmd脚本文件执行一下，这样就可以解决乱码问题。<br>3、weblogic服务器插件可以安装在Eclipse等开发工具中。<br>4、非正常结束weblogic进程导致weblogic无法启动。由于先前服务器直接down掉了，所有进程都非正常的进行关闭了，也就导致了下次启动weblogic的时候报了以下错误：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;2017-10-2 下午05时08分34秒 CST&gt; &lt;Info&gt; &lt;Management&gt; &lt;BEA-141281&gt; &lt;unable to get file lock, will retry …&gt;</span><br><span class="line">&lt;2017-10-2 下午05时08分44秒 CST&gt; &lt;Info&gt; &lt;Management&gt; &lt;BEA-141281&gt; &lt;unable to get file lock, will retry …&gt;</span><br></pre></td></tr></table></figure></p><p>可以在cmd窗口，先根据端口号查看进程</p><blockquote><p>netstat -aon|findstr “7001”</p></blockquote><p>将进程关闭</p><blockquote><p>taskkill /pid 48768 /F</p></blockquote><p>然后重新启动。</p><p>5、如果启动项目出现以下错误信息<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">org.springframework.orm.hibernate3.HibernateQueryException: ClassNotFoundException:</span><br><span class="line">org.hibernate.hql.ast.HqlToken [delete from com.sinosoft.application.prpall.dto.domain.GuProposalExchangeDto where 1=1  AND (proposalNo = &apos;U5PAR000010142017&apos;) ]; nested exception is</span><br><span class="line">org.hibernate.QueryException: ClassNotFoundException:</span><br></pre></td></tr></table></figure></p><p>将项目路径    \SourceCode\application-2B\modules\webapps\WEB-INF\lib下的 antlr-2.7.6rc1.jar 复制在weblogic域中路径\WebLogic\user_projects\domains\well8001\lib 路径中，并在\WebLogic\user_projects\domains\well8001\bin\setDomainEnv.cmd文件中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set JAVA_HOME=%JAVA_HOME%</span><br><span class="line">for %%i in (&quot;%JAVA_HOME%&quot;) do set JAVA_HOME=%%~fsi</span><br></pre></td></tr></table></figure></p><p>下添加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set PRE_CLASSPATH=E:\WebLogic\user_projects\domains\well8001\lib\antlr-2.7.6rc1.jar</span><br></pre></td></tr></table></figure></p><p>重新启动即可解决。</p>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;&lt;center&gt;前言&lt;/center&gt;&lt;/h3&gt;&lt;p&gt;写在前面，记录一下搭建开发环境的常用步骤，虽然网上也有很多更详细的教程，但是不够全面，要去找很多才能搭建成功，收藏的链接也会失效，也不保证我的教程适用于所有人，仅供参考。以后也许还会不断的完善这份教程。在安装的过程中，我省略了一些路径的详细信息，大家按照自己的实际路径设置即可，实在没必要与我一模一样。一些参数更是如此。欢迎大家留言指教。&lt;br&gt;
    
    </summary>
    
      <category term="java总结" scheme="http://iayun.vip/categories/java%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="JDK" scheme="http://iayun.vip/tags/JDK/"/>
    
      <category term="Oracle" scheme="http://iayun.vip/tags/Oracle/"/>
    
      <category term="PL/SQL" scheme="http://iayun.vip/tags/PL-SQL/"/>
    
      <category term="Weblogic" scheme="http://iayun.vip/tags/Weblogic/"/>
    
      <category term="Tomcat" scheme="http://iayun.vip/tags/Tomcat/"/>
    
      <category term="J2EE" scheme="http://iayun.vip/tags/J2EE/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://iayun.vip/hello-world.html"/>
    <id>http://iayun.vip/hello-world.html</id>
    <published>2018-05-01T14:16:36.000Z</published>
    <updated>2018-12-15T10:40:34.410Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><a id="more"></a><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;documentation&lt;/a&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;a href=&quot;https://hexo.io/docs/troubleshooting.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;troubleshooting&lt;/a&gt; or you can ask me on &lt;a href=&quot;https://github.com/hexojs/hexo/issues&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>通过URL接受数据</title>
    <link href="http://iayun.vip/%E9%80%9A%E8%BF%87URL%E6%8E%A5%E5%8F%97%E6%95%B0%E6%8D%AE.html"/>
    <id>http://iayun.vip/通过URL接受数据.html</id>
    <published>2018-02-20T14:00:00.000Z</published>
    <updated>2019-04-21T10:12:11.895Z</updated>
    
    <content type="html"><![CDATA[<p>通过RestTemplate访问指定的URL地址接收数据。将图片在界面展示出来。</p><a id="more"></a><h4 id="PictureController-java"><a href="#PictureController-java" class="headerlink" title="PictureController.java"></a>PictureController.java</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.cw.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.LinkedMultiValueMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.MultiValueMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.client.RestTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONArray;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSONObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.cw.util.DateUtil;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/picture"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PictureController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Value</span>(<span class="string">"$&#123;cma.history.pictureUrl&#125;"</span>) </span><br><span class="line"><span class="keyword">private</span> String url;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/index.do"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"biz/picture"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/getPicture.do"</span>)</span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPicture</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">String id = request.getParameter(<span class="string">"terminalId"</span>);</span><br><span class="line">    String begin = request.getParameter(<span class="string">"begin"</span>);</span><br><span class="line">    String end = request.getParameter(<span class="string">"end"</span>);</span><br><span class="line">    </span><br><span class="line">        JSONObject resultJson = <span class="keyword">new</span> JSONObject();</span><br><span class="line">        List&lt;Object&gt; data  = <span class="keyword">new</span> ArrayList&lt;Object&gt;();</span><br><span class="line">    RestTemplate restTemplate = <span class="keyword">new</span> RestTemplate();</span><br><span class="line">MultiValueMap&lt;String, String&gt; requestEntity = <span class="keyword">new</span> LinkedMultiValueMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">requestEntity.add(<span class="string">"id"</span>, id);</span><br><span class="line">requestEntity.add(<span class="string">"begin"</span>, begin);</span><br><span class="line">requestEntity.add(<span class="string">"end"</span>, end);</span><br><span class="line">String response = restTemplate.postForObject(url, requestEntity, String.class);</span><br><span class="line"></span><br><span class="line">JSONArray resArr = JSON.parseArray(response);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(resArr.size()&gt;<span class="number">0</span>)&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;resArr.size();i++)&#123;</span><br><span class="line">    JSONObject job = resArr.getJSONObject(i);</span><br><span class="line">    job.replace(<span class="string">"time_stamp"</span>, DateUtil.timeStampToDate(job.getString(<span class="string">"time_stamp"</span>)));</span><br><span class="line">    data.add(job);<span class="comment">//cmd_idimagePathtime_stamp</span></span><br><span class="line">  &#125;</span><br><span class="line">resultJson.put(<span class="string">"data"</span>, data);</span><br><span class="line">resultJson.put(<span class="string">"state"</span>, <span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">resultJson.put(<span class="string">"data"</span>, data);</span><br><span class="line">resultJson.put(<span class="string">"state"</span>, <span class="keyword">false</span>);</span><br><span class="line"><span class="keyword">return</span> resultJson.toJSONString();</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="picture-html"><a href="#picture-html" class="headerlink" title="picture.html"></a>picture.html</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>历史图片查询<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--公共资源开始--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">    <span class="attr">include</span>("<span class="attr">..</span>/<span class="attr">common</span>/<span class="attr">common.html</span>")&#123;&#125;</span></span><br><span class="line"><span class="tag">    %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"$&#123;ctxPath&#125;/static/css/pictureViewer.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;ctxPath&#125;/static/js/pictureViewer.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"$&#123;ctxPath&#125;/static/js/jquery.mousewheel.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--公共资源结束--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">role</span>=<span class="string">"form"</span> <span class="attr">class</span>=<span class="string">"form-inline"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h5</span>&gt;</span></span><br><span class="line">        终端ID:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm"</span> <span class="attr">id</span>=<span class="string">"srh-terminalId"</span>&gt;</span></span><br><span class="line">        开始时间:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm form_date"</span> <span class="attr">id</span>=<span class="string">"srh-begin"</span>/&gt;</span></span><br><span class="line">        结束时间:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control input-sm form_date"</span> <span class="attr">id</span>=<span class="string">"srh-end"</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">class</span>=<span class="string">"btn btn-success btn-sm"</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">onclick</span>=<span class="string">"queryPicture();"</span>&gt;</span>查询</span><br><span class="line">            <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"image-list"</span> <span class="attr">id</span>=<span class="string">"imgCon"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">$(".form_date").datetimepicker(&#123;</span></span><br><span class="line"><span class="undefined">    format: 'yyyy-mm-dd hh:ii:mm',</span></span><br><span class="line"><span class="undefined">    autoclose: true,</span></span><br><span class="line"><span class="undefined">    minView: 0,</span></span><br><span class="line"><span class="undefined">    bootcssVer: 3,</span></span><br><span class="line"><span class="undefined">    language: 'zh-CN',</span></span><br><span class="line"><span class="undefined">    todayHighlight: true,</span></span><br><span class="line"><span class="undefined">    todayBtn: true</span></span><br><span class="line"><span class="undefined">&#125;);</span></span><br><span class="line"><span class="undefined">var today = new Date().setHours(0, 0, 0, 0);</span></span><br><span class="line"><span class="undefined">$("#srh-begin").datetimepicker("setDate", new Date(today));</span></span><br><span class="line"><span class="undefined">$("#srh-end").datetimepicker("setDate", new Date(today + 86400000));</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    function queryPicture() &#123;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    if ($("#srh-terminalId").val() == '') &#123;</span></span><br><span class="line"><span class="undefined">            alertify.alert('提示', '终端ID不能为空!');</span></span><br><span class="line"><span class="undefined">            return false;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">        if ($("#srh-begin").val() == '') &#123;</span></span><br><span class="line"><span class="undefined">            alertify.alert('提示', '开始时间不能为空!');</span></span><br><span class="line"><span class="undefined">            return false;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        </span></span><br><span class="line"><span class="undefined">        if ($("#srh-time").val() == '') &#123;</span></span><br><span class="line"><span class="undefined">            alertify.alert('提示', '结束时间不能为空!');</span></span><br><span class="line"><span class="undefined">            return false;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">        </span></span><br><span class="line"><span class="undefined">        var url = '';</span></span><br><span class="line"><span class="undefined">        var terminalId = $("#srh-terminalId").val();</span></span><br><span class="line"><span class="undefined">        var begin = $("#srh-begin").val();</span></span><br><span class="line"><span class="undefined">        var end = $("#srh-end").val();</span></span><br><span class="line"><span class="undefined">        </span></span><br><span class="line"><span class="undefined">        url = '$&#123;ctxPath&#125;/picture/getPicture.do';</span></span><br><span class="line"><span class="undefined">            </span></span><br><span class="line"><span class="undefined">        $.ajax(&#123;</span></span><br><span class="line"><span class="undefined">            url: url,</span></span><br><span class="line"><span class="undefined">            data: &#123;</span></span><br><span class="line"><span class="undefined">            terminalId : terminalId,</span></span><br><span class="line"><span class="undefined">            begin : begin,</span></span><br><span class="line"><span class="undefined">            end : end</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            type: 'post',   </span></span><br><span class="line"><span class="undefined">            cache: false,</span></span><br><span class="line"><span class="undefined">            dataType: 'json',</span></span><br><span class="line"><span class="undefined">            success: function (data) &#123;</span></span><br><span class="line"><span class="undefined">                if (data.state)&#123;</span></span><br><span class="line"><span class="undefined">                    var ImageContent = "";</span></span><br><span class="line"><span class="undefined">                $.each(data.data, function (key, value) &#123;</span></span><br><span class="line"><span class="xml">                ImageContent += '<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cover"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span>&gt;</span>'+value.cmd_id+'<span class="tag">&lt;<span class="name">br</span>&gt;</span>'+value.time_stamp+'<span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"'+value.imagePath+'"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>';</span></span><br><span class="line"><span class="undefined">                    &#125;);</span></span><br><span class="line"><span class="undefined">                $('#imgCon').html(ImageContent);</span></span><br><span class="line"><span class="undefined">                &#125; else &#123;</span></span><br><span class="line"><span class="undefined">                    alertify.error('暂无数据!');</span></span><br><span class="line"><span class="undefined">                &#125;</span></span><br><span class="line"><span class="undefined">            &#125;,</span></span><br><span class="line"><span class="undefined">            error: function (msg) &#123;</span></span><br><span class="line"><span class="undefined">                console.log(msg);</span></span><br><span class="line"><span class="undefined">            &#125;</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="undefined">    $(function () &#123;</span></span><br><span class="line"><span class="undefined">        $('.image-list').on('click', '.cover', function () &#123;</span></span><br><span class="line"><span class="undefined">            var this_ = $(this);</span></span><br><span class="line"><span class="undefined">            var images = this_.parents('.image-list').find('.cover');</span></span><br><span class="line"><span class="undefined">            var imagesArr = new Array();</span></span><br><span class="line"><span class="undefined">            $.each(images, function (i, image) &#123;</span></span><br><span class="line"><span class="undefined">                imagesArr.push($(image).children('img').attr('src'));</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">            $.pictureViewer(&#123;</span></span><br><span class="line"><span class="undefined">                images: imagesArr, //需要查看的图片，数据类型为数组</span></span><br><span class="line"><span class="undefined">                initImageIndex: this_.index() + 1, //初始查看第几张图片，默认1</span></span><br><span class="line"><span class="undefined">                scrollSwitch: true //是否使用鼠标滚轮切换图片，默认false</span></span><br><span class="line"><span class="undefined">            &#125;);</span></span><br><span class="line"><span class="undefined">        &#125;);</span></span><br><span class="line"><span class="undefined">    &#125;);</span></span><br><span class="line"><span class="undefined">    </span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;通过RestTemplate访问指定的URL地址接收数据。将图片在界面展示出来。&lt;/p&gt;
    
    </summary>
    
      <category term="java总结" scheme="http://iayun.vip/categories/java%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="RestTemplate" scheme="http://iayun.vip/tags/RestTemplate/"/>
    
  </entry>
  
</feed>
